(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16015,(e,t,r)=>{},98547,(e,t,r)=>{var s=e.i(47167);e.r(16015);var n=e.r(71645),i=n&&"object"==typeof n&&"default"in n?n:{default:n},a=void 0!==s.default&&s.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,s=void 0===r?"stylesheet":r,n=t.optimizeForSpeed,i=void 0===n?a:n;c(o(s),"`name` must be a string"),this._name=s,this._deletedRulePlaceholder="#"+s+"-deleted-rule____{}",c("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="u">typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"u">typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(o(e),"`insertRule` accepts only strings"),"u"<typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var s=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,s))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"u"<typeof window){var r="u">typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(s){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var s=this._tags[e];c(s,"old rule at index `"+e+"` not found"),s.textContent=t}return e},r.deleteRule=function(e){if("u"<typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"u">typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"u"<typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(o(t),"makeStyleTag accepts only strings as second parameter");var s=document.createElement("style");this._nonce&&s.setAttribute("nonce",this._nonce),s.type="text/css",s.setAttribute("data-"+e,""),t&&s.appendChild(document.createTextNode(t));var n=document.head||document.getElementsByTagName("head")[0];return r?n.insertBefore(s,r):n.appendChild(s),s},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},d={};function h(e,t){if(!t)return"jsx-"+e;var r=String(t),s=e+r;return d[s]||(d[s]="jsx-"+u(e+"-"+r)),d[s]}function p(e,t){"u"<typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return d[r]||(d[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[r]}var f=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,s=void 0===r?null:r,n=t.optimizeForSpeed,i=void 0!==n&&n;this._sheet=s||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),s&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"u">typeof window&&!this._fromServer&&(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),s=r.styleId,n=r.rules;if(s in this._instancesCounts){this._instancesCounts[s]+=1;return}var i=n.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[s]=i,this._instancesCounts[s]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var s=this._fromServer&&this._fromServer[r];s?(s.parentNode.removeChild(s),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],s=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:s}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,s=e.id;if(r){var n=h(s,r);return{styleId:n,rules:Array.isArray(t)?t.map(function(e){return p(n,e)}):[p(n,t)]}}return{styleId:h(s),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),m=n.createContext(null);function g(){return new f}function y(){return n.useContext(m)}m.displayName="StyleSheetContext";var v=i.default.useInsertionEffect||i.default.useLayoutEffect,b="u">typeof window?g():void 0;function x(e){var t=b||y();return t&&("u"<typeof window?t.add(e):v(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}x.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,s=n.useContext(m),a=n.useState(function(){return s||t||g()})[0];return i.default.createElement(m.Provider,{value:a},r)},r.createStyleRegistry=g,r.style=x,r.useStyleRegistry=y},37902,(e,t,r)=>{t.exports=e.r(98547).style},67423,(e,t,r)=>{"use strict";function s({widthInt:e,heightInt:t,blurWidth:r,blurHeight:s,blurDataURL:n,objectFit:i}){let a=r?40*r:e,o=s?40*s:t,l=a&&o?`viewBox='0 0 ${a} ${o}'`:"";return`%3Csvg xmlns='http://www.w3.org/2000/svg' ${l}%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='${l?"none":"contain"===i?"xMidYMid":"cover"===i?"xMidYMid slice":"none"}' style='filter: url(%23b);' href='${n}'/%3E%3C/svg%3E`}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImageBlurSvg",{enumerable:!0,get:function(){return s}})},87690,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={VALID_LOADERS:function(){return i},imageConfigDefault:function(){return a}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=["default","imgix","cloudinary","akamai","custom"],a={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:14400,formats:["image/webp"],maximumRedirects:3,dangerouslyAllowLocalIP:!1,dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",localPatterns:void 0,remotePatterns:[],qualities:[75],unoptimized:!1}},8927,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getImgProps",{enumerable:!0,get:function(){return c}}),e.r(33525);let s=e.r(43369),n=e.r(67423),i=e.r(87690),a=["-moz-initial","fill","none","scale-down",void 0];function o(e){return void 0!==e.default}function l(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function c({src:e,sizes:t,unoptimized:r=!1,priority:c=!1,preload:u=!1,loading:d,className:h,quality:p,width:f,height:m,fill:g=!1,style:y,overrideSrc:v,onLoad:b,onLoadingComplete:x,placeholder:w="empty",blurDataURL:_,fetchPriority:k,decoding:j="async",layout:S,objectFit:E,objectPosition:$,lazyBoundary:z,lazyRoot:N,...O},T){var R;let C,P,A,{imgConf:I,showAltText:F,blurComplete:M,defaultLoader:D}=T,L=I||i.imageConfigDefault;if("allSizes"in L)C=L;else{let e=[...L.deviceSizes,...L.imageSizes].sort((e,t)=>e-t),t=L.deviceSizes.sort((e,t)=>e-t),r=L.qualities?.sort((e,t)=>e-t);C={...L,allSizes:e,deviceSizes:t,qualities:r}}if(void 0===D)throw Object.defineProperty(Error("images.loaderFile detected but the file is missing default export.\nRead more: https://nextjs.org/docs/messages/invalid-images-config"),"__NEXT_ERROR_CODE",{value:"E163",enumerable:!1,configurable:!0});let U=O.loader||D;delete O.loader,delete O.srcSet;let B="__next_img_default"in U;if(B){if("custom"===C.loader)throw Object.defineProperty(Error(`Image with src "${e}" is missing "loader" prop.
Read more: https://nextjs.org/docs/messages/next-image-missing-loader`),"__NEXT_ERROR_CODE",{value:"E252",enumerable:!1,configurable:!0})}else{let e=U;U=t=>{let{config:r,...s}=t;return e(s)}}if(S){"fill"===S&&(g=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[S];e&&(y={...y,...e});let r={responsive:"100vw",fill:"100vw"}[S];r&&!t&&(t=r)}let Z="",W=l(f),Q=l(m);if((R=e)&&"object"==typeof R&&(o(R)||void 0!==R.src)){let t=o(e)?e.default:e;if(!t.src)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E460",enumerable:!1,configurable:!0});if(!t.height||!t.width)throw Object.defineProperty(Error(`An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received ${JSON.stringify(t)}`),"__NEXT_ERROR_CODE",{value:"E48",enumerable:!1,configurable:!0});if(P=t.blurWidth,A=t.blurHeight,_=_||t.blurDataURL,Z=t.src,!g)if(W||Q){if(W&&!Q){let e=W/t.width;Q=Math.round(t.height*e)}else if(!W&&Q){let e=Q/t.height;W=Math.round(t.width*e)}}else W=t.width,Q=t.height}let q=!c&&!u&&("lazy"===d||void 0===d);(!(e="string"==typeof e?e:Z)||e.startsWith("data:")||e.startsWith("blob:"))&&(r=!0,q=!1),C.unoptimized&&(r=!0),B&&!C.dangerouslyAllowSVG&&e.split("?",1)[0].endsWith(".svg")&&(r=!0);let J=l(p),H=Object.assign(g?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:E,objectPosition:$}:{},F?{}:{color:"transparent"},y),V=M||"empty"===w?null:"blur"===w?`url("data:image/svg+xml;charset=utf-8,${(0,n.getImageBlurSvg)({widthInt:W,heightInt:Q,blurWidth:P,blurHeight:A,blurDataURL:_||"",objectFit:H.objectFit})}")`:`url("${w}")`,G=a.includes(H.objectFit)?"fill"===H.objectFit?"100% 100%":"cover":H.objectFit,K=V?{backgroundSize:G,backgroundPosition:H.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:V}:{},X=function({config:e,src:t,unoptimized:r,width:n,quality:i,sizes:a,loader:o}){if(r){let e=(0,s.getDeploymentId)();if(t.startsWith("/")&&!t.startsWith("//")&&e){let r=t.includes("?")?"&":"?";t=`${t}${r}dpl=${e}`}return{src:t,srcSet:void 0,sizes:void 0}}let{widths:l,kind:c}=function({deviceSizes:e,allSizes:t},r,s){if(s){let r=/(^|\s)(1?\d?\d)vw/g,n=[];for(let e;e=r.exec(s);)n.push(parseInt(e[2]));if(n.length){let r=.01*Math.min(...n);return{widths:t.filter(t=>t>=e[0]*r),kind:"w"}}return{widths:t,kind:"w"}}return"number"!=typeof r?{widths:e,kind:"w"}:{widths:[...new Set([r,2*r].map(e=>t.find(t=>t>=e)||t[t.length-1]))],kind:"x"}}(e,n,a),u=l.length-1;return{sizes:a||"w"!==c?a:"100vw",srcSet:l.map((r,s)=>`${o({config:e,src:t,quality:i,width:r})} ${"w"===c?r:s+1}${c}`).join(", "),src:o({config:e,src:t,quality:i,width:l[u]})}}({config:C,src:e,unoptimized:r,width:W,quality:J,sizes:t,loader:U}),Y=q?"lazy":d;return{props:{...O,loading:Y,fetchPriority:k,width:W,height:Q,decoding:j,className:h,style:{...H,...K},sizes:X.sizes,srcSet:X.srcSet,src:v||X.src},meta:{unoptimized:r,preload:u||c,placeholder:w,fill:g}}}},98879,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o}});let s=e.r(71645),n="u"<typeof window,i=n?()=>{}:s.useLayoutEffect,a=n?()=>{}:s.useEffect;function o(e){let{headManager:t,reduceComponentsToState:r}=e;function o(){if(t&&t.mountedInstances){let e=s.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(r(e))}}return n&&(t?.mountedInstances?.add(e.children),o()),i(()=>(t?.mountedInstances?.add(e.children),()=>{t?.mountedInstances?.delete(e.children)})),i(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),a(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},25633,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return m},defaultHead:function(){return d}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=e.r(55682),a=e.r(90809),o=e.r(43476),l=a._(e.r(71645)),c=i._(e.r(98879)),u=e.r(42732);function d(){return[(0,o.jsx)("meta",{charSet:"utf-8"},"charset"),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")]}function h(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===l.default.Fragment?e.concat(l.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}e.r(33525);let p=["name","httpEquiv","charSet","itemProp"];function f(e){let t,r,s,n;return e.reduce(h,[]).reverse().concat(d().reverse()).filter((t=new Set,r=new Set,s=new Set,n={},e=>{let i=!0,a=!1;if(e.key&&"number"!=typeof e.key&&e.key.indexOf("$")>0){a=!0;let r=e.key.slice(e.key.indexOf("$")+1);t.has(r)?i=!1:t.add(r)}switch(e.type){case"title":case"base":r.has(e.type)?i=!1:r.add(e.type);break;case"meta":for(let t=0,r=p.length;t<r;t++){let r=p[t];if(e.props.hasOwnProperty(r))if("charSet"===r)s.has(r)?i=!1:s.add(r);else{let t=e.props[r],s=n[r]||new Set;("name"!==r||!a)&&s.has(t)?i=!1:(s.add(t),n[r]=s)}}}return i})).reverse().map((e,t)=>{let r=e.key||t;return l.default.cloneElement(e,{key:r})})}let m=function({children:e}){let t=(0,l.useContext)(u.HeadManagerContext);return(0,o.jsx)(c.default,{reduceComponentsToState:f,headManager:t,children:e})};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18556,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ImageConfigContext",{enumerable:!0,get:function(){return i}});let s=e.r(55682)._(e.r(71645)),n=e.r(87690),i=s.default.createContext(n.imageConfigDefault)},65856,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"RouterContext",{enumerable:!0,get:function(){return s}});let s=e.r(55682)._(e.r(71645)).default.createContext(null)},70965,(e,t,r)=>{"use strict";function s(e,t){let r=e||75;return t?.qualities?.length?t.qualities.reduce((e,t)=>Math.abs(t-r)<Math.abs(e-r)?t:e,0):r}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"findClosestQuality",{enumerable:!0,get:function(){return s}})},1948,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return a}});let s=e.r(70965),n=e.r(43369);function i({config:e,src:t,width:r,quality:i}){if(t.startsWith("/")&&t.includes("?")&&e.localPatterns?.length===1&&"**"===e.localPatterns[0].pathname&&""===e.localPatterns[0].search)throw Object.defineProperty(Error(`Image with src "${t}" is using a query string which is not configured in images.localPatterns.
Read more: https://nextjs.org/docs/messages/next-image-unconfigured-localpatterns`),"__NEXT_ERROR_CODE",{value:"E871",enumerable:!1,configurable:!0});let a=(0,s.findClosestQuality)(i,e),o=(0,n.getDeploymentId)();return`${e.path}?url=${encodeURIComponent(t)}&w=${r}&q=${a}${t.startsWith("/")&&o?`&dpl=${o}`:""}`}i.__next_img_default=!0;let a=i},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return n}});let s=e.r(71645);function n(e,t){let r=(0,s.useRef)(null),n=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=i(e,s)),t&&(n.current=i(t,s))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},5500,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"Image",{enumerable:!0,get:function(){return x}});let s=e.r(55682),n=e.r(90809),i=e.r(43476),a=n._(e.r(71645)),o=s._(e.r(74080)),l=s._(e.r(25633)),c=e.r(8927),u=e.r(87690),d=e.r(18556);e.r(33525);let h=e.r(65856),p=s._(e.r(1948)),f=e.r(18581),m={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function g(e,t,r,s,n,i,a){let o=e?.src;e&&e["data-loaded-src"]!==o&&(e["data-loaded-src"]=o,("decode"in e?e.decode():Promise.resolve()).catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&n(!0),r?.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let s=!1,n=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>s,isPropagationStopped:()=>n,persist:()=>{},preventDefault:()=>{s=!0,t.preventDefault()},stopPropagation:()=>{n=!0,t.stopPropagation()}})}s?.current&&s.current(e)}}))}function y(e){return a.use?{fetchPriority:e}:{fetchpriority:e}}"u"<typeof window&&(globalThis.__NEXT_IMAGE_IMPORTED=!0);let v=(0,a.forwardRef)(({src:e,srcSet:t,sizes:r,height:s,width:n,decoding:o,className:l,style:c,fetchPriority:u,placeholder:d,loading:h,unoptimized:p,fill:m,onLoadRef:v,onLoadingCompleteRef:b,setBlurComplete:x,setShowAltText:w,sizesInput:_,onLoad:k,onError:j,...S},E)=>{let $=(0,a.useCallback)(e=>{e&&(j&&(e.src=e.src),e.complete&&g(e,d,v,b,x,p,_))},[e,d,v,b,x,j,p,_]),z=(0,f.useMergedRef)(E,$);return(0,i.jsx)("img",{...S,...y(u),loading:h,width:n,height:s,decoding:o,"data-nimg":m?"fill":"1",className:l,style:c,sizes:r,srcSet:t,src:e,ref:z,onLoad:e=>{g(e.currentTarget,d,v,b,x,p,_)},onError:e=>{w(!0),"empty"!==d&&x(!0),j&&j(e)}})});function b({isAppRouter:e,imgAttributes:t}){let r={as:"image",imageSrcSet:t.srcSet,imageSizes:t.sizes,crossOrigin:t.crossOrigin,referrerPolicy:t.referrerPolicy,...y(t.fetchPriority)};return e&&o.default.preload?(o.default.preload(t.src,r),null):(0,i.jsx)(l.default,{children:(0,i.jsx)("link",{rel:"preload",href:t.srcSet?void 0:t.src,...r},"__nimg-"+t.src+t.srcSet+t.sizes)})}let x=(0,a.forwardRef)((e,t)=>{let r=(0,a.useContext)(h.RouterContext),s=(0,a.useContext)(d.ImageConfigContext),n=(0,a.useMemo)(()=>{let e=m||s||u.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t),n=e.qualities?.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r,qualities:n,localPatterns:"u"<typeof window?s?.localPatterns:e.localPatterns}},[s]),{onLoad:o,onLoadingComplete:l}=e,f=(0,a.useRef)(o);(0,a.useEffect)(()=>{f.current=o},[o]);let g=(0,a.useRef)(l);(0,a.useEffect)(()=>{g.current=l},[l]);let[y,x]=(0,a.useState)(!1),[w,_]=(0,a.useState)(!1),{props:k,meta:j}=(0,c.getImgProps)(e,{defaultLoader:p.default,imgConf:n,blurComplete:y,showAltText:w});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v,{...k,unoptimized:j.unoptimized,placeholder:j.placeholder,fill:j.fill,onLoadRef:f,onLoadingCompleteRef:g,setBlurComplete:x,setShowAltText:_,sizesInput:e.sizes,ref:t}),j.preload?(0,i.jsx)(b,{isAppRouter:!r,imgAttributes:k}):null]})});("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},94909,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={default:function(){return u},getImageProps:function(){return c}};for(var n in s)Object.defineProperty(r,n,{enumerable:!0,get:s[n]});let i=e.r(55682),a=e.r(8927),o=e.r(5500),l=i._(e.r(1948));function c(e){let{props:t}=(0,a.getImgProps)(e,{defaultLoader:l.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let u=o.Image},57688,(e,t,r)=>{t.exports=e.r(94909)},54385,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}},43173,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(6085)),i=s(e.r(54385));r.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"u"<typeof fetch?this.fetch=n.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,s;let n=null,a=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let s=null==(t=this.headers.Prefer)?void 0:t.match(/count=(exact|planned|estimated)/),i=null==(r=e.headers.get("content-range"))?void 0:r.split("/");s&&i&&i.length>1&&(o=parseInt(i[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(n={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,o=null,l=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{let t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(a=[],n=null,l=200,c="OK")}catch(r){404===e.status&&""===t?(l=204,c="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null==(s=null==n?void 0:n.details)?void 0:s.includes("0 rows"))&&(n=null,l=200,c="OK"),n&&this.shouldThrowOnError)throw new i.default(n)}return{error:n,data:a,count:o,status:l,statusText:c}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,s;return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!=(r=null==e?void 0:e.stack)?r:""}`,hint:"",code:`${null!=(s=null==e?void 0:e.code)?s:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}},82191,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(43173));class i extends n.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){let i=n?`${n}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){let n=void 0===s?"offset":`${s}.offset`,i=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var a;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!=(a=this.headers.Accept)?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!=(e=this.headers.Prefer)?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}r.default=i},14633,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(82191));class i extends n.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let n="";"plain"===s?n="pl":"phrase"===s?n="ph":"websearch"===s&&(n="w");let i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}r.default=i},38290,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(14633));r.default=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){let s=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",i),r&&(this.headers.Prefer=`count=${r}`),new n.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){let a=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),i||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new n.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new n.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},98042,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.version=void 0,r.version="0.0.0-automated"},85511,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_HEADERS=void 0;let s=e.r(98042);r.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${s.version}`}},2259,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});let n=s(e.r(38290)),i=s(e.r(14633)),a=e.r(85511);class o{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=s}from(e){let t=new URL(`${this.url}/${e}`);return new n.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:n}={}){let a,o,l=new URL(`${this.url}/rpc/${e}`);r||s?(a=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(a="POST",o=t);let c=Object.assign({},this.headers);return n&&(c.Prefer=`count=${n}`),new i.default({method:a,url:l,headers:c,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}r.default=o},82215,(e,t,r)=>{"use strict";var s=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.PostgrestError=r.PostgrestBuilder=r.PostgrestTransformBuilder=r.PostgrestFilterBuilder=r.PostgrestQueryBuilder=r.PostgrestClient=void 0;let n=s(e.r(2259));r.PostgrestClient=n.default;let i=s(e.r(38290));r.PostgrestQueryBuilder=i.default;let a=s(e.r(14633));r.PostgrestFilterBuilder=a.default;let o=s(e.r(82191));r.PostgrestTransformBuilder=o.default;let l=s(e.r(43173));r.PostgrestBuilder=l.default;let c=s(e.r(54385));r.PostgrestError=c.default,r.default={PostgrestClient:n.default,PostgrestQueryBuilder:i.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},71058,e=>{"use strict";let t,r,s,n,i,a,o,l,c;var u,d,h,p,f,m,g,y,v,b,x,w,_,k,j,S,E,$,z,N,O,T,R,C,P,A,I,F,M=e.i(43476),D=e.i(71645);let L=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var U={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let B=(0,D.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:i,iconNode:a,...o},l)=>(0,D.createElement)("svg",{ref:l,...U,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:L("lucide",n),...o},[...a.map(([e,t])=>(0,D.createElement)(e,t)),...Array.isArray(i)?i:[i]])),Z=(e,t)=>{let r=(0,D.forwardRef)(({className:r,...s},n)=>(0,D.createElement)(B,{ref:n,iconNode:t,className:L(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,r),...s}));return r.displayName=`${e}`,r},W=Z("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Q=()=>(0,M.jsxs)("div",{className:"loader-container",children:[(0,M.jsx)("div",{className:"peeking-photo-icon",children:(0,M.jsx)(W,{strokeWidth:1.5})}),(0,M.jsxs)("div",{className:"shield-container",children:[Array.from({length:150}).map((e,t)=>(0,M.jsx)("div",{className:"particle",style:{animationDelay:`${t%10*.1+.02*Math.floor(t/10)}s`}},t)),(0,M.jsxs)("div",{className:"shield-structure",children:[(0,M.jsx)("div",{className:"structure-line line-1"}),(0,M.jsx)("div",{className:"structure-line line-2"}),(0,M.jsx)("div",{className:"structure-line line-3"}),(0,M.jsx)("div",{className:"structure-line line-4"})]})]}),(0,M.jsx)("div",{className:"loading-text",children:"LÃ„DT..."})]});var q=e.i(37902);let J=Z("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),H=Z("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),V=Z("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),G=Z("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),K=Z("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),X=Z("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var Y=e.i(57688);let ee=(e,t)=>{if(0===e.length)return t.classGroupId;let r=e[0],s=t.nextPart.get(r),n=s?ee(e.slice(1),s):void 0;if(n)return n;if(0===t.validators.length)return;let i=e.join("-");return t.validators.find(({validator:e})=>e(i))?.classGroupId},et=/^\[(.+)\]$/,er=(e,t,r,s)=>{e.forEach(e=>{if("string"==typeof e){(""===e?t:es(t,e)).classGroupId=r;return}"function"==typeof e?en(e)?er(e(s),t,r,s):t.validators.push({validator:e,classGroupId:r}):Object.entries(e).forEach(([e,n])=>{er(n,es(t,e),r,s)})})},es=(e,t)=>{let r=e;return t.split("-").forEach(e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)}),r},en=e=>e.isThemeGetter,ei=(e,t)=>t?e.map(([e,r])=>[e,r.map(e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,r])=>[t+e,r])):e)]):e,ea=e=>{if(e.length<=1)return e;let t=[],r=[];return e.forEach(e=>{"["===e[0]?(t.push(...r.sort(),e),r=[]):r.push(e)}),t.push(...r.sort()),t},eo=/\s+/;function el(){let e,t,r=0,s="";for(;r<arguments.length;)(e=arguments[r++])&&(t=ec(e))&&(s&&(s+=" "),s+=t);return s}let ec=e=>{let t;if("string"==typeof e)return e;let r="";for(let s=0;s<e.length;s++)e[s]&&(t=ec(e[s]))&&(r&&(r+=" "),r+=t);return r},eu=e=>{let t=t=>t[e]||[];return t.isThemeGetter=!0,t},ed=/^\[(?:([a-z-]+):)?(.+)\]$/i,eh=/^\d+\/\d+$/,ep=new Set(["px","full","screen"]),ef=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,em=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,eg=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ey=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ev=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,eb=e=>ew(e)||ep.has(e)||eh.test(e),ex=e=>eP(e,"length",eA),ew=e=>!!e&&!Number.isNaN(Number(e)),e_=e=>eP(e,"number",ew),ek=e=>!!e&&Number.isInteger(Number(e)),ej=e=>e.endsWith("%")&&ew(e.slice(0,-1)),eS=e=>ed.test(e),eE=e=>ef.test(e),e$=new Set(["length","size","percentage"]),ez=e=>eP(e,e$,eI),eN=e=>eP(e,"position",eI),eO=new Set(["image","url"]),eT=e=>eP(e,eO,eM),eR=e=>eP(e,"",eF),eC=()=>!0,eP=(e,t,r)=>{let s=ed.exec(e);return!!s&&(s[1]?"string"==typeof t?s[1]===t:t.has(s[1]):r(s[2]))},eA=e=>em.test(e)&&!eg.test(e),eI=()=>!1,eF=e=>ey.test(e),eM=e=>ev.test(e),eD=function(e,...t){let r,s,n,i=function(o){let l;return s=(r={cache:(e=>{if(e<1)return{get:()=>void 0,set:()=>{}};let t=0,r=new Map,s=new Map,n=(n,i)=>{r.set(n,i),++t>e&&(t=0,s=r,r=new Map)};return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=s.get(e))?(n(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):n(e,t)}}})((l=t.reduce((e,t)=>t(e),e())).cacheSize),parseClassName:(e=>{let{separator:t,experimentalParseClassName:r}=e,s=1===t.length,n=t[0],i=t.length,a=e=>{let r,a=[],o=0,l=0;for(let c=0;c<e.length;c++){let u=e[c];if(0===o){if(u===n&&(s||e.slice(c,c+i)===t)){a.push(e.slice(l,c)),l=c+i;continue}if("/"===u){r=c;continue}}"["===u?o++:"]"===u&&o--}let c=0===a.length?e:e.substring(l),u=c.startsWith("!"),d=u?c.substring(1):c;return{modifiers:a,hasImportantModifier:u,baseClassName:d,maybePostfixModifierPosition:r&&r>l?r-l:void 0}};return r?e=>r({className:e,parseClassName:a}):a})(l),...(e=>{let t=(e=>{let{theme:t,prefix:r}=e,s={nextPart:new Map,validators:[]};return ei(Object.entries(e.classGroups),r).forEach(([e,r])=>{er(r,s,e,t)}),s})(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:e=>{let r=e.split("-");return""===r[0]&&1!==r.length&&r.shift(),ee(r,t)||(e=>{if(et.test(e)){let t=et.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}})(e)},getConflictingClassGroupIds:(e,t)=>{let n=r[e]||[];return t&&s[e]?[...n,...s[e]]:n}}})(l)}).cache.get,n=r.cache.set,i=a,a(o)};function a(e){let t=s(e);if(t)return t;let i=((e,t)=>{let{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:n}=t,i=[],a=e.trim().split(eo),o="";for(let e=a.length-1;e>=0;e-=1){let t=a[e],{modifiers:l,hasImportantModifier:c,baseClassName:u,maybePostfixModifierPosition:d}=r(t),h=!!d,p=s(h?u.substring(0,d):u);if(!p){if(!h||!(p=s(u))){o=t+(o.length>0?" "+o:o);continue}h=!1}let f=ea(l).join(":"),m=c?f+"!":f,g=m+p;if(i.includes(g))continue;i.push(g);let y=n(p,h);for(let e=0;e<y.length;++e){let t=y[e];i.push(m+t)}o=t+(o.length>0?" "+o:o)}return o})(e,r);return n(e,i),i}return function(){return i(el.apply(null,arguments))}}(()=>{let e=eu("colors"),t=eu("spacing"),r=eu("blur"),s=eu("brightness"),n=eu("borderColor"),i=eu("borderRadius"),a=eu("borderSpacing"),o=eu("borderWidth"),l=eu("contrast"),c=eu("grayscale"),u=eu("hueRotate"),d=eu("invert"),h=eu("gap"),p=eu("gradientColorStops"),f=eu("gradientColorStopPositions"),m=eu("inset"),g=eu("margin"),y=eu("opacity"),v=eu("padding"),b=eu("saturate"),x=eu("scale"),w=eu("sepia"),_=eu("skew"),k=eu("space"),j=eu("translate"),S=()=>["auto","contain","none"],E=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",eS,t],z=()=>[eS,t],N=()=>["",eb,ex],O=()=>["auto",ew,eS],T=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],R=()=>["solid","dashed","dotted","double","none"],C=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],P=()=>["start","end","center","between","around","evenly","stretch"],A=()=>["","0",eS],I=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[ew,eS];return{cacheSize:500,separator:":",theme:{colors:[eC],spacing:[eb,ex],blur:["none","",eE,eS],brightness:F(),borderColor:[e],borderRadius:["none","","full",eE,eS],borderSpacing:z(),borderWidth:N(),contrast:F(),grayscale:A(),hueRotate:F(),invert:A(),gap:z(),gradientColorStops:[e],gradientColorStopPositions:[ej,ex],inset:$(),margin:$(),opacity:F(),padding:z(),saturate:F(),scale:F(),sepia:A(),skew:F(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",eS]}],container:["container"],columns:[{columns:[eE]}],"break-after":[{"break-after":I()}],"break-before":[{"break-before":I()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...T(),eS]}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ek,eS]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",eS]}],grow:[{grow:A()}],shrink:[{shrink:A()}],order:[{order:["first","last","none",ek,eS]}],"grid-cols":[{"grid-cols":[eC]}],"col-start-end":[{col:["auto",{span:["full",ek,eS]},eS]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[eC]}],"row-start-end":[{row:["auto",{span:[ek,eS]},eS]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",eS]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",eS]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...P()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...P(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...P(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",eS,t]}],"min-w":[{"min-w":[eS,t,"min","max","fit"]}],"max-w":[{"max-w":[eS,t,"none","full","min","max","fit","prose",{screen:[eE]},eE]}],h:[{h:[eS,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[eS,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[eS,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[eS,t,"auto","min","max","fit"]}],"font-size":[{text:["base",eE,ex]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",e_]}],"font-family":[{font:[eC]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",eS]}],"line-clamp":[{"line-clamp":["none",ew,e_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",eb,eS]}],"list-image":[{"list-image":["none",eS]}],"list-style-type":[{list:["none","disc","decimal",eS]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...R(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",eb,ex]}],"underline-offset":[{"underline-offset":["auto",eb,eS]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",eS]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",eS]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...T(),eN]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ez]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},eT]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...R(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:R()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...R()]}],"outline-offset":[{"outline-offset":[eb,eS]}],"outline-w":[{outline:[eb,ex]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:N()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[eb,ex]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",eE,eR]}],"shadow-color":[{shadow:[eC]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...C(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":C()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",eE,eS]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[w]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[w]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",eS]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",eS]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",eS]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[ek,eS]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",eS]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",eS]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",eS]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[eb,ex,e_]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}),eL={key:"/key.svg",lock:"/lock.svg",shield:"/shield.svg",upload:"/upload.svg",smartphone:"/smartphone.svg",cloud:"/cloud.svg",clock:"/clock.svg",search:"/search.svg",image:"/image.svg",folder:"/Openfolder.svg",refresh:"/RefreshCw.svg",chevronRight:"/ChevronRight.svg"};function eU({name:e,className:t,size:r=24}){return(0,M.jsx)("div",{className:function(...e){return eD(function(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=function e(t){var r,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var i=t.length;for(r=0;r<i;r++)t[r]&&(s=e(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s);return n}(e))&&(s&&(s+=" "),s+=t);return s}(e))}("relative inline-block shrink-0",t),style:{width:r,height:r},children:(0,M.jsx)(Y.default,{src:eL[e],alt:e,fill:!0,className:"object-contain",unoptimized:!0})})}var eB=e.i(47167);let eZ=Object.create(null),eW=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?eZ:globalThis),eQ=new Proxy(eZ,{get:(e,t)=>eW()[t]??eZ[t],has:(e,t)=>t in eW()||t in eZ,set:(e,t,r)=>(eW(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=eW(!0);return delete r[t],!0},ownKeys:()=>Object.keys(eW(!0))});function eq(e,t){return void 0!==eB.default&&eB.default.env?eB.default.env[e]??t:"u">typeof Deno?Deno.env.get(e)??t:"u">typeof Bun?Bun.env[e]??t:t}void 0!==eB.default&&eB.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return eq("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return eq("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return eq("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return eq("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return eq("NODE_ENV","development")},get PACKAGE_VERSION(){return eq("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return eq("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let eJ={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},eH=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),eV=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],eG="\x1b[0m",eK="\x1b[31m",eX="\x1b[32m",eY="\x1b[33m",e0="\x1b[34m",e1="\x1b[35m",e2=["debug","info","success","warn","error"],e3={info:e0,success:eX,warn:eY,error:eK,debug:e1};function e4(e,t,r){function s(r,s){if(r._zod||Object.defineProperty(r,"_zod",{value:{def:s,constr:a,traits:new Set},enumerable:!1}),r._zod.traits.has(e))return;r._zod.traits.add(e),t(r,s);let n=a.prototype,i=Object.keys(n);for(let e=0;e<i.length;e++){let t=i[e];t in r||(r[t]=n[t].bind(r))}}let n=r?.Parent??Object;class i extends n{}function a(e){var t;let n=r?.Parent?new i:this;for(let r of(s(n,e),(t=n._zod).deferred??(t.deferred=[]),n._zod.deferred))r();return n}return Object.defineProperty(i,"name",{value:e}),Object.defineProperty(a,"init",{value:s}),Object.defineProperty(a,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}t=u?.disabled!==!0,r=u?.level??"error",s=u?.disableColors!==void 0?!u.disableColors:1!==function(){if(void 0!==eq("FORCE_COLOR"))switch(eq("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==eq("NODE_DISABLE_COLORS")&&""!==eq("NODE_DISABLE_COLORS")||void 0!==eq("NO_COLOR")&&""!==eq("NO_COLOR")||"dumb"===eq("TERM"))return 1;if(eq("TMUX"))return 24;if("TF_BUILD"in eQ&&"AGENT_NAME"in eQ)return 4;if("CI"in eQ){for(let{0:e,1:t}of eH)if(e in eQ)return t;return"codeship"===eq("CI_NAME")?8:1}if("TEAMCITY_VERSION"in eQ)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(eq("TEAMCITY_VERSION"))?4:1;switch(eq("TERM_PROGRAM")){case"iTerm.app":if(!eq("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(eq("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===eq("COLORTERM")||"24bit"===eq("COLORTERM"))return 24;if(eq("TERM")){if(null!==/truecolor/.exec(eq("TERM")))return 24;if(null!==/^xterm-256/.exec(eq("TERM")))return 8;let e=eq("TERM").toLowerCase();if(eJ[e])return eJ[e];if(eV.some(t=>null!==t.exec(e)))return 4}return eq("COLORTERM")?4:1}(),Object.fromEntries(e2.map(e=>[e,(...[n,...i])=>((e,n,i=[])=>{let a;if(!t||!(e2.indexOf(e)>=e2.indexOf(r)))return;let o=(a=new Date().toISOString(),s?`\x1b[2m${a}${eG} ${e3[e]}${e.toUpperCase()}${eG} \x1b[1m[Better Auth]:${eG} ${n}`:`${a} ${e.toUpperCase()} [Better Auth]: ${n}`);u&&"function"==typeof u.log?u.log("success"===e?"info":e,n,...i):"error"===e?console.error(o,...i):"warn"===e?console.warn(o,...i):console.log(o,...i)})(e,n,i)])),Object.freeze({status:"aborted"}),Symbol("zod_brand");class e5 extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class e6 extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let e8={};function e7(e){return e&&Object.assign(e8,e),e8}function e9(e){return e}function te(e){return e}function tt(e){}function tr(e){throw Error("Unexpected value in exhaustive check")}function ts(e){}function tn(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function ti(e,t="|"){return e.map(e=>tP(e)).join(t)}function ta(e,t){return"bigint"==typeof t?t.toString():t}function to(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function tl(e){return null==e}function tc(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function tu(e,t){let r=(e.toString().split(".")[1]||"").length,s=t.toString(),n=(s.split(".")[1]||"").length;if(0===n&&/\d?e-\d?/.test(s)){let e=s.match(/\d?e-(\d?)/);e?.[1]&&(n=Number.parseInt(e[1]))}let i=r>n?r:n;return Number.parseInt(e.toFixed(i).replace(".",""))%Number.parseInt(t.toFixed(i).replace(".",""))/10**i}let td=Symbol("evaluating");function th(e,t,r){let s;Object.defineProperty(e,t,{get(){if(s!==td)return void 0===s&&(s=td,s=r()),s},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function tp(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function tf(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function tm(...e){let t={};for(let r of e)Object.assign(t,Object.getOwnPropertyDescriptors(r));return Object.defineProperties({},t)}function tg(e){return tm(e._zod.def)}function ty(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function tv(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let s=0;s<t.length;s++)r[t[s]]=e[s];return r})}function tb(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let s=0;s<e;s++)r+=t[Math.floor(Math.random()*t.length)];return r}function tx(e){return JSON.stringify(e)}function tw(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}let t_="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function tk(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let tj=to(()=>{if("u">typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function tS(e){if(!1===tk(e))return!1;let t=e.constructor;if(void 0===t||"function"!=typeof t)return!0;let r=t.prototype;return!1!==tk(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function tE(e){return tS(e)?{...e}:Array.isArray(e)?[...e]:e}function t$(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}let tz=new Set(["string","number","symbol"]),tN=new Set(["string","number","bigint","boolean","symbol","undefined"]);function tO(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function tT(e,t,r){let s=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(s._zod.parent=e),s}function tR(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function tC(e){let t;return new Proxy({},{get:(r,s,n)=>(t??(t=e()),Reflect.get(t,s,n)),set:(r,s,n,i)=>(t??(t=e()),Reflect.set(t,s,n,i)),has:(r,s)=>(t??(t=e()),Reflect.has(t,s)),deleteProperty:(r,s)=>(t??(t=e()),Reflect.deleteProperty(t,s)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,s)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,s)),defineProperty:(r,s,n)=>(t??(t=e()),Reflect.defineProperty(t,s,n))})}function tP(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function tA(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let tI={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},tF={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function tM(e,t){let r=e._zod.def,s=r.checks;if(s&&s.length>0)throw Error(".pick() cannot be used on object schemas containing refinements");let n=tm(e._zod.def,{get shape(){let e={};for(let s in t){if(!(s in r.shape))throw Error(`Unrecognized key: "${s}"`);t[s]&&(e[s]=r.shape[s])}return tf(this,"shape",e),e},checks:[]});return tT(e,n)}function tD(e,t){let r=e._zod.def,s=r.checks;if(s&&s.length>0)throw Error(".omit() cannot be used on object schemas containing refinements");let n=tm(e._zod.def,{get shape(){let s={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete s[e]}return tf(this,"shape",s),s},checks:[]});return tT(e,n)}function tL(e,t){if(!tS(t))throw Error("Invalid input to extend: expected a plain object");let r=e._zod.def.checks;if(r&&r.length>0){let r=e._zod.def.shape;for(let e in t)if(void 0!==Object.getOwnPropertyDescriptor(r,e))throw Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}let s=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tf(this,"shape",r),r}});return tT(e,s)}function tU(e,t){if(!tS(t))throw Error("Invalid input to safeExtend: expected a plain object");let r=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return tf(this,"shape",r),r}});return tT(e,r)}function tB(e,t){let r=tm(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return tf(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return tT(e,r)}function tZ(e,t,r){let s=t._zod.def.checks;if(s&&s.length>0)throw Error(".partial() cannot be used on object schemas containing refinements");let n=tm(t._zod.def,{get shape(){let s=t._zod.def.shape,n={...s};if(r)for(let t in r){if(!(t in s))throw Error(`Unrecognized key: "${t}"`);r[t]&&(n[t]=e?new e({type:"optional",innerType:s[t]}):s[t])}else for(let t in s)n[t]=e?new e({type:"optional",innerType:s[t]}):s[t];return tf(this,"shape",n),n},checks:[]});return tT(t,n)}function tW(e,t,r){let s=tm(t._zod.def,{get shape(){let s=t._zod.def.shape,n={...s};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(n[t]=new e({type:"nonoptional",innerType:s[t]}))}else for(let t in s)n[t]=new e({type:"nonoptional",innerType:s[t]});return tf(this,"shape",n),n}});return tT(t,s)}function tQ(e,t=0){if(!0===e.aborted)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function tq(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function tJ(e){return"string"==typeof e?e:e?.message}function tH(e,t,r){let s={...e,path:e.path??[]};return e.message||(s.message=tJ(e.inst?._zod.def?.error?.(e))??tJ(t?.error?.(e))??tJ(r.customError?.(e))??tJ(r.localeError?.(e))??"Invalid input"),delete s.inst,delete s.continue,t?.reportInput||delete s.input,s}function tV(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function tG(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function tK(e){let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":if(null===e)return"null";if(Array.isArray(e))return"array";if(e&&Object.getPrototypeOf(e)!==Object.prototype&&"constructor"in e&&e.constructor)return e.constructor.name}return t}function tX(...e){let[t,r,s]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:s}:{...t}}function tY(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function t0(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function t1(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function t2(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return t0(t+r)}function t3(e){return t1(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function t4(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=Number.parseInt(t.slice(e,e+2),16);return r}function t5(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class t6{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,tF,"Class",()=>t6,"NUMBER_FORMAT_RANGES",0,tI,"aborted",()=>tQ,"allowsEval",0,tj,"assert",()=>ts,"assertEqual",()=>e9,"assertIs",()=>tt,"assertNever",()=>tr,"assertNotEqual",()=>te,"assignProp",()=>tf,"base64ToUint8Array",()=>t0,"base64urlToUint8Array",()=>t2,"cached",()=>to,"captureStackTrace",0,t_,"cleanEnum",()=>tY,"cleanRegex",()=>tc,"clone",()=>tT,"cloneDef",()=>tg,"createTransparentProxy",()=>tC,"defineLazy",()=>th,"esc",()=>tx,"escapeRegex",()=>tO,"extend",()=>tL,"finalizeIssue",()=>tH,"floatSafeRemainder",()=>tu,"getElementAtPath",()=>ty,"getEnumValues",()=>tn,"getLengthableOrigin",()=>tG,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("u">typeof Map&&e instanceof Map)return"map";if("u">typeof Set&&e instanceof Set)return"set";if("u">typeof Date&&e instanceof Date)return"date";if("u">typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>tV,"hexToUint8Array",()=>t4,"isObject",()=>tk,"isPlainObject",()=>tS,"issue",()=>tX,"joinValues",()=>ti,"jsonStringifyReplacer",()=>ta,"merge",()=>tB,"mergeDefs",()=>tm,"normalizeParams",()=>tR,"nullish",()=>tl,"numKeys",()=>t$,"objectClone",()=>tp,"omit",()=>tD,"optionalKeys",()=>tA,"parsedType",()=>tK,"partial",()=>tZ,"pick",()=>tM,"prefixIssues",()=>tq,"primitiveTypes",0,tN,"promiseAllObject",()=>tv,"propertyKeyTypes",0,tz,"randomString",()=>tb,"required",()=>tW,"safeExtend",()=>tU,"shallowClone",()=>tE,"slugify",()=>tw,"stringifyPrimitive",()=>tP,"uint8ArrayToBase64",()=>t1,"uint8ArrayToBase64url",()=>t3,"uint8ArrayToHex",()=>t5,"unwrapMessage",()=>tJ],22143);let t8=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,ta,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},t7=e4("$ZodError",t8),t9=e4("$ZodError",t8,{Parent:Error}),re=e=>(t,r,s,n)=>{let i=s?Object.assign(s,{async:!1}):{async:!1},a=t._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new e5;if(a.issues.length){let t=new(n?.Err??e)(a.issues.map(e=>tH(e,i,e7())));throw t_(t,n?.callee),t}return a.value},rt=re(t9),rr=e=>async(t,r,s,n)=>{let i=s?Object.assign(s,{async:!0}):{async:!0},a=t._zod.run({value:r,issues:[]},i);if(a instanceof Promise&&(a=await a),a.issues.length){let t=new(n?.Err??e)(a.issues.map(e=>tH(e,i,e7())));throw t_(t,n?.callee),t}return a.value},rs=rr(t9),rn=e=>(t,r,s)=>{let n=s?{...s,async:!1}:{async:!1},i=t._zod.run({value:r,issues:[]},n);if(i instanceof Promise)throw new e5;return i.issues.length?{success:!1,error:new(e??t7)(i.issues.map(e=>tH(e,n,e7())))}:{success:!0,data:i.value}},ri=rn(t9),ra=e=>async(t,r,s)=>{let n=s?Object.assign(s,{async:!0}):{async:!0},i=t._zod.run({value:r,issues:[]},n);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new e(i.issues.map(e=>tH(e,n,e7())))}:{success:!0,data:i.value}},ro=ra(t9),rl=/^[cC][^\s-]{8,}$/,rc=/^[0-9a-z]+$/,ru=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,rd=/^[0-9a-vA-V]{20}$/,rh=/^[A-Za-z0-9]{27}$/,rp=/^[a-zA-Z0-9_-]{21}$/,rf=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,rm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,rg=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,ry=rg(4),rv=rg(6),rb=rg(7),rx=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,rw=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u;function r_(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let rk=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,rj=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,rS=e=>{let t=tO(e??":");return RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},rE=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,r$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rz=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,rN=/^[A-Za-z0-9_-]*$/,rO=/^\+[1-9]\d{6,14}$/,rT="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",rR=RegExp(`^${rT}$`);function rC(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function rP(e){return RegExp(`^${rC(e)}$`)}function rA(e){let t=rC({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let s=`${t}(?:${r.join("|")})`;return RegExp(`^${rT}T(?:${s})$`)}let rI=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},rF=/^-?\d+n?$/,rM=/^-?\d+$/,rD=/^-?\d+(?:\.\d+)?$/,rL=/^(?:true|false)$/i,rU=/^null$/i,rB=/^undefined$/i,rZ=/^[^A-Z]*$/,rW=/^[^a-z]*$/;function rQ(e,t){return RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function rq(e){return RegExp(`^[A-Za-z0-9_-]{${e}}$`)}let rJ=rQ(22,"=="),rH=rq(22),rV=rQ(27,"="),rG=rq(27),rK=rQ(43,"="),rX=rq(43),rY=rQ(64,""),r0=rq(64),r1=rQ(86,"=="),r2=rq(86);e.s(["base64",0,rz,"base64url",0,rN,"bigint",0,rF,"boolean",0,rL,"browserEmail",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"cidrv4",0,rE,"cidrv6",0,r$,"cuid",0,rl,"cuid2",0,rc,"date",0,rR,"datetime",()=>rA,"domain",0,/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,"duration",0,rf,"e164",0,rO,"email",0,rx,"emoji",()=>r_,"extendedDuration",0,/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,"guid",0,rm,"hex",0,/^[0-9a-fA-F]*$/,"hostname",0,/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,"html5Email",0,/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,"idnEmail",0,rw,"integer",0,rM,"ipv4",0,rk,"ipv6",0,rj,"ksuid",0,rh,"lowercase",0,rZ,"mac",0,rS,"md5_base64",0,rJ,"md5_base64url",0,rH,"md5_hex",0,/^[0-9a-fA-F]{32}$/,"nanoid",0,rp,"null",()=>rU,"number",0,rD,"rfc5322Email",0,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,"sha1_base64",0,rV,"sha1_base64url",0,rG,"sha1_hex",0,/^[0-9a-fA-F]{40}$/,"sha256_base64",0,rK,"sha256_base64url",0,rX,"sha256_hex",0,/^[0-9a-fA-F]{64}$/,"sha384_base64",0,rY,"sha384_base64url",0,r0,"sha384_hex",0,/^[0-9a-fA-F]{96}$/,"sha512_base64",0,r1,"sha512_base64url",0,r2,"sha512_hex",0,/^[0-9a-fA-F]{128}$/,"string",0,rI,"time",()=>rP,"ulid",0,ru,"undefined",()=>rB,"unicodeEmail",0,rw,"uppercase",0,rW,"uuid",0,rg,"uuid4",0,ry,"uuid6",0,rv,"uuid7",0,rb,"xid",0,rd],82358);let r3=e4("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),r4={number:"number",bigint:"bigint",object:"date"},r5=e4("$ZodCheckLessThan",(e,t)=>{r3.init(e,t);let r=r4[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,s=(t.inclusive?r.maximum:r.exclusiveMaximum)??1/0;t.value<s&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=s=>{(t.inclusive?s.value<=t.value:s.value<t.value)||s.issues.push({origin:r,code:"too_big",maximum:"object"==typeof t.value?t.value.getTime():t.value,input:s.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r6=e4("$ZodCheckGreaterThan",(e,t)=>{r3.init(e,t);let r=r4[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,s=(t.inclusive?r.minimum:r.exclusiveMinimum)??-1/0;t.value>s&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=s=>{(t.inclusive?s.value>=t.value:s.value>t.value)||s.issues.push({origin:r,code:"too_small",minimum:"object"==typeof t.value?t.value.getTime():t.value,input:s.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),r8=e4("$ZodCheckMultipleOf",(e,t)=>{r3.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===tu(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),r7=e4("$ZodCheckNumberFormat",(e,t)=>{r3.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),s=r?"int":"number",[n,i]=tI[t.format];e._zod.onattach.push(e=>{let s=e._zod.bag;s.format=t.format,s.minimum=n,s.maximum=i,r&&(s.pattern=rM)}),e._zod.check=a=>{let o=a.value;if(r){if(!Number.isInteger(o))return void a.issues.push({expected:s,format:t.format,code:"invalid_type",continue:!1,input:o,inst:e});if(!Number.isSafeInteger(o))return void(o>0?a.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:s,inclusive:!0,continue:!t.abort}):a.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:s,inclusive:!0,continue:!t.abort}))}o<n&&a.issues.push({origin:"number",input:o,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),o>i&&a.issues.push({origin:"number",input:o,code:"too_big",maximum:i,inclusive:!0,inst:e,continue:!t.abort})}}),r9=e4("$ZodCheckBigIntFormat",(e,t)=>{r3.init(e,t);let[r,s]=tF[t.format];e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,n.minimum=r,n.maximum=s}),e._zod.check=n=>{let i=n.value;i<r&&n.issues.push({origin:"bigint",input:i,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),i>s&&n.issues.push({origin:"bigint",input:i,code:"too_big",maximum:s,inclusive:!0,inst:e,continue:!t.abort})}}),se=e4("$ZodCheckMaxSize",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let s=r.value;s.size<=t.maximum||r.issues.push({origin:tV(s),code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),st=e4("$ZodCheckMinSize",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let s=r.value;s.size>=t.minimum||r.issues.push({origin:tV(s),code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),sr=e4("$ZodCheckSizeEquals",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.size}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=r=>{let s=r.value,n=s.size;if(n===t.size)return;let i=n>t.size;r.issues.push({origin:tV(s),...i?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),ss=e4("$ZodCheckMaxLength",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??1/0;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let s=r.value;if(s.length<=t.maximum)return;let n=tG(s);r.issues.push({origin:n,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),sn=e4("$ZodCheckMinLength",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??-1/0;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let s=r.value;if(s.length>=t.minimum)return;let n=tG(s);r.issues.push({origin:n,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),si=e4("$ZodCheckLengthEquals",(e,t)=>{var r;r3.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!tl(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let s=r.value,n=s.length;if(n===t.length)return;let i=tG(s),a=n>t.length;r.issues.push({origin:i,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),sa=e4("$ZodCheckStringFormat",(e,t)=>{var r,s;r3.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(s=e._zod).check??(s.check=()=>{})}),so=e4("$ZodCheckRegex",(e,t)=>{sa.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),sl=e4("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=rZ),sa.init(e,t)}),sc=e4("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=rW),sa.init(e,t)}),su=e4("$ZodCheckIncludes",(e,t)=>{r3.init(e,t);let r=tO(t.includes),s=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=s,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(s)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),sd=e4("$ZodCheckStartsWith",(e,t)=>{r3.init(e,t);let r=RegExp(`^${tO(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),sh=e4("$ZodCheckEndsWith",(e,t)=>{r3.init(e,t);let r=RegExp(`.*${tO(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}});(e,t)=>{r3.init(e,t);let r=new Set(t.mime);e._zod.onattach.push(e=>{e._zod.bag.mime=t.mime}),e._zod.check=s=>{r.has(s.value.type)||s.issues.push({code:"invalid_value",values:t.mime,input:s.value.type,inst:e,continue:!t.abort})}};let sp=e4("$ZodCheckOverwrite",(e,t)=>{r3.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}});class sf{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}let sm={major:4,minor:3,patch:5},sg=e4("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=sm;let s=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&s.unshift(e),s))for(let r of t._zod.onattach)r(e);if(0===s.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let s,n=tQ(e);for(let i of t){if(i._zod.def.when){if(!i._zod.def.when(e))continue}else if(n)continue;let t=e.issues.length,a=i._zod.check(e);if(a instanceof Promise&&r?.async===!1)throw new e5;if(s||a instanceof Promise)s=(s??Promise.resolve()).then(async()=>{await a,e.issues.length!==t&&(n||(n=tQ(e,t)))});else{if(e.issues.length===t)continue;n||(n=tQ(e,t))}}return s?s.then(()=>e):e},r=(r,n,i)=>{if(tQ(r))return r.aborted=!0,r;let a=t(n,s,i);if(a instanceof Promise){if(!1===i.async)throw new e5;return a.then(t=>e._zod.parse(t,i))}return e._zod.parse(a,i)};e._zod.run=(n,i)=>{if(i.skipChecks)return e._zod.parse(n,i);if("backward"===i.direction){let t=e._zod.parse({value:n.value,issues:[]},{...i,skipChecks:!0});return t instanceof Promise?t.then(e=>r(e,n,i)):r(t,n,i)}let a=e._zod.parse(n,i);if(a instanceof Promise){if(!1===i.async)throw new e5;return a.then(e=>t(e,s,i))}return t(a,s,i)}}th(e,"~standard",()=>({validate:t=>{try{let r=ri(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return ro(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}))}),sy=e4("$ZodString",(e,t)=>{sg.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??rI(e._zod.bag),e._zod.parse=(r,s)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),sv=e4("$ZodStringFormat",(e,t)=>{sa.init(e,t),sy.init(e,t)}),sb=e4("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=rm),sv.init(e,t)}),sx=e4("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=rg(e))}else t.pattern??(t.pattern=rg());sv.init(e,t)}),sw=e4("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=rx),sv.init(e,t)}),s_=e4("$ZodURL",(e,t)=>{sv.init(e,t),e._zod.check=r=>{try{let s=r.value.trim(),n=new URL(s);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(n.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(n.protocol.endsWith(":")?n.protocol.slice(0,-1):n.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=n.href:r.value=s;return}catch(s){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),sk=e4("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=r_()),sv.init(e,t)}),sj=e4("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=rp),sv.init(e,t)}),sS=e4("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=rl),sv.init(e,t)}),sE=e4("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=rc),sv.init(e,t)}),s$=e4("$ZodULID",(e,t)=>{t.pattern??(t.pattern=ru),sv.init(e,t)}),sz=e4("$ZodXID",(e,t)=>{t.pattern??(t.pattern=rd),sv.init(e,t)}),sN=e4("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=rh),sv.init(e,t)}),sO=e4("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=rA(t)),sv.init(e,t)}),sT=e4("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=rR),sv.init(e,t)}),sR=e4("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=rP(t)),sv.init(e,t)}),sC=e4("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=rf),sv.init(e,t)}),sP=e4("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=rk),sv.init(e,t),e._zod.bag.format="ipv4"}),sA=e4("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=rj),sv.init(e,t),e._zod.bag.format="ipv6",e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),sI=e4("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=rS(t.delimiter)),sv.init(e,t),e._zod.bag.format="mac"}),sF=e4("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=rE),sv.init(e,t)}),sM=e4("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=r$),sv.init(e,t),e._zod.check=r=>{let s=r.value.split("/");try{if(2!==s.length)throw Error();let[e,t]=s;if(!t)throw Error();let r=Number(t);if(`${r}`!==t||r<0||r>128)throw Error();new URL(`http://[${e}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function sD(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let sL=e4("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=rz),sv.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=r=>{sD(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function sU(e){if(!rN.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return sD(t.padEnd(4*Math.ceil(t.length/4),"="))}let sB=e4("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=rN),sv.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=r=>{sU(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),sZ=e4("$ZodE164",(e,t)=>{t.pattern??(t.pattern=rO),sv.init(e,t)});function sW(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[s]=r;if(!s)return!1;let n=JSON.parse(atob(s));if("typ"in n&&n?.typ!=="JWT"||!n.alg||t&&(!("alg"in n)||n.alg!==t))return!1;return!0}catch{return!1}}let sQ=e4("$ZodJWT",(e,t)=>{sv.init(e,t),e._zod.check=r=>{sW(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),sq=e4("$ZodCustomStringFormat",(e,t)=>{sv.init(e,t),e._zod.check=r=>{t.fn(r.value)||r.issues.push({code:"invalid_format",format:t.format,input:r.value,inst:e,continue:!t.abort})}}),sJ=e4("$ZodNumber",(e,t)=>{sg.init(e,t),e._zod.pattern=e._zod.bag.pattern??rD,e._zod.parse=(r,s)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let n=r.value;if("number"==typeof n&&!Number.isNaN(n)&&Number.isFinite(n))return r;let i="number"==typeof n?Number.isNaN(n)?"NaN":Number.isFinite(n)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:n,inst:e,...i?{received:i}:{}}),r}}),sH=e4("$ZodNumberFormat",(e,t)=>{r7.init(e,t),sJ.init(e,t)}),sV=e4("$ZodBoolean",(e,t)=>{sg.init(e,t),e._zod.pattern=rL,e._zod.parse=(r,s)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let n=r.value;return"boolean"==typeof n||r.issues.push({expected:"boolean",code:"invalid_type",input:n,inst:e}),r}}),sG=e4("$ZodBigInt",(e,t)=>{sg.init(e,t),e._zod.pattern=rF,e._zod.parse=(r,s)=>{if(t.coerce)try{r.value=BigInt(r.value)}catch(e){}return"bigint"==typeof r.value||r.issues.push({expected:"bigint",code:"invalid_type",input:r.value,inst:e}),r}}),sK=e4("$ZodBigIntFormat",(e,t)=>{r9.init(e,t),sG.init(e,t)}),sX=e4("$ZodSymbol",(e,t)=>{sg.init(e,t),e._zod.parse=(t,r)=>{let s=t.value;return"symbol"==typeof s||t.issues.push({expected:"symbol",code:"invalid_type",input:s,inst:e}),t}}),sY=e4("$ZodUndefined",(e,t)=>{sg.init(e,t),e._zod.pattern=rB,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(t,r)=>{let s=t.value;return void 0===s||t.issues.push({expected:"undefined",code:"invalid_type",input:s,inst:e}),t}}),s0=e4("$ZodNull",(e,t)=>{sg.init(e,t),e._zod.pattern=rU,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let s=t.value;return null===s||t.issues.push({expected:"null",code:"invalid_type",input:s,inst:e}),t}}),s1=e4("$ZodAny",(e,t)=>{sg.init(e,t),e._zod.parse=e=>e}),s2=e4("$ZodUnknown",(e,t)=>{sg.init(e,t),e._zod.parse=e=>e}),s3=e4("$ZodNever",(e,t)=>{sg.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}),s4=e4("$ZodVoid",(e,t)=>{sg.init(e,t),e._zod.parse=(t,r)=>{let s=t.value;return void 0===s||t.issues.push({expected:"void",code:"invalid_type",input:s,inst:e}),t}}),s5=e4("$ZodDate",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{if(t.coerce)try{r.value=new Date(r.value)}catch(e){}let n=r.value,i=n instanceof Date;return i&&!Number.isNaN(n.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:n,...i?{received:"Invalid Date"}:{},inst:e}),r}});function s6(e,t,r){e.issues.length&&t.issues.push(...tq(r,e.issues)),t.value[r]=e.value}let s8=e4("$ZodArray",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{let n=r.value;if(!Array.isArray(n))return r.issues.push({expected:"array",code:"invalid_type",input:n,inst:e}),r;r.value=Array(n.length);let i=[];for(let e=0;e<n.length;e++){let a=n[e],o=t.element._zod.run({value:a,issues:[]},s);o instanceof Promise?i.push(o.then(t=>s6(t,r,e))):s6(o,r,e)}return i.length?Promise.all(i).then(()=>r):r}});function s7(e,t,r,s,n){if(e.issues.length){if(n&&!(r in s))return;t.issues.push(...tq(r,e.issues))}void 0===e.value?r in s&&(t.value[r]=void 0):t.value[r]=e.value}function s9(e){let t=Object.keys(e.shape);for(let r of t)if(!e.shape?.[r]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=tA(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function ne(e,t,r,s,n,i){let a=[],o=n.keySet,l=n.catchall._zod,c=l.def.type,u="optional"===l.optout;for(let n in t){if(o.has(n))continue;if("never"===c){a.push(n);continue}let i=l.run({value:t[n],issues:[]},s);i instanceof Promise?e.push(i.then(e=>s7(e,r,n,t,u))):s7(i,r,n,t,u)}return(a.length&&r.issues.push({code:"unrecognized_keys",keys:a,input:t,inst:i}),e.length)?Promise.all(e).then(()=>r):r}let nt=e4("$ZodObject",(e,t)=>{let r;sg.init(e,t);let s=Object.getOwnPropertyDescriptor(t,"shape");if(!s?.get){let e=t.shape;Object.defineProperty(t,"shape",{get:()=>{let r={...e};return Object.defineProperty(t,"shape",{value:r}),r}})}let n=to(()=>s9(t));th(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let s=e[t]._zod;if(s.values)for(let e of(r[t]??(r[t]=new Set),s.values))r[t].add(e)}return r});let i=t.catchall;e._zod.parse=(t,s)=>{r??(r=n.value);let a=t.value;if(!tk(a))return t.issues.push({expected:"object",code:"invalid_type",input:a,inst:e}),t;t.value={};let o=[],l=r.shape;for(let e of r.keys){let r=l[e],n="optional"===r._zod.optout,i=r._zod.run({value:a[e],issues:[]},s);i instanceof Promise?o.push(i.then(r=>s7(r,t,e,a,n))):s7(i,t,e,a,n)}return i?ne(o,a,t,s,n.value,e):o.length?Promise.all(o).then(()=>t):t}}),nr=e4("$ZodObjectJIT",(e,t)=>{let r,s;nt.init(e,t);let n=e._zod.parse,i=to(()=>s9(t)),a=!e8.jitless,o=a&&tj.value,l=t.catchall;e._zod.parse=(c,u)=>{s??(s=i.value);let d=c.value;return tk(d)?a&&o&&u?.async===!1&&!0!==u.jitless?(r||(r=(e=>{let t=new sf(["shape","payload","ctx"]),r=i.value,s=e=>{let t=tx(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let n=Object.create(null),a=0;for(let e of r.keys)n[e]=`key_${a++}`;for(let i of(t.write("const newResult = {};"),r.keys)){let r=n[i],a=tx(i),o=e[i],l=o?._zod?.optout==="optional";t.write(`const ${r} = ${s(i)};`),l?t.write(`
        if (${r}.issues.length) {
          if (${a} in input) {
            payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${a}, ...iss.path] : [${a}]
            })));
          }
        }
        
        if (${r}.value === undefined) {
          if (${a} in input) {
            newResult[${a}] = undefined;
          }
        } else {
          newResult[${a}] = ${r}.value;
        }
        
      `):t.write(`
        if (${r}.issues.length) {
          payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${a}, ...iss.path] : [${a}]
          })));
        }
        
        if (${r}.value === undefined) {
          if (${a} in input) {
            newResult[${a}] = undefined;
          }
        } else {
          newResult[${a}] = ${r}.value;
        }
        
      `)}t.write("payload.value = newResult;"),t.write("return payload;");let o=t.compile();return(t,r)=>o(e,t,r)})(t.shape)),c=r(c,u),l)?ne([],d,c,u,s,e):c:n(c,u):(c.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),c)}});function ns(e,t,r,s){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;let n=e.filter(e=>!tQ(e));return 1===n.length?(t.value=n[0].value,n[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>tH(e,s,e7())))}),t)}let nn=e4("$ZodUnion",(e,t)=>{sg.init(e,t),th(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),th(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),th(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),th(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>tc(e.source)).join("|")})$`)}});let r=1===t.options.length,s=t.options[0]._zod.run;e._zod.parse=(n,i)=>{if(r)return s(n,i);let a=!1,o=[];for(let e of t.options){let t=e._zod.run({value:n.value,issues:[]},i);if(t instanceof Promise)o.push(t),a=!0;else{if(0===t.issues.length)return t;o.push(t)}}return a?Promise.all(o).then(t=>ns(t,n,e,i)):ns(o,n,e,i)}});function ni(e,t,r,s){let n=e.filter(e=>0===e.issues.length);return 1===n.length?t.value=n[0].value:0===n.length?t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>tH(e,s,e7())))}):t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:[],inclusive:!1}),t}let na=e4("$ZodXor",(e,t)=>{nn.init(e,t),t.inclusive=!1;let r=1===t.options.length,s=t.options[0]._zod.run;e._zod.parse=(n,i)=>{if(r)return s(n,i);let a=!1,o=[];for(let e of t.options){let t=e._zod.run({value:n.value,issues:[]},i);t instanceof Promise?(o.push(t),a=!0):o.push(t)}return a?Promise.all(o).then(t=>ni(t,n,e,i)):ni(o,n,e,i)}}),no=e4("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,nn.init(e,t);let r=e._zod.parse;th(e._zod,"propValues",()=>{let e={};for(let r of t.options){let s=r._zod.propValues;if(!s||0===Object.keys(s).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(s))for(let s of(e[t]||(e[t]=new Set),r))e[t].add(s)}return e});let s=to(()=>{let e=t.options,r=new Map;for(let s of e){let e=s._zod.propValues?.[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,s)}}return r});e._zod.parse=(n,i)=>{let a=n.value;if(!tk(a))return n.issues.push({code:"invalid_type",expected:"object",input:a,inst:e}),n;let o=s.value.get(a?.[t.discriminator]);return o?o._zod.run(n,i):t.unionFallback?r(n,i):(n.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:a,path:[t.discriminator],inst:e}),n)}}),nl=e4("$ZodIntersection",(e,t)=>{sg.init(e,t),e._zod.parse=(e,r)=>{let s=e.value,n=t.left._zod.run({value:s,issues:[]},r),i=t.right._zod.run({value:s,issues:[]},r);return n instanceof Promise||i instanceof Promise?Promise.all([n,i]).then(([t,r])=>nc(e,t,r)):nc(e,n,i)}});function nc(e,t,r){let s,n=new Map;for(let r of t.issues)if("unrecognized_keys"===r.code)for(let e of(s??(s=r),r.keys))n.has(e)||n.set(e,{}),n.get(e).l=!0;else e.issues.push(r);for(let t of r.issues)if("unrecognized_keys"===t.code)for(let e of t.keys)n.has(e)||n.set(e,{}),n.get(e).r=!0;else e.issues.push(t);let i=[...n].filter(([,e])=>e.l&&e.r).map(([e])=>e);if(i.length&&s&&e.issues.push({...s,keys:i}),tQ(e))return e;let a=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(tS(t)&&tS(r)){let s=Object.keys(r),n=Object.keys(t).filter(e=>-1!==s.indexOf(e)),i={...t,...r};for(let s of n){let n=e(t[s],r[s]);if(!n.valid)return{valid:!1,mergeErrorPath:[s,...n.mergeErrorPath]};i[s]=n.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let s=[];for(let n=0;n<t.length;n++){let i=e(t[n],r[n]);if(!i.valid)return{valid:!1,mergeErrorPath:[n,...i.mergeErrorPath]};s.push(i.data)}return{valid:!0,data:s}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!a.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(a.mergeErrorPath)}`);return e.value=a.data,e}let nu=e4("$ZodTuple",(e,t)=>{sg.init(e,t);let r=t.items;e._zod.parse=(s,n)=>{let i=s.value;if(!Array.isArray(i))return s.issues.push({input:i,inst:e,expected:"tuple",code:"invalid_type"}),s;s.value=[];let a=[],o=[...r].reverse().findIndex(e=>"optional"!==e._zod.optin),l=-1===o?0:r.length-o;if(!t.rest){let t=i.length>r.length,n=i.length<l-1;if(t||n)return s.issues.push({...t?{code:"too_big",maximum:r.length,inclusive:!0}:{code:"too_small",minimum:r.length},input:i,inst:e,origin:"array"}),s}let c=-1;for(let e of r){if(++c>=i.length&&c>=l)continue;let t=e._zod.run({value:i[c],issues:[]},n);t instanceof Promise?a.push(t.then(e=>nd(e,s,c))):nd(t,s,c)}if(t.rest)for(let e of i.slice(r.length)){c++;let r=t.rest._zod.run({value:e,issues:[]},n);r instanceof Promise?a.push(r.then(e=>nd(e,s,c))):nd(r,s,c)}return a.length?Promise.all(a).then(()=>s):s}});function nd(e,t,r){e.issues.length&&t.issues.push(...tq(r,e.issues)),t.value[r]=e.value}let nh=e4("$ZodRecord",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{let n=r.value;if(!tS(n))return r.issues.push({expected:"record",code:"invalid_type",input:n,inst:e}),r;let i=[],a=t.keyType._zod.values;if(a){let o;r.value={};let l=new Set;for(let e of a)if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){l.add("number"==typeof e?e.toString():e);let a=t.valueType._zod.run({value:n[e],issues:[]},s);a instanceof Promise?i.push(a.then(t=>{t.issues.length&&r.issues.push(...tq(e,t.issues)),r.value[e]=t.value})):(a.issues.length&&r.issues.push(...tq(e,a.issues)),r.value[e]=a.value)}for(let e in n)l.has(e)||(o=o??[]).push(e);o&&o.length>0&&r.issues.push({code:"unrecognized_keys",input:n,inst:e,keys:o})}else for(let a of(r.value={},Reflect.ownKeys(n))){if("__proto__"===a)continue;let o=t.keyType._zod.run({value:a,issues:[]},s);if(o instanceof Promise)throw Error("Async schemas not supported in object keys currently");if("string"==typeof a&&rD.test(a)&&o.issues.length&&o.issues.some(e=>"invalid_type"===e.code&&"number"===e.expected)){let e=t.keyType._zod.run({value:Number(a),issues:[]},s);if(e instanceof Promise)throw Error("Async schemas not supported in object keys currently");0===e.issues.length&&(o=e)}if(o.issues.length){"loose"===t.mode?r.value[a]=n[a]:r.issues.push({code:"invalid_key",origin:"record",issues:o.issues.map(e=>tH(e,s,e7())),input:a,path:[a],inst:e});continue}let l=t.valueType._zod.run({value:n[a],issues:[]},s);l instanceof Promise?i.push(l.then(e=>{e.issues.length&&r.issues.push(...tq(a,e.issues)),r.value[o.value]=e.value})):(l.issues.length&&r.issues.push(...tq(a,l.issues)),r.value[o.value]=l.value)}return i.length?Promise.all(i).then(()=>r):r}}),np=e4("$ZodMap",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{let n=r.value;if(!(n instanceof Map))return r.issues.push({expected:"map",code:"invalid_type",input:n,inst:e}),r;let i=[];for(let[a,o]of(r.value=new Map,n)){let l=t.keyType._zod.run({value:a,issues:[]},s),c=t.valueType._zod.run({value:o,issues:[]},s);l instanceof Promise||c instanceof Promise?i.push(Promise.all([l,c]).then(([t,i])=>{nf(t,i,r,a,n,e,s)})):nf(l,c,r,a,n,e,s)}return i.length?Promise.all(i).then(()=>r):r}});function nf(e,t,r,s,n,i,a){e.issues.length&&(tz.has(typeof s)?r.issues.push(...tq(s,e.issues)):r.issues.push({code:"invalid_key",origin:"map",input:n,inst:i,issues:e.issues.map(e=>tH(e,a,e7()))})),t.issues.length&&(tz.has(typeof s)?r.issues.push(...tq(s,t.issues)):r.issues.push({origin:"map",code:"invalid_element",input:n,inst:i,key:s,issues:t.issues.map(e=>tH(e,a,e7()))})),r.value.set(e.value,t.value)}let nm=e4("$ZodSet",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{let n=r.value;if(!(n instanceof Set))return r.issues.push({input:n,inst:e,expected:"set",code:"invalid_type"}),r;let i=[];for(let e of(r.value=new Set,n)){let n=t.valueType._zod.run({value:e,issues:[]},s);n instanceof Promise?i.push(n.then(e=>ng(e,r))):ng(n,r)}return i.length?Promise.all(i).then(()=>r):r}});function ng(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}let ny=e4("$ZodEnum",(e,t)=>{sg.init(e,t);let r=tn(t.entries),s=new Set(r);e._zod.values=s,e._zod.pattern=RegExp(`^(${r.filter(e=>tz.has(typeof e)).map(e=>"string"==typeof e?tO(e):e.toString()).join("|")})$`),e._zod.parse=(t,n)=>{let i=t.value;return s.has(i)||t.issues.push({code:"invalid_value",values:r,input:i,inst:e}),t}}),nv=e4("$ZodLiteral",(e,t)=>{if(sg.init(e,t),0===t.values.length)throw Error("Cannot create literal schema with no valid values");let r=new Set(t.values);e._zod.values=r,e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?tO(e):e?tO(e.toString()):String(e)).join("|")})$`),e._zod.parse=(s,n)=>{let i=s.value;return r.has(i)||s.issues.push({code:"invalid_value",values:t.values,input:i,inst:e}),s}}),nb=e4("$ZodFile",(e,t)=>{sg.init(e,t),e._zod.parse=(t,r)=>{let s=t.value;return s instanceof File||t.issues.push({expected:"file",code:"invalid_type",input:s,inst:e}),t}}),nx=e4("$ZodTransform",(e,t)=>{sg.init(e,t),e._zod.parse=(r,s)=>{if("backward"===s.direction)throw new e6(e.constructor.name);let n=t.transform(r.value,r);if(s.async)return(n instanceof Promise?n:Promise.resolve(n)).then(e=>(r.value=e,r));if(n instanceof Promise)throw new e5;return r.value=n,r}});function nw(e,t){return e.issues.length&&void 0===t?{issues:[],value:void 0}:e}let n_=e4("$ZodOptional",(e,t)=>{sg.init(e,t),e._zod.optin="optional",e._zod.optout="optional",th(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),th(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tc(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>{if("optional"===t.innerType._zod.optin){let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(t=>nw(t,e.value)):nw(s,e.value)}return void 0===e.value?e:t.innerType._zod.run(e,r)}}),nk=e4("$ZodExactOptional",(e,t)=>{n_.init(e,t),th(e._zod,"values",()=>t.innerType._zod.values),th(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(e,r)=>t.innerType._zod.run(e,r)}),nj=e4("$ZodNullable",(e,t)=>{sg.init(e,t),th(e._zod,"optin",()=>t.innerType._zod.optin),th(e._zod,"optout",()=>t.innerType._zod.optout),th(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${tc(e.source)}|null)$`):void 0}),th(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),nS=e4("$ZodDefault",(e,t)=>{sg.init(e,t),e._zod.optin="optional",th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);if(void 0===e.value)return e.value=t.defaultValue,e;let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(e=>nE(e,t)):nE(s,t)}});function nE(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let n$=e4("$ZodPrefault",(e,t)=>{sg.init(e,t),e._zod.optin="optional",th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>("backward"===r.direction||void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),nz=e4("$ZodNonOptional",(e,t)=>{sg.init(e,t),th(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,s)=>{let n=t.innerType._zod.run(r,s);return n instanceof Promise?n.then(t=>nN(t,e)):nN(n,e)}});function nN(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let nO=e4("$ZodSuccess",(e,t)=>{sg.init(e,t),e._zod.parse=(e,r)=>{if("backward"===r.direction)throw new e6("ZodSuccess");let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(t=>(e.value=0===t.issues.length,e)):(e.value=0===s.issues.length,e)}}),nT=e4("$ZodCatch",(e,t)=>{sg.init(e,t),th(e._zod,"optin",()=>t.innerType._zod.optin),th(e._zod,"optout",()=>t.innerType._zod.optout),th(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(s=>(e.value=s.value,s.issues.length&&(e.value=t.catchValue({...e,error:{issues:s.issues.map(e=>tH(e,r,e7()))},input:e.value}),e.issues=[]),e)):(e.value=s.value,s.issues.length&&(e.value=t.catchValue({...e,error:{issues:s.issues.map(e=>tH(e,r,e7()))},input:e.value}),e.issues=[]),e)}}),nR=e4("$ZodNaN",(e,t)=>{sg.init(e,t),e._zod.parse=(t,r)=>("number"==typeof t.value&&Number.isNaN(t.value)||t.issues.push({input:t.value,inst:e,expected:"nan",code:"invalid_type"}),t)}),nC=e4("$ZodPipe",(e,t)=>{sg.init(e,t),th(e._zod,"values",()=>t.in._zod.values),th(e._zod,"optin",()=>t.in._zod.optin),th(e._zod,"optout",()=>t.out._zod.optout),th(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("backward"===r.direction){let s=t.out._zod.run(e,r);return s instanceof Promise?s.then(e=>nP(e,t.in,r)):nP(s,t.in,r)}let s=t.in._zod.run(e,r);return s instanceof Promise?s.then(e=>nP(e,t.out,r)):nP(s,t.out,r)}});function nP(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}let nA=e4("$ZodCodec",(e,t)=>{sg.init(e,t),th(e._zod,"values",()=>t.in._zod.values),th(e._zod,"optin",()=>t.in._zod.optin),th(e._zod,"optout",()=>t.out._zod.optout),th(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(e,r)=>{if("forward"===(r.direction||"forward")){let s=t.in._zod.run(e,r);return s instanceof Promise?s.then(e=>nI(e,t,r)):nI(s,t,r)}{let s=t.out._zod.run(e,r);return s instanceof Promise?s.then(e=>nI(e,t,r)):nI(s,t,r)}}});function nI(e,t,r){if(e.issues.length)return e.aborted=!0,e;if("forward"===(r.direction||"forward")){let s=t.transform(e.value,e);return s instanceof Promise?s.then(s=>nF(e,s,t.out,r)):nF(e,s,t.out,r)}{let s=t.reverseTransform(e.value,e);return s instanceof Promise?s.then(s=>nF(e,s,t.in,r)):nF(e,s,t.in,r)}}function nF(e,t,r,s){return e.issues.length?(e.aborted=!0,e):r._zod.run({value:t,issues:e.issues},s)}let nM=e4("$ZodReadonly",(e,t)=>{sg.init(e,t),th(e._zod,"propValues",()=>t.innerType._zod.propValues),th(e._zod,"values",()=>t.innerType._zod.values),th(e._zod,"optin",()=>t.innerType?._zod?.optin),th(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(e,r)=>{if("backward"===r.direction)return t.innerType._zod.run(e,r);let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(nD):nD(s)}});function nD(e){return e.value=Object.freeze(e.value),e}let nL=e4("$ZodTemplateLiteral",(e,t)=>{sg.init(e,t);let r=[];for(let e of t.parts)if("object"==typeof e&&null!==e){if(!e._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...e._zod.traits].shift()}`);let t=e._zod.pattern instanceof RegExp?e._zod.pattern.source:e._zod.pattern;if(!t)throw Error(`Invalid template literal part: ${e._zod.traits}`);let s=+!!t.startsWith("^"),n=t.endsWith("$")?t.length-1:t.length;r.push(t.slice(s,n))}else if(null===e||tN.has(typeof e))r.push(tO(`${e}`));else throw Error(`Invalid template literal part: ${e}`);e._zod.pattern=RegExp(`^${r.join("")}$`),e._zod.parse=(r,s)=>("string"!=typeof r.value?r.issues.push({input:r.value,inst:e,expected:"string",code:"invalid_type"}):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source})),r)}),nU=e4("$ZodFunction",(e,t)=>(sg.init(e,t),e._def=t,e._zod.def=t,e.implement=t=>{if("function"!=typeof t)throw Error("implement() must be called with a function");return function(...r){let s=Reflect.apply(t,this,e._def.input?rt(e._def.input,r):r);return e._def.output?rt(e._def.output,s):s}},e.implementAsync=t=>{if("function"!=typeof t)throw Error("implementAsync() must be called with a function");return async function(...r){let s=e._def.input?await rs(e._def.input,r):r,n=await Reflect.apply(t,this,s);return e._def.output?await rs(e._def.output,n):n}},e._zod.parse=(t,r)=>("function"!=typeof t.value?t.issues.push({code:"invalid_type",expected:"function",input:t.value,inst:e}):e._def.output&&"promise"===e._def.output._zod.def.type?t.value=e.implementAsync(t.value):t.value=e.implement(t.value),t),e.input=(...t)=>{let r=e.constructor;return new r(Array.isArray(t[0])?{type:"function",input:new nu({type:"tuple",items:t[0],rest:t[1]}),output:e._def.output}:{type:"function",input:t[0],output:e._def.output})},e.output=t=>new e.constructor({type:"function",input:e._def.input,output:t}),e)),nB=e4("$ZodPromise",(e,t)=>{sg.init(e,t),e._zod.parse=(e,r)=>Promise.resolve(e.value).then(e=>t.innerType._zod.run({value:e,issues:[]},r))}),nZ=e4("$ZodLazy",(e,t)=>{sg.init(e,t),th(e._zod,"innerType",()=>t.getter()),th(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),th(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),th(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),th(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),nW=e4("$ZodCustom",(e,t)=>{r3.init(e,t),sg.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let s=r.value,n=t.fn(s);if(n instanceof Promise)return n.then(t=>nQ(t,r,s,e));nQ(n,r,s,e)}});function nQ(e,t,r,s){if(!e){let e={code:"custom",input:r,inst:s,path:[...s._zod.def.path??[]],continue:!s._zod.def.abort};s._zod.def.params&&(e.params=s._zod.def.params),t.issues.push(tX(e))}}e.s(["$ZodAny",0,s1,"$ZodArray",0,s8,"$ZodBase64",0,sL,"$ZodBase64URL",0,sB,"$ZodBigInt",0,sG,"$ZodBigIntFormat",0,sK,"$ZodBoolean",0,sV,"$ZodCIDRv4",0,sF,"$ZodCIDRv6",0,sM,"$ZodCUID",0,sS,"$ZodCUID2",0,sE,"$ZodCatch",0,nT,"$ZodCodec",0,nA,"$ZodCustom",0,nW,"$ZodCustomStringFormat",0,sq,"$ZodDate",0,s5,"$ZodDefault",0,nS,"$ZodDiscriminatedUnion",0,no,"$ZodE164",0,sZ,"$ZodEmail",0,sw,"$ZodEmoji",0,sk,"$ZodEnum",0,ny,"$ZodExactOptional",0,nk,"$ZodFile",0,nb,"$ZodFunction",0,nU,"$ZodGUID",0,sb,"$ZodIPv4",0,sP,"$ZodIPv6",0,sA,"$ZodISODate",0,sT,"$ZodISODateTime",0,sO,"$ZodISODuration",0,sC,"$ZodISOTime",0,sR,"$ZodIntersection",0,nl,"$ZodJWT",0,sQ,"$ZodKSUID",0,sN,"$ZodLazy",0,nZ,"$ZodLiteral",0,nv,"$ZodMAC",0,sI,"$ZodMap",0,np,"$ZodNaN",0,nR,"$ZodNanoID",0,sj,"$ZodNever",0,s3,"$ZodNonOptional",0,nz,"$ZodNull",0,s0,"$ZodNullable",0,nj,"$ZodNumber",0,sJ,"$ZodNumberFormat",0,sH,"$ZodObject",0,nt,"$ZodObjectJIT",0,nr,"$ZodOptional",0,n_,"$ZodPipe",0,nC,"$ZodPrefault",0,n$,"$ZodPromise",0,nB,"$ZodReadonly",0,nM,"$ZodRecord",0,nh,"$ZodSet",0,nm,"$ZodString",0,sy,"$ZodStringFormat",0,sv,"$ZodSuccess",0,nO,"$ZodSymbol",0,sX,"$ZodTemplateLiteral",0,nL,"$ZodTransform",0,nx,"$ZodTuple",0,nu,"$ZodType",0,sg,"$ZodULID",0,s$,"$ZodURL",0,s_,"$ZodUUID",0,sx,"$ZodUndefined",0,sY,"$ZodUnion",0,nn,"$ZodUnknown",0,s2,"$ZodVoid",0,s4,"$ZodXID",0,sz,"$ZodXor",0,na,"isValidBase64",()=>sD,"isValidBase64URL",()=>sU,"isValidJWT",()=>sW],76094),Symbol("ZodOutput"),Symbol("ZodInput");(S=globalThis).__zod_globalRegistry??(S.__zod_globalRegistry=new class e{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){let r=t[0];return this._map.set(e,r),r&&"object"==typeof r&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};delete r.id;let s={...r,...this._map.get(e)};return Object.keys(s).length?s:void 0}return this._map.get(e)}has(e){return this._map.has(e)}});let nq=globalThis.__zod_globalRegistry;function nJ(e,t){return new r5({check:"less_than",...tR(t),value:e,inclusive:!1})}function nH(e,t){return new r5({check:"less_than",...tR(t),value:e,inclusive:!0})}function nV(e,t){return new r6({check:"greater_than",...tR(t),value:e,inclusive:!1})}function nG(e,t){return new r6({check:"greater_than",...tR(t),value:e,inclusive:!0})}function nK(e,t){return new r8({check:"multiple_of",...tR(t),value:e})}function nX(e,t){return new ss({check:"max_length",...tR(t),maximum:e})}function nY(e,t){return new sn({check:"min_length",...tR(t),minimum:e})}function n0(e,t){return new si({check:"length_equals",...tR(t),length:e})}function n1(e){return new sp({check:"overwrite",tx:e})}function n2(e){let t=e?.target??"draft-2020-12";return"draft-4"===t&&(t="draft-04"),"draft-7"===t&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??nq,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function n3(e,t,r={path:[],schemaPath:[]}){var s;let n=e._zod.def,i=t.seen.get(e);if(i)return i.count++,r.schemaPath.includes(e)&&(i.cycle=r.path),i.schema;let a={schema:{},count:1,cycle:void 0,path:r.path};t.seen.set(e,a);let o=e._zod.toJSONSchema?.();if(o)a.schema=o;else{let s={...r,schemaPath:[...r.schemaPath,e],path:r.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,a.schema,s);else{let r=a.schema,i=t.processors[n.type];if(!i)throw Error(`[toJSONSchema]: Non-representable type encountered: ${n.type}`);i(e,t,r,s)}let i=e._zod.parent;i&&(a.ref||(a.ref=i),n3(i,t,s),t.seen.get(i).isParent=!0)}let l=t.metadataRegistry.get(e);return l&&Object.assign(a.schema,l),"input"===t.io&&function e(t,r){let s=r??{seen:new Set};if(s.seen.has(t))return!1;s.seen.add(t);let n=t._zod.def;if("transform"===n.type)return!0;if("array"===n.type)return e(n.element,s);if("set"===n.type)return e(n.valueType,s);if("lazy"===n.type)return e(n.getter(),s);if("promise"===n.type||"optional"===n.type||"nonoptional"===n.type||"nullable"===n.type||"readonly"===n.type||"default"===n.type||"prefault"===n.type)return e(n.innerType,s);if("intersection"===n.type)return e(n.left,s)||e(n.right,s);if("record"===n.type||"map"===n.type)return e(n.keyType,s)||e(n.valueType,s);if("pipe"===n.type)return e(n.in,s)||e(n.out,s);if("object"===n.type){for(let t in n.shape)if(e(n.shape[t],s))return!0;return!1}if("union"===n.type){for(let t of n.options)if(e(t,s))return!0;return!1}if("tuple"===n.type){for(let t of n.items)if(e(t,s))return!0;if(n.rest&&e(n.rest,s))return!0}return!1}(e)&&(delete a.schema.examples,delete a.schema.default),"input"===t.io&&a.schema._prefault&&((s=a.schema).default??(s.default=a.schema._prefault)),delete a.schema._prefault,t.seen.get(e).schema}function n4(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let s=new Map;for(let t of e.seen.entries()){let r=e.metadataRegistry.get(t[0])?.id;if(r){let e=s.get(r);if(e&&e!==t[0])throw Error(`Duplicate schema id "${r}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);s.set(r,t[0])}}let n=t=>{if(t[1].schema.$ref)return;let s=t[1],{ref:n,defId:i}=(t=>{let s="draft-2020-12"===e.target?"$defs":"definitions";if(e.external){let r=e.external.registry.get(t[0])?.id,n=e.external.uri??(e=>e);if(r)return{ref:n(r)};let i=t[1].defId??t[1].schema.id??`schema${e.counter++}`;return t[1].defId=i,{defId:i,ref:`${n("__shared")}#/${s}/${i}`}}if(t[1]===r)return{ref:"#"};let n=`#/${s}/`,i=t[1].schema.id??`__schema${e.counter++}`;return{defId:i,ref:n+i}})(t);s.def={...s.schema},i&&(s.defId=i);let a=s.schema;for(let e in a)delete a[e];a.$ref=n};if("throw"===e.cycles)for(let t of e.seen.entries()){let e=t[1];if(e.cycle)throw Error(`Cycle detected: #/${e.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let r of e.seen.entries()){let s=r[1];if(t===r[0]){n(r);continue}if(e.external){let s=e.external.registry.get(r[0])?.id;if(t!==r[0]&&s){n(r);continue}}if(e.metadataRegistry.get(r[0])?.id||s.cycle||s.count>1&&"ref"===e.reused){n(r);continue}}}function n5(e,t){let r=e.seen.get(t);if(!r)throw Error("Unprocessed schema. This is a bug in Zod.");let s=t=>{let r=e.seen.get(t);if(null===r.ref)return;let n=r.def??r.schema,i={...n},a=r.ref;if(r.ref=null,a){s(a);let r=e.seen.get(a),o=r.schema;if(o.$ref&&("draft-07"===e.target||"draft-04"===e.target||"openapi-3.0"===e.target)?(n.allOf=n.allOf??[],n.allOf.push(o)):Object.assign(n,o),Object.assign(n,i),t._zod.parent===a)for(let e in n)"$ref"!==e&&"allOf"!==e&&(e in i||delete n[e]);if(o.$ref)for(let e in n)"$ref"!==e&&"allOf"!==e&&e in r.def&&JSON.stringify(n[e])===JSON.stringify(r.def[e])&&delete n[e]}let o=t._zod.parent;if(o&&o!==a){s(o);let t=e.seen.get(o);if(t?.schema.$ref&&(n.$ref=t.schema.$ref,t.def))for(let e in n)"$ref"!==e&&"allOf"!==e&&e in t.def&&JSON.stringify(n[e])===JSON.stringify(t.def[e])&&delete n[e]}e.override({zodSchema:t,jsonSchema:n,path:r.path??[]})};for(let t of[...e.seen.entries()].reverse())s(t[0]);let n={};if("draft-2020-12"===e.target?n.$schema="https://json-schema.org/draft/2020-12/schema":"draft-07"===e.target?n.$schema="http://json-schema.org/draft-07/schema#":"draft-04"===e.target?n.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){let r=e.external.registry.get(t)?.id;if(!r)throw Error("Schema is missing an `id` property");n.$id=e.external.uri(r)}Object.assign(n,r.def??r.schema);let i=e.external?.defs??{};for(let t of e.seen.entries()){let e=t[1];e.def&&e.defId&&(i[e.defId]=e.def)}e.external||Object.keys(i).length>0&&("draft-2020-12"===e.target?n.$defs=i:n.definitions=i);try{let r=JSON.parse(JSON.stringify(n));return Object.defineProperty(r,"~standard",{value:{...t["~standard"],jsonSchema:{input:n6(t,"input",e.processors),output:n6(t,"output",e.processors)}},enumerable:!1,writable:!1}),r}catch(e){throw Error("Error converting schema to JSON.")}}let n6=(e,t,r={})=>s=>{let{libraryOptions:n,target:i}=s??{},a=n2({...n??{},target:i,io:t,processors:r});return n3(e,a),n4(a,e),n5(a,e)},n8={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},n7=(e,t,r,s)=>{let n=e._zod.def;n3(n.innerType,t,s),t.seen.get(e).ref=n.innerType};e.i(76094),e.i(82358);var n9=e.i(22143),n9=n9;(e,t)=>{sO.init(e,t),iy.init(e,t)},(e,t)=>{sC.init(e,t),iy.init(e,t)};let ie=e4("ZodError",(e,t)=>{t7.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>(function(e,t=e=>e.message){let r={_errors:[]},s=e=>{for(let n of e.issues)if("invalid_union"===n.code&&n.errors.length)n.errors.map(e=>s({issues:e}));else if("invalid_key"===n.code)s({issues:n.issues});else if("invalid_element"===n.code)s({issues:n.issues});else if(0===n.path.length)r._errors.push(t(n));else{let e=r,s=0;for(;s<n.path.length;){let r=n.path[s];s===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],s++}}};return s(e),r})(e,t)},flatten:{value:t=>(function(e,t=e=>e.message){let r={},s=[];for(let n of e.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(t(n))):s.push(t(n));return{formErrors:s,fieldErrors:r}})(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,ta,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,ta,2)}},isEmpty:{get:()=>0===e.issues.length}})},{Parent:Error}),it=re(ie),ir=rr(ie),is=rn(ie),ii=ra(ie),ia=(e,t,r)=>{let s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return re(ie)(e,t,s)},io=(e,t,r)=>re(ie)(e,t,r),il=async(e,t,r)=>{let s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rr(ie)(e,t,s)},ic=async(e,t,r)=>rr(ie)(e,t,r),iu=(e,t,r)=>{let s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return rn(ie)(e,t,s)},id=(e,t,r)=>rn(ie)(e,t,r),ih=async(e,t,r)=>{let s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return ra(ie)(e,t,s)},ip=async(e,t,r)=>ra(ie)(e,t,r),im=e4("ZodType",(e,t)=>(sg.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:n6(e,"input"),output:n6(e,"output")}}),e.toJSONSchema=((e,t={})=>r=>{let s=n2({...r,processors:t});return n3(e,s),n4(s,e),n5(s,e)})(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(n9.mergeDefs(t,{checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),{parent:!0}),e.with=e.check,e.clone=(t,r)=>tT(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>it(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>is(e,t,r),e.parseAsync=async(t,r)=>ir(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>ii(e,t,r),e.spa=e.safeParseAsync,e.encode=(t,r)=>ia(e,t,r),e.decode=(t,r)=>io(e,t,r),e.encodeAsync=async(t,r)=>il(e,t,r),e.decodeAsync=async(t,r)=>ic(e,t,r),e.safeEncode=(t,r)=>iu(e,t,r),e.safeDecode=(t,r)=>id(e,t,r),e.safeEncodeAsync=async(t,r)=>ih(e,t,r),e.safeDecodeAsync=async(t,r)=>ip(e,t,r),e.refine=(t,r)=>e.check(function(e,t={}){return new iM({type:"custom",check:"custom",fn:e,...tR(t)})}(t,r)),e.superRefine=t=>e.check(function(e){var t;let r,s;return t=t=>(t.addIssue=e=>{"string"==typeof e?t.issues.push(tX(e,t.value,r._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=t.value),e.inst??(e.inst=r),e.continue??(e.continue=!r._zod.def.abort),t.issues.push(tX(e)))},e(t.value,t)),(s=new r3({check:"custom",...tR(void 0)}))._zod.check=t,r=s}(t)),e.overwrite=t=>e.check(n1(t)),e.optional=()=>i$(e),e.exactOptional=()=>new iz({type:"optional",innerType:e}),e.nullable=()=>iO(e),e.nullish=()=>i$(iO(e)),e.nonoptional=t=>{var r,s;return r=e,s=t,new iC({type:"nonoptional",innerType:r,...n9.normalizeParams(s)})},e.array=()=>(function(e,t){return new iw({type:"array",element:e,...tR(void 0)})})(e),e.or=t=>new i_({type:"union",options:[e,t],...n9.normalizeParams(void 0)}),e.and=t=>new ik({type:"intersection",left:e,right:t}),e.transform=t=>iI(e,new iS({type:"transform",transform:t})),e.default=t=>{var r,s;return r=e,s=t,new iT({type:"default",innerType:r,get defaultValue(){return"function"==typeof s?s():n9.shallowClone(s)}})},e.prefault=t=>{var r,s;return r=e,s=t,new iR({type:"prefault",innerType:r,get defaultValue(){return"function"==typeof s?s():n9.shallowClone(s)}})},e.catch=t=>{var r;return new iP({type:"catch",innerType:e,catchValue:"function"==typeof(r=t)?r:()=>r})},e.pipe=t=>iI(e,t),e.readonly=()=>new iF({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return nq.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>nq.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return nq.get(e);let r=e.clone();return nq.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=t=>t(e),e)),ig=e4("_ZodString",(e,t)=>{sy.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>((e,t,r,s)=>{r.type="string";let{minimum:n,maximum:i,format:a,patterns:o,contentEncoding:l}=e._zod.bag;if("number"==typeof n&&(r.minLength=n),"number"==typeof i&&(r.maxLength=i),a&&(r.format=n8[a]??a,""===r.format&&delete r.format,"time"===a&&delete r.format),l&&(r.contentEncoding=l),o&&o.size>0){let e=[...o];1===e.length?r.pattern=e[0].source:e.length>1&&(r.allOf=[...e.map(e=>({..."draft-07"===t.target||"draft-04"===t.target||"openapi-3.0"===t.target?{type:"string"}:{},pattern:e.source}))])}})(e,t,r,0);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(function(e,t){return new so({check:"string_format",format:"regex",...tR(t),pattern:e})}(...t)),e.includes=(...t)=>e.check(function(e,t){return new su({check:"string_format",format:"includes",...tR(t),includes:e})}(...t)),e.startsWith=(...t)=>e.check(function(e,t){return new sd({check:"string_format",format:"starts_with",...tR(t),prefix:e})}(...t)),e.endsWith=(...t)=>e.check(function(e,t){return new sh({check:"string_format",format:"ends_with",...tR(t),suffix:e})}(...t)),e.min=(...t)=>e.check(nY(...t)),e.max=(...t)=>e.check(nX(...t)),e.length=(...t)=>e.check(n0(...t)),e.nonempty=(...t)=>e.check(nY(1,...t)),e.lowercase=t=>e.check(new sl({check:"string_format",format:"lowercase",...tR(t)})),e.uppercase=t=>e.check(new sc({check:"string_format",format:"uppercase",...tR(t)})),e.trim=()=>e.check(n1(e=>e.trim())),e.normalize=(...t)=>e.check(function(e){return n1(t=>t.normalize(e))}(...t)),e.toLowerCase=()=>e.check(n1(e=>e.toLowerCase())),e.toUpperCase=()=>e.check(n1(e=>e.toUpperCase())),e.slugify=()=>e.check(n1(e=>tw(e)))}),iy=e4("ZodStringFormat",(e,t)=>{sv.init(e,t),ig.init(e,t)}),iv=((e,t)=>{sw.init(e,t),iy.init(e,t)},e4("ZodNumber",(e,t)=>{sJ.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>((e,t,r,s)=>{let{minimum:n,maximum:i,format:a,multipleOf:o,exclusiveMaximum:l,exclusiveMinimum:c}=e._zod.bag;"string"==typeof a&&a.includes("int")?r.type="integer":r.type="number","number"==typeof c&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.minimum=c,r.exclusiveMinimum=!0):r.exclusiveMinimum=c),"number"==typeof n&&(r.minimum=n,"number"==typeof c&&"draft-04"!==t.target&&(c>=n?delete r.minimum:delete r.exclusiveMinimum)),"number"==typeof l&&("draft-04"===t.target||"openapi-3.0"===t.target?(r.maximum=l,r.exclusiveMaximum=!0):r.exclusiveMaximum=l),"number"==typeof i&&(r.maximum=i,"number"==typeof l&&"draft-04"!==t.target&&(l<=i?delete r.maximum:delete r.exclusiveMaximum)),"number"==typeof o&&(r.multipleOf=o)})(e,t,r,0),e.gt=(t,r)=>e.check(nV(t,r)),e.gte=(t,r)=>e.check(nG(t,r)),e.min=(t,r)=>e.check(nG(t,r)),e.lt=(t,r)=>e.check(nJ(t,r)),e.lte=(t,r)=>e.check(nH(t,r)),e.max=(t,r)=>e.check(nH(t,r)),e.int=t=>e.check(ix(t)),e.safe=t=>e.check(ix(t)),e.positive=t=>e.check(nV(0,t)),e.nonnegative=t=>e.check(nG(0,t)),e.negative=t=>e.check(nJ(0,t)),e.nonpositive=t=>e.check(nH(0,t)),e.multipleOf=(t,r)=>e.check(nK(t,r)),e.step=(t,r)=>e.check(nK(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??-1/0,r.exclusiveMinimum??-1/0)??null,e.maxValue=Math.min(r.maximum??1/0,r.exclusiveMaximum??1/0)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null})),ib=e4("ZodNumberFormat",(e,t)=>{sH.init(e,t),iv.init(e,t)});function ix(e){return new ib({type:"number",check:"number_format",abort:!1,format:"safeint",...tR(e)})}(e,t)=>{sG.init(e,t),im.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,s)=>{if("throw"===t.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema")})(0,e,0,0),e.gte=(t,r)=>e.check(nG(t,r)),e.min=(t,r)=>e.check(nG(t,r)),e.gt=(t,r)=>e.check(nV(t,r)),e.gte=(t,r)=>e.check(nG(t,r)),e.min=(t,r)=>e.check(nG(t,r)),e.lt=(t,r)=>e.check(nJ(t,r)),e.lte=(t,r)=>e.check(nH(t,r)),e.max=(t,r)=>e.check(nH(t,r)),e.positive=t=>e.check(nV(BigInt(0),t)),e.negative=t=>e.check(nJ(BigInt(0),t)),e.nonpositive=t=>e.check(nH(BigInt(0),t)),e.nonnegative=t=>e.check(nG(BigInt(0),t)),e.multipleOf=(t,r)=>e.check(nK(t,r));let r=e._zod.bag;e.minValue=r.minimum??null,e.maxValue=r.maximum??null,e.format=r.format??null};(e,t)=>{s2.init(e,t),im.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{}};(e,t)=>{s3.init(e,t),im.init(e,t),e._zod.processJSONSchema=(e,t,r)=>{t.not={}}};let iw=e4("ZodArray",(e,t)=>{s8.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>((e,t,r,s)=>{let n=e._zod.def,{minimum:i,maximum:a}=e._zod.bag;"number"==typeof i&&(r.minItems=i),"number"==typeof a&&(r.maxItems=a),r.type="array",r.items=n3(n.element,t,{...s,path:[...s.path,"items"]})})(e,t,r,s),e.element=t.element,e.min=(t,r)=>e.check(nY(t,r)),e.nonempty=t=>e.check(nY(1,t)),e.max=(t,r)=>e.check(nX(t,r)),e.length=(t,r)=>e.check(n0(t,r)),e.unwrap=()=>e.element}),i_=e4("ZodUnion",(e,t)=>{nn.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{var n,i,a,o;let l,c,u;return n=e,i=t,a=r,o=s,c=!1===(l=n._zod.def).inclusive,u=l.options.map((e,t)=>n3(e,i,{...o,path:[...o.path,c?"oneOf":"anyOf",t]})),void(c?a.oneOf=u:a.anyOf=u)},e.options=t.options}),ik=e4("ZodIntersection",(e,t)=>{nl.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n,i,a,o;return i=n3((n=e._zod.def).left,t,{...s,path:[...s.path,"allOf",0]}),a=n3(n.right,t,{...s,path:[...s.path,"allOf",1]}),void(r.allOf=[...(o=e=>"allOf"in e&&1===Object.keys(e).length)(i)?i.allOf:[i],...o(a)?a.allOf:[a]])}}),ij=e4("ZodEnum",(e,t)=>{ny.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n;(n=tn(e._zod.def.entries)).every(e=>"number"==typeof e)&&(r.type="number"),n.every(e=>"string"==typeof e)&&(r.type="string"),r.enum=n},e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,s)=>{let n={};for(let s of e)if(r.has(s))n[s]=t.entries[s];else throw Error(`Key ${s} not found in enum`);return new ij({...t,checks:[],...n9.normalizeParams(s),entries:n})},e.exclude=(e,s)=>{let n={...t.entries};for(let t of e)if(r.has(t))delete n[t];else throw Error(`Key ${t} not found in enum`);return new ij({...t,checks:[],...n9.normalizeParams(s),entries:n})}}),iS=e4("ZodTransform",(e,t)=>{nx.init(e,t),im.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,s)=>{if("throw"===t.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema")})(0,e,0,0),e._zod.parse=(r,s)=>{if("backward"===s.direction)throw new e6(e.constructor.name);r.addIssue=s=>{"string"==typeof s?r.issues.push(n9.issue(s,r.value,t)):(s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=e),r.issues.push(n9.issue(s)))};let n=t.transform(r.value,r);return n instanceof Promise?n.then(e=>(r.value=e,r)):(r.value=n,r)}}),iE=e4("ZodOptional",(e,t)=>{n_.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>n7(e,t,r,s),e.unwrap=()=>e._zod.def.innerType});function i$(e){return new iE({type:"optional",innerType:e})}let iz=e4("ZodExactOptional",(e,t)=>{nk.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>n7(e,t,r,s),e.unwrap=()=>e._zod.def.innerType}),iN=e4("ZodNullable",(e,t)=>{nj.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n,i,a;return i=n3((n=e._zod.def).innerType,t,s),a=t.seen.get(e),void("openapi-3.0"===t.target?(a.ref=n.innerType,r.nullable=!0):r.anyOf=[i,{type:"null"}])},e.unwrap=()=>e._zod.def.innerType});function iO(e){return new iN({type:"nullable",innerType:e})}let iT=e4("ZodDefault",(e,t)=>{nS.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n;n3((n=e._zod.def).innerType,t,s),t.seen.get(e).ref=n.innerType,r.default=JSON.parse(JSON.stringify(n.defaultValue))},e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),iR=e4("ZodPrefault",(e,t)=>{n$.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n;n3((n=e._zod.def).innerType,t,s),t.seen.get(e).ref=n.innerType,"input"===t.io&&(r._prefault=JSON.parse(JSON.stringify(n.defaultValue)))},e.unwrap=()=>e._zod.def.innerType}),iC=e4("ZodNonOptional",(e,t)=>{nz.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n;n3((n=e._zod.def).innerType,t,s),t.seen.get(e).ref=n.innerType},e.unwrap=()=>e._zod.def.innerType}),iP=e4("ZodCatch",(e,t)=>{nT.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>((e,t,r,s)=>{let n,i=e._zod.def;n3(i.innerType,t,s),t.seen.get(e).ref=i.innerType;try{n=i.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}r.default=n})(e,t,r,s),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),iA=e4("ZodPipe",(e,t)=>{nC.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n,i;return n=e._zod.def,void(n3(i="input"===t.io?"transform"===n.in._zod.def.type?n.out:n.in:n.out,t,s),t.seen.get(e).ref=i)},e.in=t.in,e.out=t.out});function iI(e,t){return new iA({type:"pipe",in:e,out:t})}let iF=e4("ZodReadonly",(e,t)=>{nM.init(e,t),im.init(e,t),e._zod.processJSONSchema=(t,r,s)=>{let n;n3((n=e._zod.def).innerType,t,s),t.seen.get(e).ref=n.innerType,r.readOnly=!0},e.unwrap=()=>e._zod.def.innerType}),iM=e4("ZodCustom",(e,t)=>{nW.init(e,t),im.init(e,t),e._zod.processJSONSchema=(e,t,r)=>((e,t,r,s)=>{if("throw"===t.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")})(0,e,0,0)});var iD=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};function iL(e,t="/api/auth"){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new iD(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof iD)throw t;throw new iD(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}if(function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new iD(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let iU={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},iB={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},iZ=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,iW={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},iQ=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,iq=[],iJ=0,iH=0,iV=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=iJ+4;t<iq.length;)iq[t]===e?iq.splice(t,4):t+=4;let s=t.indexOf(e);~s&&(t.splice(s,1),--r.lc||r.off())}),notify(e,s){iH++;let n=!iq.length;for(let n of t)iq.push(n,r.value,e,s);if(n){for(iJ=0;iJ<iq.length;iJ+=4)iq[iJ](iq[iJ+1],iq[iJ+2],iq[iJ+3]);iq.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},iG=(e,t)=>{var r,s;return r=r=>{let s=t(r);s&&e.events[6].push(s)},s=t=>{let r=e.listen;e.listen=(...s)=>(e.lc||e.active||(e.active=!0,t()),r(...s));let s=e.off;return e.events[6]=[],e.off=()=>{s(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=s}},e.events=e.events||{},e.events[15]||(e.events[15]=s(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],s=t.indexOf(r);t.splice(s,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},iK=()=>"u"<typeof window,iX=Symbol.for("better-auth:broadcast-channel");var iY=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("u">typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:Math.floor(Date.now()/1e3)}))}catch{}}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function i0(e="better-auth.message"){return globalThis[iX]||(globalThis[iX]=new iY(e)),globalThis[iX]}let i1=Symbol.for("better-auth:focus-manager");var i2=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||"u"<typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function i3(){return globalThis[i1]||(globalThis[i1]=new i2),globalThis[i1]}let i4=Symbol.for("better-auth:online-manager");var i5=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function i6(){return globalThis[i4]||(globalThis[i4]=new i5),globalThis[i4]}let i8=()=>Math.floor(Date.now()/1e3);function i7(e){if(null===e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.iterator in e)&&(!(Symbol.toStringTag in e)||"[object Module]"===Object.prototype.toString.call(e))}function i9(e){return(...t)=>t.reduce((t,r)=>(function e(t,r,s=".",n){if(!i7(r))return e(t,{},s,n);let i=Object.assign({},r);for(let r in t){if("__proto__"===r||"constructor"===r)continue;let a=t[r];null!=a&&(n&&n(i,r,a,s)||(Array.isArray(a)&&Array.isArray(i[r])?i[r]=[...a,...i[r]]:i7(a)&&i7(i[r])?i[r]=e(a,i[r],(s?`${s}.`:"")+r.toString(),n):i[r]=a))}return i})(t,r,"",e),{})}let ae=i9();i9((e,t,r)=>{if(void 0!==e[t]&&"function"==typeof r)return e[t]=r(e[t]),!0}),i9((e,t,r)=>{if(Array.isArray(e[t])&&"function"==typeof r)return e[t]=r(e[t]),!0});var at=Object.defineProperty,ar=Object.defineProperties,as=Object.getOwnPropertyDescriptors,an=Object.getOwnPropertySymbols,ai=Object.prototype.hasOwnProperty,aa=Object.prototype.propertyIsEnumerable,ao=(e,t,r)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,al=(e,t)=>{for(var r in t||(t={}))ai.call(t,r)&&ao(e,r,t[r]);if(an)for(var r of an(t))aa.call(t,r)&&ao(e,r,t[r]);return e},ac=(e,t)=>ar(e,as(t)),au=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},ad=async(e,t)=>{var r,s,n,i,a,o;let l=t||{},c={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:c};for(let u of(null==t?void 0:t.plugins)||[]){if(u.init){let s=await (null==(r=u.init)?void 0:r.call(u,e.toString(),t));l=s.options||l,e=s.url}c.onRequest.push(null==(s=u.hooks)?void 0:s.onRequest),c.onResponse.push(null==(n=u.hooks)?void 0:n.onResponse),c.onSuccess.push(null==(i=u.hooks)?void 0:i.onSuccess),c.onError.push(null==(a=u.hooks)?void 0:a.onError),c.onRetry.push(null==(o=u.hooks)?void 0:o.onRetry)}return{url:e,options:l,hooks:c}},ah=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},ap=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},af=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let s=await r(e.auth.token);if(!s)return t;t.authorization=`Bearer ${s}`}else if("Basic"===e.auth.type){let[s,n]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!s||!n)return t;t.authorization=`Basic ${btoa(`${s}:${n}`)}`}else if("Custom"===e.auth.type){let[s,n]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!n)return t;t.authorization=`${null!=s?s:""} ${n}`}}return t},am=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function ag(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function ay(e){try{return JSON.parse(e)}catch(t){return e}}function av(e){return"function"==typeof e}async function ab(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,s]of Object.entries(await af(e)||{}))t.set(r,s);if(!t.has("content-type")){let r=ag(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var ax=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function aw(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new ax(r.issues);return r.value}var a_=["get","post","put","patch","delete"],ak=async(e,t)=>{var r,s,n,i,a,o,l,c;let u,{hooks:d,url:h,options:p}=await ad(e,t),f=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("u">typeof globalThis&&av(globalThis.fetch))return globalThis.fetch;if("u">typeof window&&av(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(p),m=new AbortController,g=null!=(r=p.signal)?r:m.signal,y=function(e,t){let{baseURL:r,params:s,query:n}=t||{query:{},params:{},baseURL:""},i=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];a_.includes(t)&&(e=e.replace(`@${t}/`,"/"))}i.endsWith("/")||(i+="/");let[a,o]=e.replace(i,"").split("?"),l=new URLSearchParams(o);for(let[e,t]of Object.entries(n||{})){let r;if(null!=t){if("string"==typeof t)r=t;else if(Array.isArray(t)){for(let r of t)l.append(e,r);continue}else r=JSON.stringify(t);l.set(e,r)}}if(s)if(Array.isArray(s))for(let[e,t]of a.split("/").filter(e=>e.startsWith(":")).entries()){let r=s[e];a=a.replace(t,r)}else for(let[e,t]of Object.entries(s))a=a.replace(`:${e}`,String(t));(a=a.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(a=a.slice(1));let c=l.toString();return(c=c.length>0?`?${c}`.replace(/\+/g,"%20"):"",i.startsWith("http"))?new URL(`${a}${c}`,i):`${i}${a}${c}`}(h,p),v=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(ag(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&ag(e.body)?new URLSearchParams(e.body).toString():e.body}(p),b=await ab(p),x=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let s=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return a_.includes(s)?s.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(h,p),w=ac(al({},p),{url:y,headers:b,body:v,method:x,signal:g});for(let e of d.onRequest)if(e){let t=await e(w);"object"==typeof t&&null!==t&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(s=null==t?void 0:t.body)?void 0:s.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:_}=(!(null==p?void 0:p.signal)&&(null==p?void 0:p.timeout)&&(u=setTimeout(()=>null==m?void 0:m.abort(),null==p?void 0:p.timeout)),{abortTimeout:u,clearTimeout:()=>{u&&clearTimeout(u)}}),k=await f(w.url,w);_();let j={response:k,request:w};for(let e of d.onResponse)if(e){let r=await e(ac(al({},j),{response:(null==(n=null==t?void 0:t.hookOptions)?void 0:n.cloneResponse)?k.clone():k}));r instanceof Response?k=r:"object"==typeof r&&null!==r&&(k=r.response)}if(k.ok){if("HEAD"===w.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let s=t.split(";").shift()||"";return am.test(s)?"json":r.has(s)||s.startsWith("text/")?"text":"blob"}(k),r={data:null,response:k,request:w};if("json"===e||"text"===e){let e=await k.text(),t=null!=(i=w.jsonParser)?i:ay;r.data=await t(e)}else r.data=await k[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(r.data=await aw(w.output,r.data)),d.onSuccess))e&&await e(ac(al({},r),{response:(null==(a=null==t?void 0:t.hookOptions)?void 0:a.cloneResponse)?k.clone():k}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let S=null!=(o=null==t?void 0:t.jsonParser)?o:ay,E=await k.text(),$=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(E),z=$?await S(E):null,N={response:k,responseText:E,request:w,error:ac(al({},z),{status:k.status,statusText:k.statusText})};for(let e of d.onError)e&&await e(ac(al({},N),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?k.clone():k}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new ah({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new ah(e);case"exponential":return new ap(e);default:throw Error("Invalid retry strategy")}}(t.retry),s=null!=(c=t.retryAttempt)?c:0;if(await r.shouldAttemptRetry(s,k)){for(let e of d.onRetry)e&&await e(j);let n=r.getDelay(s);return await new Promise(e=>setTimeout(e,n)),await ak(e,ac(al({},t),{retryAttempt:s+1}))}}if(null==t?void 0:t.throw)throw new au(k.status,k.statusText,$?z:E);return{data:null,error:ac(al({},z),{status:k.status,statusText:k.statusText})}};let{signIn:aj,signUp:aS,signOut:aE,useSession:a$,getSession:az}=function(e){var t;let{pluginPathMethods:r,pluginsActions:s,pluginsAtoms:n,$fetch:i,$store:a,atomListeners:o}=((e,t)=>{var r;let s,n,i="credentials"in Request.prototype,a=function(e,t,r,s,n){if(e)return iL(e,t);if(!1!==s){let e=eQ.BETTER_AUTH_URL||eQ.NEXT_PUBLIC_BETTER_AUTH_URL||eQ.PUBLIC_BETTER_AUTH_URL||eQ.NUXT_PUBLIC_BETTER_AUTH_URL||eQ.NUXT_PUBLIC_AUTH_URL||("/"!==eQ.BASE_URL?eQ.BASE_URL:void 0);if(e)return iL(e,t)}r?.headers.get("x-forwarded-host"),r?.headers.get("x-forwarded-proto");if(r){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(r.url);if(!e)throw new iD("Could not get origin from request. Please provide a valid base URL.");return iL(e,t)}if("u">typeof window&&window.location)return iL(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",o=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],l={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:c,onError:u,onRequest:d,onResponse:h,...p}=e?.fetchOptions||{},f=(r={baseURL:a,...i?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:s=!1,reviver:n,parseDates:i=!0}=t;if("string"!=typeof e)return e;let a=e.trim();if(a.length>0&&'"'===a[0]&&a.endsWith('"')&&!a.slice(1,-1).includes('"'))return a.slice(1,-1);let o=a.toLowerCase();if(o.length<=9&&o in iW)return iW[o];if(!iZ.test(a)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(iB).some(([e,t])=>{let r=t.test(a);return r&&s&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(a,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){s&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(i&&"string"==typeof t){let e=function(e){let t=iQ.exec(e);if(!t)return null;let[,r,s,n,i,a,o,l,c,u,d]=t,h=new Date(Date.UTC(parseInt(r,10),parseInt(s,10)-1,parseInt(n,10),parseInt(i,10),parseInt(a,10),parseInt(o,10),l?parseInt(l.padEnd(3,"0"),10):0));if(c){let e=(60*parseInt(u,10)+parseInt(d,10))*("+"===c?-1:1);h.setUTCMinutes(h.getUTCMinutes()+e)}return h instanceof Date&&!isNaN(h.getTime())?h:null}(t);if(e)return e}return n?n(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...p,plugins:[l,...p.plugins||[],...e?.disableDefaultFetchPlugins?[]:[iU],...o]},async function(e,t){let s,n=ac(al(al({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(s=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,n,i,a;let o=(null==(n=null==(r=s.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:n.schema)||s.schema;if(o){let r=e;(null==(i=o.config)?void 0:i.prefix)&&r.startsWith(o.config.prefix)&&(r=r.replace(o.config.prefix,""),o.config.baseURL&&(e=e.replace(o.config.prefix,o.config.baseURL))),(null==(a=o.config)?void 0:a.baseURL)&&r.startsWith(o.config.baseURL)&&(r=r.replace(o.config.baseURL,""));let s=o.schema[r];if(s){let r=ac(al({},t),{method:s.method,output:s.output});return(null==t?void 0:t.disableValidation)||(r=ac(al({},r),{body:s.input?await aw(s.input,null==t?void 0:t.body):null==t?void 0:t.body,params:s.params?await aw(s.params,null==t?void 0:t.params):null==t?void 0:t.params,query:s.query?await aw(s.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}}),...(null==t?void 0:t.plugins)||[]]});if(null==r?void 0:r.catchAllError)try{return await ak(e,n)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await ak(e,n)}),{$sessionSignal:m,session:g}=(n=((e,t,r,s)=>{let n=iV({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>i(e)}),i=async e=>new Promise(i=>{let a="function"==typeof s?s({data:n.get().data,error:n.get().error,isPending:n.get().isPending}):s;r(t,{...a,query:{...a?.query,...e?.query},async onSuccess(e){n.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:n.value.refetch}),await a?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,s=t.retryAttempt||0;r&&s<r||(n.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:n.value.refetch}),await a?.onError?.(e))},async onRequest(e){let t=n.get();n.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:n.value.refetch}),await a?.onRequest?.(e)}}).catch(e=>{n.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:n.value.refetch})}).finally(()=>{i(void 0)})});e=Array.isArray(e)?e:[e];let a=!1;for(let t of e)t.subscribe(async()=>{iK()||(a?await i():iG(n,()=>{let e=setTimeout(async()=>{a||(await i(),a=!0)},0);return()=>{n.off(),t.off(),clearTimeout(e)}}))});return n})(s=iV(!1),"/get-session",f,{method:"GET"}),iG(n,()=>{let t=function(e){let{sessionAtom:t,sessionSignal:r,$fetch:s,options:n={}}=e,i=n.sessionOptions?.refetchInterval??0,a=n.sessionOptions?.refetchOnWindowFocus??!0,o=n.sessionOptions?.refetchWhenOffline??!1,l={lastSync:0,lastSessionRequest:0,cachedSession:void 0},c=e=>{if(!(o||i6().isOnline))return;if(e?.event==="storage"){l.lastSync=i8(),r.set(!r.get());return}let n=t.get();if(e?.event==="poll"){l.lastSessionRequest=i8(),s("/get-session").then(e=>{e.error?t.set({...n,data:null,error:e.error}):t.set({...n,data:e.data,error:null}),l.lastSync=i8(),r.set(!r.get())}).catch(()=>{});return}if(e?.event==="visibilitychange"){if(i8()-l.lastSessionRequest<5)return;l.lastSessionRequest=i8()}(n?.data===null||n?.data===void 0||e?.event==="visibilitychange")&&(l.lastSync=i8(),r.set(!r.get()))};return{init:()=>{i&&i>0&&(l.pollInterval=setInterval(()=>{t.get()?.data&&c({event:"poll"})},1e3*i)),l.unsubscribeBroadcast=i0().subscribe(()=>{c({event:"storage"})}),a&&(l.unsubscribeFocus=i3().subscribe(()=>{c({event:"visibilitychange"})})),l.unsubscribeOnline=i6().subscribe(e=>{e&&c({event:"visibilitychange"})}),i0().setup(),i3().setup(),i6().setup()},cleanup:()=>{l.pollInterval&&(clearInterval(l.pollInterval),l.pollInterval=void 0),l.unsubscribeBroadcast&&(l.unsubscribeBroadcast(),l.unsubscribeBroadcast=void 0),l.unsubscribeFocus&&(l.unsubscribeFocus(),l.unsubscribeFocus=void 0),l.unsubscribeOnline&&(l.unsubscribeOnline(),l.unsubscribeOnline=void 0),l.lastSync=0,l.lastSessionRequest=0,l.cachedSession=void 0},triggerRefetch:c,broadcastSessionUpdate:e=>{i0().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:n,sessionSignal:s,$fetch:f,options:e});return t.init(),()=>{t.cleanup()}}),{session:n,$sessionSignal:s}),y=e?.plugins||[],v={},b={$sessionSignal:m,session:g},x={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},w=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of y)e.getAtoms&&Object.assign(b,e.getAtoms?.(f)),e.pathMethods&&Object.assign(x,e.pathMethods),e.atomListeners&&w.push(...e.atomListeners);let _={notify:e=>{b[e].set(!b[e].get())},listen:(e,t)=>{b[e].subscribe(t)},atoms:b};for(let t of y)t.getActions&&(v=ae(t.getActions?.(f,_,e)??{},v));return{get baseURL(){return a},pluginsActions:v,pluginsAtoms:b,pluginPathMethods:x,atomListeners:w,$fetch:f,$store:_}})(e),l={};for(let[e,t]of Object.entries(n))l[function(e){return`use${e.charAt(0).toUpperCase()+e.slice(1)}`}(e)]=()=>(function(e,t={}){let r=(0,D.useRef)(e.get()),{keys:s,deps:n=[e,s]}=t,i=(0,D.useCallback)(t=>{let n=e=>{r.current!==e&&(r.current=e,t())};if(n(e.value),s?.length){let t;return t=new Set(s).add(void 0),e.listen((e,r,s)=>{t.has(s)&&n(e,r,s)})}return e.listen(n)},n),a=()=>r.current;return(0,D.useSyncExternalStore)(i,a,a)})(t);return t={...s,...l,$fetch:i,$store:a},function e(s=[]){return new Proxy(function(){},{get(r,n){var i;if("string"!=typeof n||"then"===n||"catch"===n||"finally"===n)return;let a=[...s,n],o=t;for(let e of a)if(o&&"object"==typeof o&&e in o)o=o[e];else{o=void 0;break}return"function"==typeof o?o:"object"==typeof(i=o)&&null!==i&&"get"in i&&"function"==typeof i.get&&"lc"in i&&"number"==typeof i.lc?o:e(a)},apply:async(e,t,a)=>{let l="/"+s.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),c=a[0]||{},u=a[1]||{},{query:d,fetchOptions:h,...p}=c,f={...u,...h},m=function(e,t,r){let s=t[e],{fetchOptions:n,query:i,...a}=r||{};return s||(n?.method?n.method:a&&Object.keys(a).length>0?"POST":"GET")}(l,r,c);return await i(l,{...f,body:"GET"===m?void 0:{...p,...f?.body||{}},query:d||f?.query,method:m,async onSuccess(e){if(await f?.onSuccess?.(e),!o||f.disableSignal)return;let t=o.filter(e=>e.matcher(l));if(!t.length)return;let r=new Set;for(let e of t){let t=n[e.signal];if(!t)return;if(r.has(e.signal))continue;r.add(e.signal);let s=t.get();setTimeout(()=>{t.set(!s)},10)}}})}})}()}({baseURL:"https://photovault-mu.vercel.app"});function aN({children:e,onClick:t,variant:r="primary",size:s="md",disabled:n=!1,className:i=""}){let a=(0,D.useMemo)(()=>Array.from({length:8},()=>(Math.random()-.5)*4),[]),{width:o,height:l,fontSize:c,padding:u}={sm:{width:120,height:40,fontSize:"18px",padding:"8px 16px"},md:{width:180,height:50,fontSize:"22px",padding:"10px 24px"},lg:{width:240,height:60,fontSize:"26px",padding:"14px 32px"}}[s],{stroke:d,fill:h,text:p}={primary:{stroke:"#2563EB",fill:"#2563EB",text:"#FFFFFF",hoverStroke:"#1D4ED8"},secondary:{stroke:"#3B82F6",fill:"#EFF6FF",text:"#2563EB",hoverStroke:"#2563EB"},outline:{stroke:"#2563EB",fill:"transparent",text:"#2563EB",hoverStroke:"#1D4ED8"}}[r],f=`
    M ${2+a[0]} ${2+a[1]}
    Q ${o/4+a[2]} ${-1+a[3]}, ${o/2} ${2+a[4]}
    Q ${3*o/4+a[5]} -1, ${o-2+a[6]} 2
    Q ${o+1} ${l/4}, ${o-2} ${l/2}
    Q ${o+1} ${3*l/4}, ${o-2+a[7]} ${l-2}
    Q ${3*o/4} ${l+1}, ${o/2} ${l-2}
    Q ${o/4} ${l+1}, ${2+a[0]} ${l-2}
    Q -1 ${3*l/4}, 2 ${l/2}
    Q -1 ${l/4}, ${2+a[1]} 2
    Z
  `,m=`
    M ${3+a[1]} ${3+a[0]}
    Q ${o/4+a[3]} ${0+a[2]}, ${o/2} 3
    Q ${3*o/4} 0, ${o-3+a[4]} 3
    Q ${o} ${l/4}, ${o-3} ${l/2}
    Q ${o} ${3*l/4}, ${o-3+a[5]} ${l-3}
    Q ${3*o/4} ${l}, ${o/2} ${l-3}
    Q ${o/4} ${l}, ${3+a[6]} ${l-3}
    Q 0 ${3*l/4}, 3 ${l/2}
    Q 0 ${l/4}, ${3+a[7]} 3
    Z
  `;return(0,M.jsxs)("button",{onClick:t,disabled:n,className:`
        relative inline-block
        transition-transform duration-150
        ${n?"opacity-50 cursor-not-allowed":"cursor-pointer hover:scale-[1.02] active:scale-[0.98]"}
        ${i}
      `,style:{width:o,height:l},children:[(0,M.jsxs)("svg",{width:o,height:l,viewBox:`0 0 ${o} ${l}`,className:"absolute inset-0",children:[(0,M.jsx)("path",{d:f,fill:h,stroke:"none"}),(0,M.jsx)("path",{d:f,fill:"none",stroke:d,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#rough-edge)"}}),(0,M.jsx)("path",{d:m,fill:"none",stroke:d,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.6"})]}),(0,M.jsx)("span",{className:"relative z-10 font-['Google Sans',_sans-serif] font-bold",style:{fontSize:c,color:p,display:"flex",alignItems:"center",justifyContent:"center",height:"100%",padding:u},children:e})]})}function aO({children:e,className:t="",onClick:r,variant:s="default"}){let n=(0,D.useMemo)(()=>Array.from({length:12},()=>(Math.random()-.5)*6),[]),i={default:{fill:"#FFFFFF",stroke:"#2563EB",strokeWidth:3},elevated:{fill:"#FFFFFF",stroke:"#2563EB",strokeWidth:4},outline:{fill:"transparent",stroke:"#3B82F6",strokeWidth:2}}[s];return(0,M.jsxs)("div",{onClick:r,className:`
        relative
        ${r?"cursor-pointer hover:scale-[1.01] active:scale-[0.99]":""}
        transition-transform duration-150
        ${t}
      `,children:[(0,M.jsxs)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",preserveAspectRatio:"none",children:[(0,M.jsx)("defs",{children:(0,M.jsxs)("filter",{id:"card-rough",x:"-5%",y:"-5%",width:"110%",height:"110%",children:[(0,M.jsx)("feTurbulence",{type:"turbulence",baseFrequency:"0.04",numOctaves:"2",result:"noise"}),(0,M.jsx)("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1"})]})}),(0,M.jsx)("path",{d:`
            M ${5+n[0]}% ${3+n[1]}%
            Q 25% ${-.5+n[2]}%, 50% ${2+n[3]}%
            Q 75% -0.5%, ${95+n[4]}% 3%
            Q 100.5% 25%, 97% 50%
            Q 100.5% 75%, ${95+n[5]}% 97%
            Q 75% 100.5%, 50% ${97+n[6]}%
            Q 25% 100.5%, ${5+n[7]}% 97%
            Q -0.5% 75%, 3% 50%
            Q -0.5% 25%, ${5+n[8]}% 3%
            Z
          `,fill:i.fill,stroke:i.stroke,strokeWidth:i.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:"url(#card-rough)"}}),(0,M.jsx)("path",{d:`
            M ${6+n[9]}% ${4+n[10]}%
            Q 25% 0.5%, 50% 3%
            Q 75% 0.5%, ${94+n[11]}% 4%
            Q 99.5% 25%, 96% 50%
            Q 99.5% 75%, 94% 96%
            Q 75% 99.5%, 50% 96%
            Q 25% 99.5%, 6% 96%
            Q 0.5% 75%, 4% 50%
            Q 0.5% 25%, 6% 4%
            Z
          `,fill:"none",stroke:i.stroke,strokeWidth:"1",strokeLinecap:"round",opacity:"0.4"}),"elevated"===s&&(0,M.jsx)("path",{d:`
              M 7% 6%
              Q 25% 2%, 50% 5%
              Q 75% 2%, 93% 6%
              Q 98% 25%, 95% 50%
              Q 98% 75%, 93% 95%
              Q 75% 98%, 50% 95%
              Q 25% 98%, 7% 95%
              Q 2% 75%, 5% 50%
              Q 2% 25%, 7% 6%
              Z
            `,fill:"none",stroke:"#1E40AF",strokeWidth:"2",opacity:"0.2",transform:"translate(3, 3)"})]}),(0,M.jsx)("div",{className:"relative z-10 p-6",children:e})]})}function aT({checked:e,onChange:t,label:r,disabled:s=!1}){let n=(0,D.useMemo)(()=>Array.from({length:8},()=>(Math.random()-.5)*3),[]),i=`
    M ${16+n[0]} ${2+n[1]}
    Q 30 0, ${44+n[2]} 2
    Q 58 6, ${58+n[3]} 16
    Q 58 26, 44 ${30+n[4]}
    Q 30 32, ${16+n[5]} 30
    Q 2 26, ${2+n[6]} 16
    Q 2 6, ${16+n[7]} 2
    Z
  `,a=e=>{let t="";for(let r=0;r<=16;r++){let s=r/16*Math.PI*2,n=.96*Math.sin(3*r),i=e+(12+n)*Math.cos(s),a=16+(12+n)*Math.sin(s);t+=(0===r?"M ":"L ")+`${i} ${a} `}return t+"Z"},o=e?44:16;return(0,M.jsxs)("label",{className:`
        inline-flex items-center gap-3
        ${s?"opacity-50 cursor-not-allowed":"cursor-pointer"}
      `,children:[(0,M.jsx)("button",{type:"button",onClick:()=>!s&&t(!e),disabled:s,className:"relative focus:outline-none focus:ring-2 focus:ring-blue-300 rounded-full",style:{width:60,height:32},children:(0,M.jsxs)("svg",{width:60,height:32,viewBox:"0 0 60 32",children:[(0,M.jsx)("defs",{children:(0,M.jsxs)("filter",{id:"toggle-rough",x:"-5%",y:"-5%",width:"110%",height:"110%",children:[(0,M.jsx)("feTurbulence",{type:"turbulence",baseFrequency:"0.05",numOctaves:"2",result:"noise"}),(0,M.jsx)("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1"})]})}),(0,M.jsx)("path",{d:i,fill:e?"#2563EB":"#E5E7EB",stroke:e?"#1D4ED8":"#9CA3AF",strokeWidth:"2.5",strokeLinecap:"round",style:{filter:"url(#toggle-rough)"}}),(0,M.jsx)("path",{d:i,fill:"none",stroke:e?"#1E40AF":"#6B7280",strokeWidth:"1",opacity:"0.3",transform:"translate(1, 1)"}),(0,M.jsxs)("g",{style:{transition:"transform 0.2s ease-out"},children:[(0,M.jsx)("path",{d:a(o),fill:"#1E40AF",opacity:"0.15",transform:"translate(2, 2)"}),(0,M.jsx)("path",{d:a(o),fill:"#FFFFFF",stroke:"#2563EB",strokeWidth:"2.5",strokeLinecap:"round"}),(0,M.jsx)("path",{d:a(o),fill:"none",stroke:"#3B82F6",strokeWidth:"1",opacity:"0.4",transform:"scale(0.85)",style:{transformOrigin:`${o}px 16px`}})]})]})}),r&&(0,M.jsx)("span",{className:"font-['Google Sans',_sans-serif] text-xl text-[#1E40AF]",children:r})]})}function aR({icon:e,size:t=48,color:r="#2563EB",className:s=""}){let n=(0,D.useMemo)(()=>Array.from({length:20},()=>(Math.random()-.5)*2),[]),i=t>40?3:2;return(0,M.jsxs)("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,className:s,children:[(0,M.jsx)("defs",{children:(0,M.jsxs)("filter",{id:`icon-rough-${e}`,x:"-5%",y:"-5%",width:"110%",height:"110%",children:[(0,M.jsx)("feTurbulence",{type:"turbulence",baseFrequency:"0.03",numOctaves:"2",result:"noise"}),(0,M.jsx)("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"0.5"})]})}),(0,M.jsx)("g",{style:{filter:`url(#icon-rough-${e})`},children:(()=>{switch(e){case"shield":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:`
                M ${t/2+n[0]} ${4+n[1]}
                Q ${t-6+n[2]} 6, ${t-6} ${t/3}
                Q ${t-6} ${.6*t}, ${t/2} ${t-4+n[3]}
                Q 6 ${.6*t}, ${6+n[4]} ${t/3}
                Q 6 6, ${t/2+n[5]} 4
                Z
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"}),(0,M.jsx)("path",{d:`
                M ${.3*t+n[6]} ${.5*t}
                L ${.45*t} ${.65*t+n[7]}
                L ${.7*t+n[8]} ${.35*t}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"})]});case"photo":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:`
                M ${6+n[0]} ${8+n[1]}
                L ${t-6+n[2]} 8
                L ${t-6} ${t-8+n[3]}
                L ${6+n[4]} ${t-8}
                Z
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"}),(0,M.jsx)("path",{d:`
                M ${10+n[5]} ${t-14}
                L ${.35*t} ${.45*t+n[6]}
                L ${.5*t} ${.55*t}
                L ${.65*t+n[7]} ${.4*t}
                L ${t-10} ${t-14+n[8]}
              `,fill:"none",stroke:r,strokeWidth:i-.5,strokeLinecap:"round",strokeLinejoin:"round"}),(0,M.jsx)("circle",{cx:.7*t,cy:.3*t,r:.08*t,fill:"none",stroke:r,strokeWidth:i-.5})]});case"clock":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:(()=>{let e="",r=t/2,s=t/2,i=t/2-6;for(let t=0;t<=24;t++){let a=t/24*Math.PI*2-Math.PI/2,o=.04*i*(n[t%10]||0),l=r+(i+o)*Math.cos(a),c=s+(i+o)*Math.sin(a);e+=(0===t?"M ":"L ")+`${l} ${c} `}return e+"Z"})(),fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"}),(0,M.jsx)("path",{d:`
                M ${t/2+n[0]} ${t/2}
                L ${t/2-.15*t+n[1]} ${t/2-.15*t}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"}),(0,M.jsx)("path",{d:`
                M ${t/2} ${t/2+n[2]}
                L ${t/2+.2*t} ${t/2-.25*t+n[3]}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"}),(0,M.jsx)("circle",{cx:t/2,cy:t/2,r:3,fill:r})]});case"key":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:(()=>{let e="",r=.3*t,s=.35*t,i=.2*t;for(let t=0;t<=16;t++){let a=t/16*Math.PI*2,o=.06*i*(n[t%10]||0),l=r+(i+o)*Math.cos(a),c=s+(i+o)*Math.sin(a);e+=(0===t?"M ":"L ")+`${l} ${c} `}return e+"Z"})(),fill:"none",stroke:r,strokeWidth:i}),(0,M.jsx)("circle",{cx:.3*t,cy:.35*t,r:.08*t,fill:"none",stroke:r,strokeWidth:i-.5}),(0,M.jsx)("path",{d:`
                M ${.45*t+n[0]} ${.45*t}
                L ${t-8+n[1]} ${t-10}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"}),(0,M.jsx)("path",{d:`
                M ${.65*t+n[2]} ${.6*t}
                L ${.72*t} ${.68*t+n[3]}
                M ${.75*t} ${.7*t+n[4]}
                L ${.82*t+n[5]} ${.78*t}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"})]});case"cloud":return(0,M.jsx)("path",{d:`
              M ${.25*t+n[0]} ${.65*t}
              Q ${.1*t} ${.65*t}, ${.1*t+n[1]} ${.5*t}
              Q ${.1*t} ${.35*t}, ${.25*t} ${.35*t+n[2]}
              Q ${.3*t} ${.2*t}, ${.45*t+n[3]} ${.2*t}
              Q ${.55*t} ${.15*t+n[4]}, ${.65*t} ${.25*t}
              Q ${.8*t} ${.2*t}, ${.85*t+n[5]} ${.35*t}
              Q ${.95*t} ${.4*t+n[6]}, ${.9*t} ${.55*t}
              Q ${.95*t} ${.65*t}, ${.8*t+n[7]} ${.65*t}
              Z
            `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"});case"folder":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:`
                M ${8+n[0]} ${.35*t}
                L 8 ${.25*t+n[1]}
                L ${.35*t+n[2]} ${.25*t}
                L ${.4*t} ${.35*t+n[3]}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"}),(0,M.jsx)("path",{d:`
                M ${8+n[4]} ${.35*t}
                L ${t-8+n[5]} ${.35*t}
                L ${t-8} ${t-10+n[6]}
                L ${8+n[7]} ${t-10}
                Z
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"})]});case"check":return(0,M.jsx)("path",{d:`
              M ${.2*t+n[0]} ${.5*t}
              L ${.4*t+n[1]} ${.7*t+n[2]}
              L ${.8*t+n[3]} ${.3*t}
            `,fill:"none",stroke:r,strokeWidth:i+1,strokeLinecap:"round",strokeLinejoin:"round"});case"warning":return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:`
                M ${t/2+n[0]} 8
                L ${t-8+n[1]} ${t-10}
                L ${8+n[2]} ${t-10}
                Z
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"}),(0,M.jsx)("path",{d:`
                M ${t/2+n[3]} ${.35*t}
                L ${t/2} ${.55*t+n[4]}
              `,fill:"none",stroke:r,strokeWidth:i,strokeLinecap:"round"}),(0,M.jsx)("circle",{cx:t/2,cy:.7*t,r:2.5,fill:r})]});default:return null}})()})]})}function aC({value:e,onChange:t,placeholder:r="",type:s="text",label:n,icon:i,disabled:a=!1,className:o=""}){return(0,D.useMemo)(()=>Array.from({length:8},()=>(Math.random()-.5)*4),[]),(0,M.jsxs)("div",{className:`relative ${o}`,children:[n&&(0,M.jsx)("label",{className:"block font-['Google Sans',_sans-serif] text-xl text-[#1E40AF] mb-2",children:n}),(0,M.jsxs)("div",{className:"relative",children:[(0,M.jsxs)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",preserveAspectRatio:"none",children:[(0,M.jsx)("defs",{children:(0,M.jsxs)("filter",{id:"input-rough",x:"-5%",y:"-5%",width:"110%",height:"110%",children:[(0,M.jsx)("feTurbulence",{type:"turbulence",baseFrequency:"0.04",numOctaves:"2",result:"noise"}),(0,M.jsx)("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1",xChannelSelector:"R",yChannelSelector:"G"})]})}),(0,M.jsx)("path",{d:"M0,0 L${width},0 L${width},${height} L0,${height} Z",className:"stroke-[#2563EB] stroke-[3] fill-none",filter:"url(#input-rough)"})]}),(0,M.jsx)("input",{type:s,value:e,onChange:e=>t(e.target.value),placeholder:r,disabled:a,className:`
             relative z-10
             w-full
             ${i?"pl-12":"px-5"} py-4
             bg-transparent
             font-['Google Sans',_sans-serif] text-xl text-[#1E40AF]
             placeholder:text-[#9CA3AF]
             focus:outline-none
             ${a?"opacity-50 cursor-not-allowed":""}
           `}),i&&(0,M.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-20 text-[#2563EB]/40",children:i})]})]})}function aP({value:e,onChange:t,placeholder:r="",label:s,rows:n=4,disabled:i=!1,className:a=""}){return(0,D.useMemo)(()=>Array.from({length:8},()=>(Math.random()-.5)*4),[]),(0,M.jsxs)("div",{className:`relative ${a}`,children:[s&&(0,M.jsx)("label",{className:"block font-['Google Sans',_sans-serif] text-xl text-[#1E40AF] mb-2",children:s}),(0,M.jsxs)("div",{className:"relative",children:[(0,M.jsxs)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",preserveAspectRatio:"none",children:[(0,M.jsx)("defs",{children:(0,M.jsxs)("filter",{id:"textarea-rough",x:"-5%",y:"-5%",width:"110%",height:"110%",children:[(0,M.jsx)("feTurbulence",{type:"turbulence",baseFrequency:"0.03",numOctaves:"2",result:"noise"}),(0,M.jsx)("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1",xChannelSelector:"R",yChannelSelector:"G"})]})}),(0,M.jsx)("path",{d:"M0,0 L${width},0 L${width},${height} L0,${height} Z",className:"stroke-[#2563EB] stroke-[3] fill-none",filter:"url(#textarea-rough)"})]}),(0,M.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:r,rows:n,disabled:i,className:`
             relative z-10
             w-full
             px-5 py-4
             bg-transparent
             font-['Google Sans',_sans-serif] text-xl text-[#1E40AF]
             placeholder:text-[#9CA3AF]
             focus:outline-none
             resize-none
             ${i?"opacity-50 cursor-not-allowed":""}
           `})]})]})}function aA({onSuccess:e}){let[t,r]=(0,D.useState)("welcome"),[s,n]=(0,D.useState)(""),[i,a]=(0,D.useState)(""),[o,l]=(0,D.useState)(""),[c,u]=(0,D.useState)(!1),[d,h]=(0,D.useState)(!1),[p,f]=(0,D.useState)(null),m=async()=>{if(!s||!i)return void f("Bitte E-Mail und Passwort eingeben");h(!0),f(null);try{let t=await aj.email({email:s,password:i});if(t.error)return void f(t.error.message||"Anmeldung fehlgeschlagen");t.data?.user&&e({id:t.data.user.id,email:t.data.user.email,vaultKeyHash:t.data.user.vault_key_hash||null})}catch(e){console.error("Login error:",e),f("Ein Fehler ist aufgetreten. Bitte versuche es erneut.")}finally{h(!1)}},g=async()=>{if(!s||!i||!o)return void f("Bitte alle Felder ausfuellen");if(i.length<8)return void f("Passwort muss mindestens 8 Zeichen haben");h(!0),f(null);try{let t=await aS.email({email:s,password:i,name:o});if(t.error)return void f(t.error.message||"Registrierung fehlgeschlagen");t.data?.user&&e({id:t.data.user.id,email:t.data.user.email,vaultKeyHash:null})}catch(e){console.error("Signup error:",e),f("Ein Fehler ist aufgetreten. Bitte versuche es erneut.")}finally{h(!1)}};return"welcome"===t?(0,M.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-16 pb-8 safe-area-inset bg-[#FAFBFC]",children:[(0,M.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:[(0,M.jsxs)("div",{className:"relative w-28 h-28 mb-8",children:[(0,M.jsx)("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 100 100",children:(0,M.jsx)("path",{d:"M 10 10 Q 30 5, 50 10 Q 70 5, 90 10 Q 95 30, 90 50 Q 95 70, 90 90 Q 70 95, 50 90 Q 30 95, 10 90 Q 5 70, 10 50 Q 5 30, 10 10 Z",fill:"white",stroke:"#2563EB",strokeWidth:"3"})}),(0,M.jsx)("div",{className:"relative z-10 w-full h-full flex items-center justify-center",children:(0,M.jsx)(eU,{name:"shield",size:56,className:"text-[#2563EB]"})})]}),(0,M.jsx)("h1",{className:"sketch-heading text-[42px] mb-3",children:"PhotoVault"}),(0,M.jsx)("p",{className:"sketch-body text-[#3B82F6] max-w-[280px] mb-12",children:"Sichere deine Fotos mit Zero-Knowledge Verschluesselung"}),(0,M.jsxs)("div",{className:"w-full max-w-[320px] space-y-4 mb-12",children:[(0,M.jsx)(aI,{icon:"lock",text:"Ende-zu-Ende verschluesselt"}),(0,M.jsx)(aI,{icon:"smartphone",text:"Multi-Device Sync"}),(0,M.jsx)(aI,{icon:"cloud",text:"Dezentrales IPFS Backup"})]})]}),(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)(aN,{onClick:()=>r("signup"),className:"w-full",size:"lg",children:"Konto erstellen"}),(0,M.jsx)("button",{onClick:()=>r("login"),className:"w-full py-2 sketch-body text-[#2563EB] hover:text-[#1E40AF] transition-colors",children:"Ich habe bereits ein Konto"})]})]}):(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#FAFBFC]",children:[(0,M.jsx)("button",{onClick:()=>r("welcome"),className:"jsx-d70472d407c31818 self-start sketch-body text-[#2563EB] mb-8 ios-tap-target flex items-center gap-2",children:"â† Zurueck"}),(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 flex-1",children:[(0,M.jsx)("h1",{className:"jsx-d70472d407c31818 sketch-heading text-[32px] mb-2",children:"login"===t?"Willkommen zurueck":"Konto erstellen"}),(0,M.jsx)("p",{className:"jsx-d70472d407c31818 sketch-body text-[#3B82F6] mb-8",children:"login"===t?"Melde dich an, um auf deinen Vault zuzugreifen":"Erstelle ein Konto, um deinen Vault zu sichern"}),(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 space-y-6",children:["signup"===t&&(0,M.jsx)("div",{className:"jsx-d70472d407c31818 relative",children:(0,M.jsx)(aC,{type:"text",value:o,onChange:e=>l(e),placeholder:"Name",label:"Name",icon:(0,M.jsx)(K,{className:"w-5 h-5"})})}),(0,M.jsx)("div",{className:"jsx-d70472d407c31818 relative",children:(0,M.jsx)(aC,{type:"email",value:s,onChange:e=>n(e),placeholder:"E-Mail",label:"E-Mail",icon:(0,M.jsx)(J,{className:"w-5 h-5"})})}),(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 relative flex flex-col gap-1",children:[(0,M.jsx)(aC,{type:c?"text":"password",value:i,onChange:e=>a(e),placeholder:"Passwort",label:"Passwort",icon:(0,M.jsx)(H,{className:"w-5 h-5"})}),(0,M.jsx)("button",{type:"button",onClick:()=>u(!c),className:"jsx-d70472d407c31818 absolute right-4 top-[38px] text-[#2563EB]/40 z-20",children:c?(0,M.jsx)(G,{className:"w-5 h-5"}):(0,M.jsx)(V,{className:"w-5 h-5"})})]}),p&&(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 relative py-3 px-4",children:[(0,M.jsx)("svg",{preserveAspectRatio:"none",className:"jsx-d70472d407c31818 absolute inset-0 w-full h-full",children:(0,M.jsx)("path",{d:"M 2 5 Q 25 2, 50 5 Q 75 2, 98 5 Q 99 30, 98 60 Q 75 63, 50 60 Q 25 63, 2 60 Q 1 30, 2 5 Z",fill:"#FF3B3010",stroke:"#FF3B30",strokeWidth:"1",className:"jsx-d70472d407c31818"})}),(0,M.jsx)("p",{className:"jsx-d70472d407c31818 relative z-10 sketch-body text-[#FF3B30] text-center text-sm",children:p})]})]})]}),(0,M.jsxs)("div",{className:"jsx-d70472d407c31818 space-y-4",children:[(0,M.jsx)(aN,{onClick:"login"===t?m:g,disabled:d,className:"w-full",size:"lg",children:d?(0,M.jsx)(X,{className:"w-6 h-6 animate-spin"}):"login"===t?"Anmelden":"Registrieren"}),(0,M.jsx)("button",{onClick:()=>r("login"===t?"signup":"login"),className:"jsx-d70472d407c31818 w-full py-2 sketch-body text-[#2563EB] hover:text-[#1E40AF] transition-colors",children:"login"===t?"Noch kein Konto? Registrieren":"Bereits ein Konto? Anmelden"})]}),(0,M.jsx)(q.default,{id:"d70472d407c31818",children:".sketch-input-field.jsx-d70472d407c31818{color:#1d1d1f;background-color:#0000;border:2px solid #2563eb;border-radius:12px;width:100%;height:54px;padding-left:3rem;padding-right:1rem;font-family:Google Sans,sans-serif;font-size:17px;transition:border-color .2s}.sketch-input-field.jsx-d70472d407c31818:focus{border-color:#1e40af;outline:none}.sketch-input-field.jsx-d70472d407c31818::placeholder{color:#8e8e93}"})]})}function aI({icon:e,text:t}){return(0,M.jsxs)("div",{className:"relative group",children:[(0,M.jsx)("svg",{className:"absolute inset-0 w-full h-full",preserveAspectRatio:"none",children:(0,M.jsx)("path",{d:"M 2 2 Q 25 -1, 50 2 Q 75 -1, 98 2 Q 100 25, 98 50 Q 75 53, 50 50 Q 25 53, 2 50 Q 0 25, 2 2 Z",fill:"white",stroke:"#2563EB40",strokeWidth:"1.5"})}),(0,M.jsxs)("div",{className:"relative z-10 flex items-center gap-4 p-4",children:[(0,M.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",children:(0,M.jsx)(eU,{name:e,size:24,className:"text-[#2563EB]"})}),(0,M.jsx)("span",{className:"sketch-body text-base text-[#1E40AF]",children:t})]})]})}let aF=Z("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var aM=e.i(3809);function aD({userEmail:e,expectedKeyHash:t,onUnlock:r,onCreateNewVault:s,onLogout:n}){let[i,a]=(0,D.useState)(""),[o,l]=(0,D.useState)(!1),[c,u]=(0,D.useState)(null),d=async()=>{if(!i.trim())return void u("Bitte gib deine Recovery-Phrase ein");l(!0),u(null);try{let e=i.trim().replace(/[\s\n]+/g,"-").replace(/-+/g,"-"),s=(0,aM.recoveryPhraseToKey)(e);if(!s||32!==s.length){u("Ungueltige Recovery-Phrase"),l(!1);return}let n=await (0,aM.getUserKeyHash)(s);if(t&&n!==t){u("Diese Recovery-Phrase gehoert nicht zu diesem Konto. Bitte ueberpruefe deine Eingabe."),l(!1);return}(0,aM.saveKeyToStorage)(s),r(s,n)}catch(e){console.error("Unlock error:",e),u("Ungueltige Recovery-Phrase. Bitte ueberpruefe deine Eingabe.")}finally{l(!1)}};return(0,M.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#FAFBFC]",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,M.jsxs)("div",{className:"sketch-body text-[14px] text-[#6E6E73]",children:["Angemeldet als",(0,M.jsx)("br",{}),(0,M.jsx)("span",{className:"text-[#2563EB] font-bold",children:e})]}),(0,M.jsx)("button",{onClick:n,className:"sketch-body text-[#FF3B30] text-[15px] hover:text-[#D73A49]",children:"Abmelden"})]}),(0,M.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,M.jsxs)("div",{className:"flex flex-col items-center text-center mb-8",children:[(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aR,{icon:"shield",size:80})}),(0,M.jsx)("h1",{className:"sketch-heading text-[32px] mb-2 text-[#1D1D1F]",children:"Vault entsperren"}),(0,M.jsx)("p",{className:"sketch-body text-[15px] text-[#6E6E73] max-w-[300px]",children:t?"Gib deine Recovery-Phrase ein, um auf deine verschluesselten Fotos zuzugreifen":"Du hast noch keinen Vault. Erstelle einen neuen oder stelle einen bestehenden wieder her."})]}),(0,M.jsxs)("div",{className:"mb-6",children:[(0,M.jsx)(aP,{value:i,onChange:e=>{a(e),u(null)},label:"Recovery-Phrase (12 Woerter)",placeholder:"abc123XY-def456AB-...",rows:4}),(0,M.jsx)("p",{className:"sketch-body text-[12px] text-[#8E8E93] mt-2 px-1",children:"Mit Bindestrichen oder Leerzeichen getrennt"})]}),c&&(0,M.jsx)("div",{className:"relative py-3 px-4 mb-6",children:(0,M.jsx)(aO,{className:"bg-[#FF3B30]/5 border-[#FF3B30]",children:(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#FF3B30] text-center",children:c})})}),(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aO,{className:"bg-[#2563EB]/5",children:(0,M.jsxs)("div",{className:"flex items-start gap-3",children:[(0,M.jsx)(aF,{className:"w-5 h-5 text-[#2563EB] mt-0.5 flex-shrink-0"}),(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"sketch-subheading text-[15px] mb-1",children:"Warum brauche ich die Phrase?"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"Deine Fotos sind lokal verschluesselt. Nur mit der Recovery-Phrase kannst du sie entschluesseln. Wir speichern sie niemals."})]})]})})})]}),(0,M.jsxs)("div",{className:"space-y-4",children:[(0,M.jsx)(aN,{onClick:d,disabled:o||!i.trim(),className:"w-full",size:"lg",children:o?(0,M.jsx)(X,{className:"w-6 h-6 animate-spin"}):"Vault entsperren"}),!t&&(0,M.jsx)("button",{onClick:s,className:"w-full py-2 sketch-body text-[#2563EB] text-[17px] hover:underline",children:"Neuen Vault erstellen"})]})]})}function aL(){let[e,t]=(0,D.useState)(null),[r,s]=(0,D.useState)(!1),[n,i]=(0,D.useState)(null),[a,o]=(0,D.useState)(!1),[l,c]=(0,D.useState)(null);(0,D.useEffect)(()=>{(async()=>{let e=(0,aM.loadKeyFromStorage)();e&&(t(e),i((0,aM.keyToRecoveryPhrase)(e)),c(await (0,aM.getUserKeyHash)(e))),s(!0)})()},[]);let u=(0,D.useCallback)(()=>new Promise(e=>{o(!0),setTimeout(async()=>{let r=(0,aM.generateKeyPair)().secretKey;t(r),(0,aM.saveKeyToStorage)(r);let s=(0,aM.keyToRecoveryPhrase)(r);i(s),c(await (0,aM.getUserKeyHash)(r)),o(!1),e(s)},1500)}),[]);return{secretKey:e,isInitialized:r,hasKey:!!e,recoveryPhrase:n,userKeyHash:l,isGeneratingKey:a,generateNewKey:u,restoreFromPhrase:(0,D.useCallback)(e=>{try{let r=(0,aM.recoveryPhraseToKey)(e);return t(r),(0,aM.saveKeyToStorage)(r),i(e),!0}catch{return!1}},[]),clearKey:(0,D.useCallback)(()=>{t(null),i(null),(0,aM.clearKeyFromStorage)()},[])}}function aU({userId:e,onComplete:t,onBack:r}){let[s,n]=(0,D.useState)("intro"),[i,a]=(0,D.useState)(!1),[o,l]=(0,D.useState)(!1),{isGeneratingKey:c,generateNewKey:u,recoveryPhrase:d,userKeyHash:h}=aL(),p=async()=>{n("generating");try{await u(),n("phrase")}catch(e){console.error("Failed to generate key:",e),n("intro")}},f=async()=>{d&&(await navigator.clipboard.writeText(d),l(!0),setTimeout(()=>l(!1),2e3))},m=d?.split("-").slice(0,12)||[];return"generating"===s||c?(0,M.jsx)(Q,{}):"intro"===s?(0,M.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#FAFBFC]",children:[(0,M.jsx)("button",{onClick:r,className:"self-start sketch-body text-[#2563EB] text-[17px] mb-8 hover:text-[#1E40AF]",children:"â† Zurueck"}),(0,M.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-center",children:[(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aR,{icon:"key",size:80})}),(0,M.jsx)("h1",{className:"sketch-heading text-[32px] mb-3 text-[#1D1D1F]",children:"Erstelle deinen Vault"}),(0,M.jsx)("p",{className:"sketch-body text-[17px] text-[#3B82F6] max-w-[300px] mb-8",children:"Dein persoenlicher Verschluesselungsschluessel schuetzt alle deine Fotos"}),(0,M.jsxs)("div",{className:"w-full max-w-[320px] space-y-4 mb-8",children:[(0,M.jsx)(aO,{className:"p-4",children:(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)(aR,{icon:"shield",size:32,color:"#30D158"}),(0,M.jsxs)("div",{className:"text-left",children:[(0,M.jsx)("p",{className:"sketch-subheading text-[16px]",children:"Zero-Knowledge"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"Nur du kannst deine Fotos entschluesseln"})]})]})}),(0,M.jsx)(aO,{className:"p-4",children:(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)(aR,{icon:"clock",size:32,color:"#2563EB"}),(0,M.jsxs)("div",{className:"text-left",children:[(0,M.jsx)("p",{className:"sketch-subheading text-[16px]",children:"Recovery-Phrase"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"12 Woerter zum Wiederherstellen"})]})]})}),(0,M.jsx)(aO,{className:"p-4",children:(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)(aR,{icon:"photo",size:32,color:"#FF9500"}),(0,M.jsxs)("div",{className:"text-left",children:[(0,M.jsx)("p",{className:"sketch-subheading text-[16px]",children:"Multi-Device"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"Synchronisiere all deine Geraete"})]})]})})]})]}),(0,M.jsx)(aN,{onClick:p,className:"w-full",size:"lg",children:"Vault erstellen"})]}):"phrase"===s?(0,M.jsxs)("div",{className:"min-h-screen flex flex-col px-6 pt-12 pb-8 safe-area-inset bg-[#FAFBFC]",children:[(0,M.jsxs)("div",{className:"flex-1",children:[(0,M.jsxs)("div",{className:"text-center mb-6",children:[(0,M.jsx)("h1",{className:"sketch-heading text-[32px] mb-2 text-[#1D1D1F]",children:"Deine Phrase"}),(0,M.jsx)("p",{className:"sketch-body text-[15px] text-[#6E6E73]",children:"Notiere diese Woerter sicher. Du brauchst sie zur Wiederherstellung."})]}),(0,M.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:m.map((e,t)=>(0,M.jsxs)(aO,{className:"p-3 text-center",children:[(0,M.jsx)("span",{className:"sketch-body text-[11px] text-[#6E6E73] block mb-0.5",children:t+1}),(0,M.jsx)("span",{className:"sketch-subheading text-[16px] break-all",children:e})]},t))}),(0,M.jsx)("button",{onClick:f,className:"w-full py-3 sketch-body text-[#2563EB] text-[16px] hover:underline mb-4",children:o?"âœ“ Kopiert!":"Phrase kopieren"}),(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aO,{className:"bg-[#FF3B30]/5 border-[#FF3B30]",children:(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#FF3B30] text-center",children:"Teile diese Woerter niemals mit anderen. Wer sie hat, kann auf deine Fotos zugreifen."})})}),(0,M.jsx)("div",{className:"mb-8",children:(0,M.jsxs)(aO,{className:"p-4 flex items-center justify-between",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px] text-[#1D1D1F]",children:"Sicher gespeichert?"}),(0,M.jsx)(aT,{checked:i,onChange:a})]})})]}),(0,M.jsx)(aN,{onClick:()=>{h&&t(h)},disabled:!i,className:"w-full",size:"lg",children:"Weiter"})]}):null}let aB=Z("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);class aZ extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class aW extends aZ{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class aQ extends aZ{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class aq extends aZ{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}(d=E||(E={})).Any="any",d.ApNortheast1="ap-northeast-1",d.ApNortheast2="ap-northeast-2",d.ApSouth1="ap-south-1",d.ApSoutheast1="ap-southeast-1",d.ApSoutheast2="ap-southeast-2",d.CaCentral1="ca-central-1",d.EuCentral1="eu-central-1",d.EuWest1="eu-west-1",d.EuWest2="eu-west-2",d.EuWest3="eu-west-3",d.SaEast1="sa-east-1",d.UsEast1="us-east-1",d.UsWest1="us-west-1",d.UsWest2="us-west-2";class aJ{constructor(t,{headers:r={},customFetch:s,region:n=E.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=(t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,s,n,i,a;return s=this,n=void 0,i=void 0,a=function*(){try{let s,{headers:n,method:i,body:a}=t,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("u">typeof Blob&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",s=a):"string"==typeof a?(o["Content-Type"]="text/plain",s=a):"u">typeof FormData&&a instanceof FormData?s=a:(o["Content-Type"]="application/json",s=JSON.stringify(a)));let c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:s}).catch(e=>{throw new aW(e)}),u=c.headers.get("x-relay-error");if(u&&"true"===u)throw new aQ(c);if(!c.ok)throw new aq(c);let d=(null!=(r=c.headers.get("Content-Type"))?r:"text/plain").split(";")[0].trim();return{data:"application/json"===d?yield c.json():"application/octet-stream"===d?yield c.blob():"text/event-stream"===d?c:"multipart/form-data"===d?yield c.formData():yield c.text(),error:null}}catch(e){return{data:null,error:e}}},new(i||(i=Promise))(function(e,t){function r(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var s;t.done?e(t.value):((s=t.value)instanceof i?s:new i(function(e){e(s)})).then(r,o)}l((a=a.apply(s,n||[])).next())})}}let{PostgrestClient:aH,PostgrestQueryBuilder:aV,PostgrestFilterBuilder:aG,PostgrestTransformBuilder:aK,PostgrestBuilder:aX,PostgrestError:aY}=e.i(82215).default,a0={"X-Client-Info":"realtime-js/2.11.2"};(h=$||($={}))[h.connecting=0]="connecting",h[h.open=1]="open",h[h.closing=2]="closing",h[h.closed=3]="closed",(p=z||(z={})).closed="closed",p.errored="errored",p.joined="joined",p.joining="joining",p.leaving="leaving",(f=N||(N={})).close="phx_close",f.error="phx_error",f.join="phx_join",f.reply="phx_reply",f.leave="phx_leave",f.access_token="access_token",(O||(O={})).websocket="websocket",(m=T||(T={})).Connecting="connecting",m.Open="open",m.Closing="closing",m.Closed="closed";class a1{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let s=t.getUint8(1),n=t.getUint8(2),i=this.HEADER_LENGTH+2,a=r.decode(e.slice(i,i+s));i+=s;let o=r.decode(e.slice(i,i+n));return i+=n,{ref:null,topic:a,event:o,payload:JSON.parse(r.decode(e.slice(i,e.byteLength)))}}}class a2{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(g=R||(R={})).abstime="abstime",g.bool="bool",g.date="date",g.daterange="daterange",g.float4="float4",g.float8="float8",g.int2="int2",g.int4="int4",g.int4range="int4range",g.int8="int8",g.int8range="int8range",g.json="json",g.jsonb="jsonb",g.money="money",g.numeric="numeric",g.oid="oid",g.reltime="reltime",g.text="text",g.time="time",g.timestamp="timestamp",g.timestamptz="timestamptz",g.timetz="timetz",g.tsrange="tsrange",g.tstzrange="tstzrange";let a3=(e,t,r={})=>{var s;let n=null!=(s=r.skipTypes)?s:[];return Object.keys(t).reduce((r,s)=>(r[s]=a4(s,e,t,n),r),{})},a4=(e,t,r,s)=>{let n=t.find(t=>t.name===e),i=null==n?void 0:n.type,a=r[e];return i&&!s.includes(i)?a5(i,a):a6(a)},a5=(e,t)=>{if("_"===e.charAt(0))return oe(t,e.slice(1,e.length));switch(e){case R.bool:return a8(t);case R.float4:case R.float8:case R.int2:case R.int4:case R.int8:case R.numeric:case R.oid:return a7(t);case R.json:case R.jsonb:return a9(t);case R.timestamp:return ot(t);case R.abstime:case R.date:case R.daterange:case R.int4range:case R.int8range:case R.money:case R.reltime:case R.text:case R.time:case R.timestamptz:case R.timetz:case R.tsrange:case R.tstzrange:default:return a6(t)}},a6=e=>e,a8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},a7=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},a9=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},oe=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s,n=e.slice(1,r);try{s=JSON.parse("["+n+"]")}catch(e){s=n?n.split(","):[]}return s.map(e=>a5(t,e))}return e},ot=e=>"string"==typeof e?e.replace(" ","T"):e,or=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class os{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(y=C||(C={})).SYNC="sync",y.JOIN="join",y.LEAVE="leave";class on{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=on.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=on.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=on.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){let n=this.cloneDeep(e),i=this.transformState(t),a={},o={};return this.map(n,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{let r=n[e];if(r){let s=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),i=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>s.indexOf(e.presence_ref));i.length>0&&(a[e]=i),l.length>0&&(o[e]=l)}else a[e]=t}),this.syncDiff(n,{joins:a,leaves:o},r,s)}static syncDiff(e,t,r,s){let{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(n,(t,s)=>{var n;let i=null!=(n=e[t])?n:[];if(e[t]=this.cloneDeep(s),i.length>0){let r=e[t].map(e=>e.presence_ref),s=i.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...s)}r(t,i,s)}),this.map(i,(t,r)=>{let n=e[t];if(!n)return;let i=r.map(e=>e.presence_ref);n=n.filter(e=>0>i.indexOf(e.presence_ref)),e[t]=n,s(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let s=e[r];return"metas"in s?t[r]=s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(v=P||(P={})).ALL="*",v.INSERT="INSERT",v.UPDATE="UPDATE",v.DELETE="DELETE",(b=A||(A={})).BROADCAST="broadcast",b.PRESENCE="presence",b.POSTGRES_CHANGES="postgres_changes",b.SYSTEM="system",(x=I||(I={})).SUBSCRIBED="SUBSCRIBED",x.TIMED_OUT="TIMED_OUT",x.CLOSED="CLOSED",x.CHANNEL_ERROR="CHANNEL_ERROR";class oi{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new os(this,N.join,this.params,this.timeout),this.rejoinTimer=new a2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=z.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(N.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new on(this),this.broadcastEndpointURL=or(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:i,private:a}}=this.params;this._onError(t=>null==e?void 0:e(I.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(I.CLOSED));let o={},l={broadcast:n,presence:i,postgres_changes:null!=(s=null==(r=this.bindings.postgres_changes)?void 0:r.map(e=>e.filter))?s:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0===t){null==e||e(I.SUBSCRIBED);return}{let s=this.bindings.postgres_changes,n=null!=(r=null==s?void 0:s.length)?r:0,i=[];for(let r=0;r<n;r++){let n=s[r],{filter:{event:a,schema:o,table:l,filter:c}}=n,u=t&&t[r];if(u&&u.event===a&&u.schema===o&&u.table===l&&u.filter===c)i.push(Object.assign(Object.assign({},n),{id:u.id}));else{this.unsubscribe(),null==e||e(I.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=i,e&&e(I.SUBSCRIBED);return}}).receive("error",t=>{null==e||e(I.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(I.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,n,i;let a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(i=null==(n=null==(s=this.params)?void 0:s.config)?void 0:n.broadcast)?void 0:i.ack)||r("ok"),a.receive("ok",()=>r("ok")),a.receive("error",()=>r("error")),a.receive("timeout",()=>r("timed out"))});{let{event:n,payload:i}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!=(r=t.timeout)?r:this.timeout);return await (null==(s=e.body)?void 0:s.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=z.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(N.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let s=new os(this,N.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){let s=new AbortController,n=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(n),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new os(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,n;let i=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=N;if(r&&[a,o,l,c].indexOf(i)>=0&&r!==this._joinRef())return;let u=this._onMessage(i,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null==(s=this.bindings.postgres_changes)||s.filter(e=>{var t,r,s;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(s=null==(r=e.filter)?void 0:r.event)?void 0:s.toLocaleLowerCase())===i}).map(e=>e.callback(u,r)):null==(n=this.bindings[i])||n.filter(e=>{var r,s,n,a,o,l;if(!["broadcast","presence","postgres_changes"].includes(i))return e.type.toLocaleLowerCase()===i;if("id"in e){let i=e.id,a=null==(r=e.filter)?void 0:r.event;return i&&(null==(s=t.ids)?void 0:s.includes(i))&&("*"===a||(null==a?void 0:a.toLocaleLowerCase())===(null==(n=t.data)?void 0:n.type.toLocaleLowerCase()))}{let r=null==(o=null==(a=null==e?void 0:e.filter)?void 0:a.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof u&&"ids"in u){let e=u.data,{schema:t,table:r,commit_timestamp:s,type:n,errors:i}=e;u=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:s,eventType:n,new:{},old:{},errors:i}),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===z.closed}_isJoined(){return this.state===z.joined}_isJoining(){return this.state===z.joining}_isLeaving(){return this.state===z.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let s=e.toLocaleLowerCase(),n={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(n):this.bindings[s]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null==(s=e.type)?void 0:s.toLocaleLowerCase())===r&&oi.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(N.close,{},e)}_onError(e){this._on(N.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=z.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=a3(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=a3(e.columns,e.old_record)),t}}let oa=()=>{},oo="u">typeof WebSocket,ol=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class oc{constructor(t,r){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=a0,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=oa,this.conn=null,this.sendBuffer=[],this.serializer=new a1,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},this.endPoint=`${t}/${O.websocket}`,this.httpEndpoint=or(t),(null==r?void 0:r.transport)?this.transport=r.transport:this.transport=null,(null==r?void 0:r.params)&&(this.params=r.params),(null==r?void 0:r.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),(null==r?void 0:r.timeout)&&(this.timeout=r.timeout),(null==r?void 0:r.logger)&&(this.logger=r.logger),(null==r?void 0:r.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const n=null==(s=null==r?void 0:r.params)?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=(null==r?void 0:r.reconnectAfterMs)?r.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==r?void 0:r.encode)?r.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==r?void 0:r.decode)?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new a2(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==r?void 0:r.fetch),null==r?void 0:r.worker){if("u">typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==r?void 0:r.worker)||!1,this.workerUrl=null==r?void 0:r.workerUrl}this.accessToken=(null==r?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(oo){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new ou(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),e.A(56555).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case $.connecting:return T.Connecting;case $.open:return T.Open;case $.closing:return T.Closing;default:return T.Closed}}isConnected(){return this.connectionState()===T.Open}channel(e,t={config:{}}){let r=new oi(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:s,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${r} (${n})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(e){}if(e&&e.exp&&!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`);this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(N.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null==(e=this.conn)||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:s,ref:n}=e;n&&n===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${n&&"("+n+")"||""}`,s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,n)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(N.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([ol],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ou{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=$.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}var od=e.i(67034);class oh extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function op(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class of extends oh{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class om extends oh{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let og=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},oy=e=>{if(Array.isArray(e))return e.map(e=>oy(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=oy(r)}),t};var ov=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let ob=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e);function ox(t,r,s,n,i,a){return ov(this,void 0,void 0,function*(){return new Promise((o,l)=>{let c;t(s,(c={method:r,headers:(null==n?void 0:n.headers)||{}},"GET"===r?c:(c.headers=Object.assign({"Content-Type":"application/json"},null==n?void 0:n.headers),a&&(c.body=JSON.stringify(a)),Object.assign(Object.assign({},c),i)))).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(t=>ov(void 0,void 0,void 0,function*(){var r,s,i,a;let o=yield(r=void 0,s=void 0,i=void 0,a=function*(){return"u"<typeof Response?(yield e.A(11737)).Response:Response},new(i||(i=Promise))(function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(n,o)}l((a=a.apply(r,s||[])).next())}));t instanceof o&&!(null==n?void 0:n.noResolveJson)?t.json().then(e=>{l(new of(ob(e),t.status||500))}).catch(e=>{l(new om(ob(e),e))}):l(new om(ob(t),t))}))})})}function ow(e,t,r,s){return ov(this,void 0,void 0,function*(){return ox(e,"GET",t,r,s)})}function o_(e,t,r,s,n){return ov(this,void 0,void 0,function*(){return ox(e,"POST",t,s,n,r)})}function ok(e,t,r,s,n){return ov(this,void 0,void 0,function*(){return ox(e,"DELETE",t,s,n,r)})}var oj=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};let oS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},oE={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class o${constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=og(s)}uploadOrUpdate(e,t,r,s){return oj(this,void 0,void 0,function*(){try{let n,i=Object.assign(Object.assign({},oE),s),a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)}),o=i.metadata;"u">typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",r)):"u">typeof FormData&&r instanceof FormData?((n=r).append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o))):(n=r,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==s?void 0:s.headers)&&(a=Object.assign(Object.assign({},a),s.headers));let l=this._removeEmptyFolders(t),c=this._getFinalPath(l),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:n,headers:a},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),d=yield u.json();if(u.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(e){if(op(e))return{data:null,error:e};throw e}})}upload(e,t,r){return oj(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return oj(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),i=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let e,t=Object.assign({upsert:oE.upsert},s),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"u">typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"u">typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);let o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:i}),l=yield o.json();if(o.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(op(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return oj(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(s["x-upsert"]="true");let n=yield o_(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+n.url),a=i.searchParams.get("token");if(!a)throw new oh("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}update(e,t,r){return oj(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return oj(this,void 0,void 0,function*(){try{return{data:yield o_(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}copy(e,t,r){return oj(this,void 0,void 0,function*(){try{return{data:{path:(yield o_(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return oj(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),n=yield o_(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return oj(this,void 0,void 0,function*(){try{let s=yield o_(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:s.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}download(e,t){return oj(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=s?`?${s}`:"";try{let t=this._getFinalPath(e),s=yield ow(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield s.blob(),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}info(e){return oj(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield ow(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:oy(e),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}exists(e){return oj(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,s){return ov(this,void 0,void 0,function*(){return ox(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(op(e)&&e instanceof om){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),s=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&s.push(n);let i=void 0!==(null==t?void 0:t.transform),a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==a&&s.push(a);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return oj(this,void 0,void 0,function*(){try{return{data:yield ok(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}list(e,t,r){return oj(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},oS),t),{prefix:e||""});return{data:yield o_(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==od.Buffer?od.Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let oz={"X-Client-Info":"storage-js/2.7.1"};var oN=function(e,t,r,s){return new(r||(r=Promise))(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})};class oO{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},oz),t),this.fetch=og(r)}listBuckets(){return oN(this,void 0,void 0,function*(){try{return{data:yield ow(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}getBucket(e){return oN(this,void 0,void 0,function*(){try{return{data:yield ow(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return oN(this,void 0,void 0,function*(){try{return{data:yield o_(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return oN(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,s,n){return ov(this,void 0,void 0,function*(){return ox(e,"PUT",t,s,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}emptyBucket(e){return oN(this,void 0,void 0,function*(){try{return{data:yield o_(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}deleteBucket(e){return oN(this,void 0,void 0,function*(){try{return{data:yield ok(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(op(e))return{data:null,error:e};throw e}})}}class oT extends oO{constructor(e,t={},r){super(e,t,r)}from(e){return new o$(this.url,this.headers,e,this.fetch)}}let oR="";oR="u">typeof Deno?"deno":"u">typeof document?"web":"u">typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let oC={headers:{"X-Client-Info":`supabase-js-${oR}/2.48.1`}},oP={schema:"public"},oA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oI={};var oF=e.i(6085);let oM="2.67.3",oD={"X-Client-Info":`gotrue-js/${oM}`},oL="X-Supabase-Api-Version",oU={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},oB=()=>"u">typeof window&&"u">typeof document,oZ={tested:!1,writable:!1},oW=()=>{if(!oB())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(oZ.tested)return oZ.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),oZ.tested=!0,oZ.writable=!0}catch(e){oZ.tested=!0,oZ.writable=!1}return oZ.writable},oQ=t=>{let r;return r=t||("u"<typeof fetch?(...t)=>e.A(11737).then(({default:e})=>e(...t)):fetch),(...e)=>r(...e)},oq=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},oJ=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},oH=async(e,t)=>{await e.removeItem(t)};class oV{constructor(){this.promise=new oV.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function oG(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function(e){let t,r,s,n,i,a,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",u=0;for(e=e.replace("-","+").replace("_","/");u<e.length;)n=l.indexOf(e.charAt(u++)),i=l.indexOf(e.charAt(u++)),a=l.indexOf(e.charAt(u++)),o=l.indexOf(e.charAt(u++)),t=n<<2|i>>4,r=(15&i)<<4|a>>2,s=(3&a)<<6|o,c+=String.fromCharCode(t),64!=a&&0!=r&&(c+=String.fromCharCode(r)),64!=o&&0!=s&&(c+=String.fromCharCode(s));return c}(t[1]))}async function oK(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function oX(e){return("0"+e.toString(16)).substr(-2)}async function oY(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function o0(e){return"u">typeof crypto&&void 0!==crypto.subtle&&"u">typeof TextEncoder?btoa(await oY(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function o1(e,t,r=!1){let s=function(){let e=new Uint32Array(56);if("u"<typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,oX).join("")}(),n=s;r&&(n+="/PASSWORD_RECOVERY"),await oq(e,`${t}-code-verifier`,n);let i=await o0(s),a=s===i?"plain":"s256";return[i,a]}oV.promiseConstructor=Promise;let o2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class o3 extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function o4(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class o5 extends o3{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class o6 extends o3{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class o8 extends o3{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class o7 extends o8{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class o9 extends o8{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class le extends o8{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class lt extends o8{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lr extends o8{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ls extends o8{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ln(e){return o4(e)&&"AuthRetryableFetchError"===e.name}class li extends o8{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var la=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r};let lo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ll=[502,503,504];async function lc(e){var t;let r,s;if(!("object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json))throw new ls(lo(e),0);if(ll.includes(e.status))throw new ls(lo(e),e.status);try{r=await e.json()}catch(e){throw new o6(lo(e),e)}let n=function(e){let t=e.headers.get(oL);if(!t||!t.match(o2))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(n&&n.getTime()>=oU["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?s=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new li(lo(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===s)throw new o7}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new li(lo(r),e.status,r.weak_password.reasons);throw new o5(lo(r),e.status||500,s)}async function lu(e,t,r,s){var n;let i=Object.assign({},null==s?void 0:s.headers);i[oL]||(i[oL]=oU["2024-01-01"].name),(null==s?void 0:s.jwt)&&(i.Authorization=`Bearer ${s.jwt}`);let a=null!=(n=null==s?void 0:s.query)?n:{};(null==s?void 0:s.redirectTo)&&(a.redirect_to=s.redirectTo);let o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await ld(e,t,r+o,{headers:i,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function ld(e,t,r,s,n,i){let a,o,l=(o={method:t,headers:(null==s?void 0:s.headers)||{}},"GET"===t?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==s?void 0:s.headers),o.body=JSON.stringify(i),Object.assign(Object.assign({},o),n)));try{a=await e(r,Object.assign({},l))}catch(e){throw console.error(e),new ls(lo(e),0)}if(a.ok||await lc(a),null==s?void 0:s.noResolveJson)return a;try{return await a.json()}catch(e){await lc(e)}}function lh(e){var t,r,s;let n=null;(s=e).access_token&&s.refresh_token&&s.expires_in&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!=(t=e.user)?t:e},error:null}}function lp(e){let t=lh(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function lf(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function lm(e){return{data:e,error:null}}function lg(e){let{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},user:Object.assign({},la(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function ly(e){return e}var lv=function(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)0>t.indexOf(s[n])&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r};class lb{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=oQ(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await lu(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(o4(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await lu(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:lf})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=lv(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await lu(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:lg,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(o4(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await lu(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:lf})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,s,n,i,a,o;try{let l={nextPage:null,lastPage:0,total:0},c=await lu(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(n=null==(s=null==e?void 0:e.perPage)?void 0:s.toString())?n:""},xform:ly});if(c.error)throw c.error;let u=await c.json(),d=null!=(i=c.headers.get("x-total-count"))?i:0,h=null!=(o=null==(a=c.headers.get("link"))?void 0:a.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(e){if(o4(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await lu(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:lf})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await lu(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:lf})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await lu(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:lf})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await lu(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(o4(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await lu(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(o4(e))return{data:null,error:e};throw e}}}let lx={getItem:e=>oW()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{oW()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{oW()&&globalThis.localStorage.removeItem(e)}};function lw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let l_={debug:!!(globalThis&&oW()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class lk extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class lj extends lk{}async function lS(e,t,r){l_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),l_.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(s){l_.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{l_.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}if(0===t)throw l_.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(l_.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}))}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"u">typeof self&&(self.globalThis=self)}let lE={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function l$(e,t,r){return await r()}class lz{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lz.nextInstanceID,lz.nextInstanceID+=1,this.instanceID>0&&oB()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},lE),e);if(this.logDebugMessages=!!s.debug,"function"==typeof s.debug&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new lb({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=oQ(s.fetch),this.lock=s.lock||l$,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:oB()&&(null==(t=null==globalThis?void 0:globalThis.navigator)?void 0:t.locks)?this.lock=lS:this.lock=l$,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:oW()?this.storage=lx:(this.memoryStorage={},this.storage=lw(this.memoryStorage)):(this.memoryStorage={},this.storage=lw(this.memoryStorage)),oB()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(r=this.broadcastChannel)||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${oM}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),oB()&&this.detectSessionInUrl&&"none"!==r){let{data:s,error:n}=await this._getSessionFromURL(t,r);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),o4(n)&&"AuthImplicitGrantRedirectError"===n.name){let t=null==(e=n.details)?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}let{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(o4(e))return{error:e};return{error:new o6("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{let{data:n,error:i}=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(s=null==e?void 0:e.options)?void 0:s.captchaToken}},xform:lh});if(i||!n)return{data:{user:null,session:null},error:i};let a=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:o,session:a},error:null}}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,s;try{let n;if("email"in e){let{email:r,password:s,options:i}=e,a=null,o=null;"pkce"===this.flowType&&([a,o]=await o1(this.storage,this.storageKey)),n=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:s,data:null!=(t=null==i?void 0:i.data)?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:o},xform:lh})}else if("phone"in e){let{phone:t,password:i,options:a}=e;n=await lu(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!=(r=null==a?void 0:a.data)?r:{},channel:null!=(s=null==a?void 0:a.channel)?s:"sms",gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:lh})}else throw new le("You must provide either an email or phone number and a password");let{data:i,error:a}=n;if(a||!i)return{data:{user:null,session:null},error:a};let o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:s,options:n}=e;t=await lu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:lp})}else if("phone"in e){let{phone:r,password:s,options:n}=e;t=await lu(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:lp})}else throw new le("You must provide either an email or phone number and a password");let{data:r,error:s}=t;if(s)return{data:{user:null,session:null},error:s};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new o9};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s}}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,s,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(s=e.options)?void 0:s.queryParams,skipBrowserRedirect:null==(n=e.options)?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await oJ(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{let{data:t,error:n}=await lu(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:lh});if(await oH(this.storage,`${this.storageKey}-code-verifier`),n)throw n;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new o9};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:n}}catch(e){if(o4(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:s,access_token:n,nonce:i}=e,{data:a,error:o}=await lu(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:lh});if(o)return{data:{user:null,session:null},error:o};if(!a||!a.session||!a.user)return{data:{user:null,session:null},error:new o9};return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:o}}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,s,n,i;try{if("email"in e){let{email:s,options:n}=e,i=null,a=null;"pkce"===this.flowType&&([i,a]=await o1(this.storage,this.storageKey));let{error:o}=await lu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!=(t=null==n?void 0:n.data)?t:{},create_user:null==(r=null==n?void 0:n.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:a},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:a,error:o}=await lu(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(s=null==r?void 0:r.data)?s:{},create_user:null==(n=null==r?void 0:r.shouldCreateUser)||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(i=null==r?void 0:r.channel)?i:"sms"}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:o}}throw new le("You must provide either an email or phone number.")}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let s,n;"options"in e&&(s=null==(t=e.options)?void 0:t.redirectTo,n=null==(r=e.options)?void 0:r.captchaToken);let{data:i,error:a}=await lu(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:s,xform:lh});if(a)throw a;if(!i)throw Error("An error occurred on token verification.");let o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,s;try{let n=null,i=null;return"pkce"===this.flowType&&([n,i]=await o1(this.storage,this.storageKey)),await lu(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(s=null==e?void 0:e.options)?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:i}),headers:this.headers,xform:lm})}catch(e){if(o4(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new o7;let{error:s}=await lu(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:s,options:n}=e,{error:i}=await lu(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){let{phone:r,type:s,options:n}=e,{data:i,error:a}=await lu(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:a}}throw new le("You must provide either an email or phone number and a type")}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await oJ(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,s)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,s))})}return{data:{session:e},error:null}}let{session:s,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{session:null},error:n};return{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await lu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:lf});return await this._useSession(async e=>{var t,r,s;let{data:n,error:i}=e;if(i)throw i;return(null==(t=n.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await lu(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(s=null==(r=n.session)?void 0:r.access_token)?s:void 0,xform:lf}):{data:{user:null},error:new o7}})}catch(e){if(o4(e))return o4(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await oH(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:s,error:n}=r;if(n)throw n;if(!s.session)throw new o7;let i=s.session,a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await o1(this.storage,this.storageKey));let{data:l,error:c}=await lu(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:i.access_token,xform:lf});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(e){if(o4(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return oG(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new o7;let t=Date.now()/1e3,r=t,s=!0,n=null,i=oG(e.access_token);if(i.exp&&(s=(r=i.exp)<=t),s){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:s,error:i}=await this._getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(e){if(o4(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:s,error:n}=t;if(n)throw n;e=null!=(r=s.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new o7;let{session:s,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(o4(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!oB())throw new lt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new lt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new lr("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new lt("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new lr("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:s,access_token:n,refresh_token:i,expires_in:a,expires_at:o,token_type:l}=e;if(!n||!a||!i||!l)throw new lt("No session defined in URL");let c=Math.round(Date.now()/1e3),u=parseInt(a),d=c+u;o&&(d=parseInt(o));let h=d-c;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${u}s`);let p=d-u;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,c);let{data:f,error:m}=await this._getUser(n);if(m)throw m;let g={provider_token:r,provider_refresh_token:s,access_token:n,expires_in:u,expires_at:d,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(e){if(o4(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await oJ(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:s,error:n}=t;if(n)return{error:n};let i=null==(r=s.session)?void 0:r.access_token;if(i){let{error:t}=await this.admin.signOut(i,e);if(t&&!(o4(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await oH(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{let{data:{session:s},error:n}=t;if(n)throw n;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(t){await (null==(s=this.stateChangeEmitters.get(e))?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await o1(this.storage,this.storageKey,!0));try{return await lu(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(o4(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!=(e=t.user.identities)?e:[]},error:null}}catch(e){if(o4(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:s}=await this._useSession(async t=>{var r,s,n,i,a;let{data:o,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(s=e.options)?void 0:s.scopes,queryParams:null==(n=e.options)?void 0:n.queryParams,skipBrowserRedirect:!0});return await lu(this.fetch,"GET",c,{headers:this.headers,jwt:null!=(a=null==(i=o.session)?void 0:i.access_token)?a:void 0})});if(s)throw s;return!oB()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(o4(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;let{data:n,error:i}=t;if(i)throw i;return await lu(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(s=null==(r=n.session)?void 0:r.access_token)?s:void 0})})}catch(e){if(o4(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,s;let n=Date.now();return await (r=async r=>(r>0&&await oK(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await lu(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:lh})),s=(e,t)=>{let r=200*Math.pow(2,e);return t&&ln(t)&&Date.now()+r-n<3e4},new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!s(n,null,t))return void e(t)}catch(e){if(!s(n,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),o4(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),oB()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await oJ(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let s=Math.round(Date.now()/1e3),n=(null!=(e=r.expires_at)?e:1/0)<s+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),ln(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new o7;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new oV;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new o7;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let s={session:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(e){if(this._debug(s,"error",e),o4(e)){let r={session:null,error:e};return ln(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let s=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){s.push(e)}});if(await Promise.all(n),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await oq(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await oH(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&oB()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"u">typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let s=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof lk)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!oB()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"!==document.visibilityState?this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting"):await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await o1(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:s,error:n}=t;return n?{data:null,error:n}:await lu(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token})})}catch(e){if(o4(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;let{data:n,error:i}=t;if(i)return{data:null,error:i};let a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await lu(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null==(r=null==n?void 0:n.session)?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null==(s=null==o?void 0:o.totp)?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(o4(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:n}=t;if(n)return{data:null,error:n};let{data:i,error:a}=await lu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(e){if(o4(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:n}=t;return n?{data:null,error:n}:await lu(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token})})}catch(e){if(o4(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],s=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),n=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:s,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:s},error:n}=e;if(n)return{data:null,error:n};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let i=this._decodeJWT(s.access_token),a=null;i.aal&&(a=i.aal);let o=a;return(null!=(r=null==(t=s.user.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(o="aal2"),{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))}}lz.nextInstanceID=0;let lN=lz;class lO extends lN{constructor(e){super(e)}}let lT=new class e{constructor(e,t,r){var s,n,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){let{db:r,auth:s,realtime:n,global:i}=e,{db:a,auth:o,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i),accessToken:()=>{var e,t,r,s;return e=this,t=void 0,s=function*(){return""},new(r=void 0,r=Promise)(function(n,i){function a(e){try{l(s.next(e))}catch(e){i(e)}}function o(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((s=s.apply(e,t||[])).next())})}};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=r?r:{},{db:oP,realtime:oI,auth:Object.assign(Object.assign({},oA),{storageKey:o}),global:oC});this.storageKey=null!=(s=l.auth.storageKey)?s:"",this.headers=null!=(n=l.global.headers)?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(i=l.auth)?i:{},this.headers,l.global.fetch),this.fetch=((e,t,r)=>{let s,n=(s=r||("u"<typeof fetch?oF.default:fetch),(...e)=>s(...e)),i="u"<typeof Headers?oF.Headers:Headers;return(r,s)=>{var a,o,l,c;return a=void 0,o=void 0,l=void 0,c=function*(){var a;let o=null!=(a=yield t())?a:e,l=new i(null==s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,Object.assign(Object.assign({},s),{headers:l}))},new(l||(l=Promise))(function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function s(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof l?n:new l(function(e){e(n)})).then(r,s)}n((c=c.apply(a,o||[])).next())})}})(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new aH(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new aJ(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new oT(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,s,n,i;return r=this,s=void 0,n=void 0,i=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!=(t=null==(e=r.session)?void 0:e.access_token)?t:null},new(n||(n=Promise))(function(e,t){function a(e){try{l(i.next(e))}catch(e){t(e)}}function o(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(a,o)}l((i=i.apply(r,s||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:n,flowType:i,lock:a,debug:o},l,c){let u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lO({url:this.authUrl,headers:Object.assign(Object.assign({},u),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:i,lock:a,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new oc(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?this.changedAccessToken=r:"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}("https://jextayidnmtsoofugnig.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpleHRheWlkbm10c29vZnVnbmlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkwODM1MDAsImV4cCI6MjA4NDY1OTUwMH0.vxRq32MPWyO_znst5nFCiQ7AWJtlJeOFWMY-RlZmjrs",void 0);async function lR(e,t,r,s,n,i){console.log("[Supabase] Uploading metadata:",{cid:e,deviceId:r,mimeType:n,fileSize:t,hasUserKeyHash:!!i});try{let a=await fetch("/api/supabase/proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"uploadMetadata",cid:e,fileSize:t,deviceId:r,nonce:s,mimeType:n,userKeyHash:i})}),o=await a.json();if(o.success)return console.log("[Supabase] Metadata uploaded via proxy:",o.data?.[0]?.id),o.data;console.warn("[Supabase] Proxy failed, trying direct client:",o.error)}catch(e){console.warn("[Supabase] Proxy error, trying direct client:",e)}let{data:a,error:o}=await lT.from("photos_metadata").insert([{cid:e,file_size_bytes:t,device_id:r,nonce:s,mime_type:n,user_key_hash:i}]).select();if(o)throw console.error("[Supabase] Metadata Upload Error:",{code:o.code,message:o.message,details:o.details,hint:o.hint}),o;return console.log("[Supabase] Metadata uploaded successfully:",a?.[0]?.id),a}async function lC(e,t){if(!t)return console.error("loadCIDsFromSupabase: userKeyHash is required"),[];try{let e=await fetch("/api/supabase/proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"loadCIDs",userKeyHash:t})}),r=await e.json();if(r.success)return console.log("[Supabase] CIDs loaded via proxy:",r.data?.length),r.data||[];console.warn("[Supabase] Proxy failed, trying direct client:",r.error)}catch(e){console.warn("[Supabase] Proxy error, trying direct client:",e)}let{data:r,error:s}=await lT.from("photos_metadata").select("cid, device_id, uploaded_at, file_size_bytes, nonce, mime_type").eq("user_key_hash",t).order("uploaded_at",{ascending:!1});if(s)throw console.error("Supabase Load Error:",s),s;return r||[]}async function lP(e,t){if(!t)return!1;let{data:r,error:s}=await lT.from("photos_metadata").select("id").eq("cid",e).eq("user_key_hash",t).single();return s&&"PGRST116"!==s.code&&console.error("Supabase Check Error:",s),!!r}async function lA(e){try{let t=await fetch("/api/supabase/proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deleteMetadata",cid:e})}),r=await t.json();if(r.success)return void console.log("[Supabase] Metadata deleted via proxy");console.warn("[Supabase] Proxy failed, trying direct client:",r.error)}catch(e){console.warn("[Supabase] Proxy error, trying direct client:",e)}let{error:t}=await lT.from("photos_metadata").delete().eq("cid",e);if(t)throw console.error("Supabase Delete Error:",t),t}async function lI(e,t,r,s,n){if(!s||0===s.length)throw console.error("registerDevice: userKeyHash is required"),Error("userKeyHash is required for device registration");try{let i=await fetch("/api/supabase/proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"registerDevice",id:e,deviceName:t,deviceType:r,userKeyHash:s,userId:n})}),a=await i.json();if(a.success)return console.log("[Supabase] Device registered via proxy:",a.updated?"updated":"inserted"),!0;console.warn("[Supabase] Proxy failed, trying direct client:",a.error)}catch(e){console.warn("[Supabase] Proxy error, trying direct client:",e)}let{data:i}=await lT.from("devices").select("id").eq("user_id",n).eq("device_name",t).eq("device_type",r||"").single();if(i){let{error:e}=await lT.from("devices").update({device_name:t,device_type:r,user_key_hash:s}).eq("id",i.id);if(e)throw console.error("[Supabase] Device Update Error:",e),e;return console.log("[Supabase] Device updated:",i.id),!0}let{error:a}=await lT.from("devices").insert({id:e,device_name:t,device_type:r,user_key_hash:s,user_id:n});if(a){if(a.message?.includes("Device limit exceeded"))throw Error("DEVICE_LIMIT_EXCEEDED");throw console.error("[Supabase] Device Insert Error:",a),a}return console.log("[Supabase] Device inserted:",e),!0}async function lF(e){let{data:t,error:r}=await lT.from("devices").select("*").eq("user_key_hash",e).order("created_at",{ascending:!1});if(r)throw console.error("Supabase Get Devices Error:",r),r;return t||[]}var lM=e.i(52789);let lD="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiJlYTcxMDdjNi0yMGE0LTQ5Y2ItODAyYy1kMmRhOWM2Nzk4NjUiLCJlbWFpbCI6ImVpbmFyQGJsYWNrLWtuaWdodC5kZXYiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwicGluX3BvbGljeSI6eyJyZWdpb25zIjpbeyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJGUkExIn0seyJkZXNpcmVkUmVwbGljYXRpb25Db3VudCI6MSwiaWQiOiJOWUMxIn1dLCJ2ZXJzaW9uIjoxfSwibWZhX2VuYWJsZWQiOmZhbHNlLCJzdGF0dXMiOiJBQ1RJVkUifSwiYXV0aGVudGljYXRpb25UeXBlIjoic2NvcGVkS2V5Iiwic2NvcGVkS2V5S2V5IjoiNjkyYjcyYTBlOTk2NDhmNjQ4NjgiLCJzY29wZWRLZXlTZWNyZXQiOiJmMmM3ZDUwMWE3NjhiMWI3NTI3ODExODAyZTg1YzJlNmUyZDc5ZjA0YTM1ZTA4ZjNmYWJiYmRiMmFlMGMzMmUwIiwiZXhwIjoxODAwNjgxOTMzfQ.g47clgfFIHt9Bw-pjvytmuMPO8FSXgAsSfhcXaP-YII",lL="red-able-bug-554.mypinata.cloud";async function lU(e,t,r){return console.log("[IPFS] Starting upload to Pinata...",{blobSize:e.size,fileName:t}),new Promise((s,n)=>{let i=new XMLHttpRequest;i.open("POST","https://api.pinata.cloud/pinning/pinFileToIPFS"),i.setRequestHeader("Authorization",`Bearer ${lD}`),i.timeout=12e4,i.upload.onprogress=e=>{if(e.lengthComputable&&r){let t=Math.round(e.loaded/e.total*100);console.log(`[IPFS] Upload progress: ${t}%`),r(t)}},i.onload=()=>{if(console.log("[IPFS] XHR onload, status:",i.status),i.status>=200&&i.status<300)try{let e=JSON.parse(i.responseText);console.log("[IPFS] Upload success, CID:",e.IpfsHash),s(e.IpfsHash)}catch(e){console.error("[IPFS] Failed to parse response:",i.responseText),n(Error("Failed to parse Pinata response"))}else console.error("[IPFS] Upload failed:",{status:i.status,response:i.responseText}),n(Error(`IPFS upload failed: ${i.status} - ${i.responseText}`))},i.onerror=e=>{console.error("[IPFS] XHR network error:",e),n(Error("Network error during IPFS upload - check connection"))},i.ontimeout=()=>{console.error("[IPFS] Upload timeout (2 min)"),n(Error("IPFS upload timeout - file too large or slow connection"))};let a=new FormData;a.append("file",e,t||"encrypted-photo.bin");let o=JSON.stringify({name:t||"photovault-encrypted",keyvalues:{app:"photovault",type:"encrypted-photo"}});a.append("pinataMetadata",o);let l=JSON.stringify({cidVersion:1});a.append("pinataOptions",l),console.log("[IPFS] Sending XHR..."),i.send(a)})}async function lB(e){console.log(`[IPFS] Downloading CID: ${e}`);try{console.log("[IPFS] Trying API proxy...");let t=await fetch(`/api/ipfs/download?cid=${encodeURIComponent(e)}`);if(t.ok){let e=await t.blob();return console.log(`[IPFS] API proxy succeeded, size: ${e.size} bytes`),e}console.warn(`[IPFS] API proxy failed: ${t.status}`)}catch(e){console.warn("[IPFS] API proxy error:",e)}let t=lL.startsWith("http")?lL:lL.includes(".")?`https://${lL}`:`https://${lL}.mypinata.cloud`,r=[()=>{let r=new URL(`${t}/ipfs/${e}`);return r.searchParams.set("pinataGatewayToken","q1z_4lRpNW9NNmISiMudoy79QVUJ_7-V6s5CDJvEM-CadXIF_WIWW5Xizui72HvA"),r.toString()},()=>`https://cloudflare-ipfs.com/ipfs/${e}`],s=new AbortController;try{let e=r.map(async(e,t)=>{let r=e();console.log(`[IPFS] Trying gateway ${t+1}: ${r.substring(0,60)}...`);let n=await fetch(r,{signal:s.signal,mode:"cors",credentials:"omit"});if(!n.ok)throw Error(`Gateway failed: ${n.status}`);return console.log(`[IPFS] Gateway ${t+1} succeeded`),n.blob()}),t=await Promise.any(e);return s.abort(),console.log(`[IPFS] Download complete, size: ${t.size} bytes`),t}catch(t){throw s.abort(),console.error("[IPFS] All methods failed:",t),Error(`IPFS download failed for CID: ${e}. Check network/CORS.`)}}async function lZ(e){let t=await fetch(`https://api.pinata.cloud/pinning/unpin/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${lD}`}});t.ok||console.error("Pinata unpin failed:",await t.text())}let lW=async(e,t,r)=>{try{console.log("Uploading to IPFS...",{size:e.size,fileName:t});let s=await lU(e,t,r);return console.log("IPFS upload successful:",s),s}catch(e){throw console.error("Remote Storage Upload failed:",e),e}},lQ=async e=>{try{console.log("Downloading from IPFS:",e);let t=await lB(e);return console.log("IPFS download successful:",{cid:e,size:t.size}),t}catch(e){throw console.error("Remote Storage Download failed:",e),e}};function lq(e){return e.startsWith("Qm")||e.startsWith("bafy")||e.startsWith("bafk")}var lJ=e.i(75523);let lH=e=>{let t,r=new Set,s=(e,s)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=s?s:"object"!=typeof n||null===n)?n:Object.assign({},t,n),r.forEach(r=>r(t,e))}},n=()=>t,i={setState:s,getState:n,getInitialState:()=>a,subscribe:e=>(r.add(e),()=>r.delete(e))},a=t=e(s,n,i);return i},lV=e=>{let t=e?lH(e):lH,r=e=>(function(e,t=e=>e){let r=D.default.useSyncExternalStore(e.subscribe,D.default.useCallback(()=>t(e.getState()),[e,t]),D.default.useCallback(()=>t(e.getInitialState()),[e,t]));return D.default.useDebugValue(r),r})(t,e);return Object.assign(r,t),r};function lG(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var s;let n=e=>null===e?null:JSON.parse(e,null==t?void 0:t.reviver),i=null!=(s=r.getItem(e))?s:null;return i instanceof Promise?i.then(n):n(i)},setItem:(e,s)=>r.setItem(e,JSON.stringify(s,null==t?void 0:t.replacer)),removeItem:e=>r.removeItem(e)}}let lK=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>lK(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>lK(t)(e)}}},lX=(n?lV(n):lV)((i=e=>({backupActive:!1,autoBackupEnabled:!0,backgroundBackupEnabled:!1,selectedPlan:"free",lastBackup:"Noch nie",permanence:0,setBackupActive:t=>e({backupActive:t}),setAutoBackupEnabled:t=>e({autoBackupEnabled:t}),setBackgroundBackupEnabled:t=>e({backgroundBackupEnabled:t}),setSelectedPlan:t=>e({selectedPlan:t}),setLastBackup:t=>e({lastBackup:t}),setPermanence:t=>e({permanence:t})}),a={name:"photovault-settings",storage:lG(()=>localStorage)},(e,t,r)=>{let s,n={storage:lG(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...a},o=!1,l=0,c=new Set,u=new Set,d=n.storage;if(!d)return i((...t)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),e(...t)},t,r);let h=()=>{let e=n.partialize({...t()});return d.setItem(n.name,{state:e,version:n.version})},p=r.setState;r.setState=(e,t)=>(p(e,t),h());let f=i((...t)=>(e(...t),h()),t,r);r.getInitialState=()=>f;let m=()=>{var r,i;if(!d)return;let a=++l;o=!1,c.forEach(e=>{var r;return e(null!=(r=t())?r:f)});let p=(null==(i=n.onRehydrateStorage)?void 0:i.call(n,null!=(r=t())?r:f))||void 0;return lK(d.getItem.bind(d))(n.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];else{if(n.migrate){let t=n.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(r=>{var i;if(a!==l)return;let[o,c]=r;if(e(s=n.merge(c,null!=(i=t())?i:f),!0),o)return h()}).then(()=>{a===l&&(null==p||p(s,void 0),s=t(),o=!0,u.forEach(e=>e(s)))}).catch(e=>{a===l&&(null==p||p(void 0,e))})};return r.persist={setOptions:e=>{n={...n,...e},e.storage&&(d=e.storage)},clearStorage:()=>{null==d||d.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},n.skipHydration||m(),s||f}));var lY=Object.defineProperty,l0=Object.getOwnPropertySymbols,l1=Object.prototype.hasOwnProperty,l2=Object.prototype.propertyIsEnumerable,l3=(e,t,r)=>t in e?lY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l4=(e,t)=>{for(var r in t||(t={}))l1.call(t,r)&&l3(e,r,t[r]);if(l0)for(var r of l0(t))l2.call(t,r)&&l3(e,r,t[r]);return e},l5=(e,t)=>{var r={};for(var s in e)l1.call(e,s)&&0>t.indexOf(s)&&(r[s]=e[s]);if(null!=e&&l0)for(var s of l0(e))0>t.indexOf(s)&&l2.call(e,s)&&(r[s]=e[s]);return r};(e=>{let t=class t{constructor(e,r,s,i){if(this.version=e,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version value out of range");if(i<-1||i>7)throw RangeError("Mask value out of range");this.size=4*e+17;let a=[];for(let e=0;e<this.size;e++)a.push(!1);for(let e=0;e<this.size;e++)this.modules.push(a.slice()),this.isFunction.push(a.slice());this.drawFunctionPatterns();const o=this.addEccAndInterleave(s);if(this.drawCodewords(o),-1==i){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const r=this.getPenaltyScore();r<e&&(i=t,e=r),this.applyMask(t)}}n(0<=i&&i<=7),this.mask=i,this.applyMask(i),this.drawFormatBits(i),this.isFunction=[]}static encodeText(r,s){let n=e.QrSegment.makeSegments(r);return t.encodeSegments(n,s)}static encodeBinary(r,s){let n=e.QrSegment.makeBytes(r);return t.encodeSegments([n],s)}static encodeSegments(e,s,i=1,o=40,l=-1,c=!0){let u,d;if(!(t.MIN_VERSION<=i&&i<=o&&o<=t.MAX_VERSION)||l<-1||l>7)throw RangeError("Invalid value");for(u=i;;u++){let r=8*t.getNumDataCodewords(u,s),n=a.getTotalBits(e,u);if(n<=r){d=n;break}if(u>=o)throw RangeError("Data too long")}for(let e of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])c&&d<=8*t.getNumDataCodewords(u,e)&&(s=e);let h=[];for(let t of e)for(let e of(r(t.mode.modeBits,4,h),r(t.numChars,t.mode.numCharCountBits(u),h),t.getData()))h.push(e);n(h.length==d);let p=8*t.getNumDataCodewords(u,s);n(h.length<=p),r(0,Math.min(4,p-h.length),h),r(0,(8-h.length%8)%8,h),n(h.length%8==0);for(let e=236;h.length<p;e^=253)r(e,8,h);let f=[];for(;8*f.length<h.length;)f.push(0);return h.forEach((e,t)=>f[t>>>3]|=e<<7-(7&t)),new t(u,s,f,l)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let s=0;s<t;s++)(0!=r||0!=s)&&(0!=r||s!=t-1)&&(r!=t-1||0!=s)&&this.drawAlignmentPattern(e[r],e[s]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){let t=this.errorCorrectionLevel.formatBits<<3|e,r=t;for(let e=0;e<10;e++)r=r<<1^(r>>>9)*1335;let i=(t<<10|r)^21522;n(i>>>15==0);for(let e=0;e<=5;e++)this.setFunctionModule(8,e,s(i,e));this.setFunctionModule(8,7,s(i,6)),this.setFunctionModule(8,8,s(i,7)),this.setFunctionModule(7,8,s(i,8));for(let e=9;e<15;e++)this.setFunctionModule(14-e,8,s(i,e));for(let e=0;e<8;e++)this.setFunctionModule(this.size-1-e,8,s(i,e));for(let e=8;e<15;e++)this.setFunctionModule(8,this.size-15+e,s(i,e));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let t=0;t<12;t++)e=e<<1^(e>>>11)*7973;let t=this.version<<12|e;n(t>>>18==0);for(let e=0;e<18;e++){let r=s(t,e),n=this.size-11+e%3,i=Math.floor(e/3);this.setFunctionModule(n,i,r),this.setFunctionModule(i,n,r)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let s=-4;s<=4;s++){let n=Math.max(Math.abs(s),Math.abs(r)),i=e+s,a=t+r;0<=i&&i<this.size&&0<=a&&a<this.size&&this.setFunctionModule(i,a,2!=n&&4!=n)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let s=-2;s<=2;s++)this.setFunctionModule(e+s,t+r,1!=Math.max(Math.abs(s),Math.abs(r)))}setFunctionModule(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0}addEccAndInterleave(e){let r=this.version,s=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(r,s))throw RangeError("Invalid argument");let i=t.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][r],a=t.ECC_CODEWORDS_PER_BLOCK[s.ordinal][r],o=Math.floor(t.getNumRawDataModules(r)/8),l=i-o%i,c=Math.floor(o/i),u=[],d=t.reedSolomonComputeDivisor(a);for(let r=0,s=0;r<i;r++){let n=e.slice(s,s+c-a+(r<l?0:1));s+=n.length;let i=t.reedSolomonComputeRemainder(n,d);r<l&&n.push(0),u.push(n.concat(i))}let h=[];for(let e=0;e<u[0].length;e++)u.forEach((t,r)=>{(e!=c-a||r>=l)&&h.push(t[e])});return n(h.length==o),h}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw RangeError("Invalid argument");let r=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let n=0;n<this.size;n++)for(let i=0;i<2;i++){let a=t-i,o=(t+1&2)==0?this.size-1-n:n;!this.isFunction[o][a]&&r<8*e.length&&(this.modules[o][a]=s(e[r>>>3],7-(7&r)),r++)}}n(r==8*e.length)}applyMask(e){if(e<0||e>7)throw RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let s;switch(e){case 0:s=(r+t)%2==0;break;case 1:s=t%2==0;break;case 2:s=r%3==0;break;case 3:s=(r+t)%3==0;break;case 4:s=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:s=r*t%2+r*t%3==0;break;case 6:s=(r*t%2+r*t%3)%2==0;break;case 7:s=((r+t)%2+r*t%3)%2==0;break;default:throw Error("Unreachable")}!this.isFunction[t][r]&&s&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let r=0;r<this.size;r++){let s=!1,n=0,i=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[r][a]==s?5==++n?e+=t.PENALTY_N1:n>5&&e++:(this.finderPenaltyAddHistory(n,i),s||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),s=this.modules[r][a],n=1);e+=this.finderPenaltyTerminateAndCount(s,n,i)*t.PENALTY_N3}for(let r=0;r<this.size;r++){let s=!1,n=0,i=[0,0,0,0,0,0,0];for(let a=0;a<this.size;a++)this.modules[a][r]==s?5==++n?e+=t.PENALTY_N1:n>5&&e++:(this.finderPenaltyAddHistory(n,i),s||(e+=this.finderPenaltyCountPatterns(i)*t.PENALTY_N3),s=this.modules[a][r],n=1);e+=this.finderPenaltyTerminateAndCount(s,n,i)*t.PENALTY_N3}for(let r=0;r<this.size-1;r++)for(let s=0;s<this.size-1;s++){let n=this.modules[r][s];n==this.modules[r][s+1]&&n==this.modules[r+1][s]&&n==this.modules[r+1][s+1]&&(e+=t.PENALTY_N2)}let r=0;for(let e of this.modules)r=e.reduce((e,t)=>e+ +!!t,r);let s=this.size*this.size,i=Math.ceil(Math.abs(20*r-10*s)/s)-1;return n(0<=i&&i<=9),n(0<=(e+=i*t.PENALTY_N4)&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{let e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2)),r=[6];for(let s=this.size-7;r.length<e;s-=t)r.splice(1,0,s);return r}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw RangeError("Version number out of range");let r=(16*e+128)*e+64;if(e>=2){let t=Math.floor(e/7)+2;r-=(25*t-10)*t-55,e>=7&&(r-=36)}return n(208<=r&&r<=29648),r}static getNumDataCodewords(e,r){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw RangeError("Degree out of range");let r=[];for(let t=0;t<e-1;t++)r.push(0);r.push(1);let s=1;for(let n=0;n<e;n++){for(let e=0;e<r.length;e++)r[e]=t.reedSolomonMultiply(r[e],s),e+1<r.length&&(r[e]^=r[e+1]);s=t.reedSolomonMultiply(s,2)}return r}static reedSolomonComputeRemainder(e,r){let s=r.map(e=>0);for(let n of e){let e=n^s.shift();s.push(0),r.forEach((r,n)=>s[n]^=t.reedSolomonMultiply(r,e))}return s}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw RangeError("Byte out of range");let r=0;for(let s=7;s>=0;s--)r=r<<1^(r>>>7)*285^(t>>>s&1)*e;return n(r>>>8==0),r}finderPenaltyCountPatterns(e){let t=e[1];n(t<=3*this.size);let r=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(r&&e[0]>=4*t&&e[6]>=t?1:0)+(r&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};function r(e,t,r){if(t<0||t>31||e>>>t!=0)throw RangeError("Value out of range");for(let s=t-1;s>=0;s--)r.push(e>>>s&1)}function s(e,t){return(e>>>t&1)!=0}function n(e){if(!e)throw Error("Assertion error")}t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],e.QrCode=t;let i=class e{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw RangeError("Invalid argument");this.bitData=r.slice()}static makeBytes(t){let s=[];for(let e of t)r(e,8,s);return new e(e.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!e.isNumeric(t))throw RangeError("String contains non-numeric characters");let s=[];for(let e=0;e<t.length;){let n=Math.min(t.length-e,3);r(parseInt(t.substring(e,e+n),10),3*n+1,s),e+=n}return new e(e.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){let s;if(!e.isAlphanumeric(t))throw RangeError("String contains unencodable characters in alphanumeric mode");let n=[];for(s=0;s+2<=t.length;s+=2){let i=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s));r(i+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),11,n)}return s<t.length&&r(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6,n),new e(e.Mode.ALPHANUMERIC,t.length,n)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw RangeError("ECI assignment value out of range");if(t<128)r(t,8,s);else if(t<16384)r(2,2,s),r(t,14,s);else if(t<1e6)r(6,3,s),r(t,21,s);else throw RangeError("ECI assignment value out of range");return new e(e.Mode.ECI,0,s)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let r=0;for(let s of e){let e=s.mode.numCharCountBits(t);if(s.numChars>=1<<e)return 1/0;r+=4+e+s.bitData.length}return r}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let r=0;r<e.length;r++)"%"!=e.charAt(r)?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t}};i.NUMERIC_REGEX=/^[0-9]*$/,i.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,i.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let a=i;e.QrSegment=i})(F||(F={})),_=(w=F||(F={})).QrCode||(w.QrCode={}),(o=class{constructor(e,t){this.ordinal=e,this.formatBits=t}}).LOW=new o(0,1),o.MEDIUM=new o(1,0),o.QUARTILE=new o(2,3),o.HIGH=new o(3,2),_.Ecc=o,j=(k=F||(F={})).QrSegment||(k.QrSegment={}),(l=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}}).NUMERIC=new l(1,[10,12,14]),l.ALPHANUMERIC=new l(2,[9,11,13]),l.BYTE=new l(4,[8,16,16]),l.KANJI=new l(8,[8,10,12]),l.ECI=new l(7,[0,0,0]),j.Mode=l;var l6=F,l8={L:l6.QrCode.Ecc.LOW,M:l6.QrCode.Ecc.MEDIUM,Q:l6.QrCode.Ecc.QUARTILE,H:l6.QrCode.Ecc.HIGH},l7="#FFFFFF",l9="#000000";function ce(e,t=0){let r=[];return e.forEach(function(e,s){let n=null;e.forEach(function(i,a){if(!i&&null!==n){r.push(`M${n+t} ${s+t}h${a-n}v1H${n+t}z`),n=null;return}if(a===e.length-1){if(!i)return;null===n?r.push(`M${a+t},${s+t} h1v1H${a+t}z`):r.push(`M${n+t},${s+t} h${a+1-n}v1H${n+t}z`);return}i&&null===n&&(n=a)})}),r.join("")}function ct(e,t){return e.slice().map((e,r)=>r<t.y||r>=t.y+t.h?e:e.map((e,r)=>(r<t.x||r>=t.x+t.w)&&e))}function cr({value:e,level:t,minVersion:r,includeMargin:s,marginSize:n,imageSettings:i,size:a,boostLevel:o}){let l=D.default.useMemo(()=>{let s=(Array.isArray(e)?e:[e]).reduce((e,t)=>(e.push(...l6.QrSegment.makeSegments(t)),e),[]);return l6.QrCode.encodeSegments(s,l8[t],r,void 0,void 0,o)},[e,t,r,o]),{cells:c,margin:u,numCells:d,calculatedImageSettings:h}=D.default.useMemo(()=>{let e=l.getModules(),t=null!=n?Math.max(Math.floor(n),0):4*!!s,r=e.length+2*t,o=function(e,t,r,s){if(null==s)return null;let n=e.length+2*r,i=Math.floor(.1*t),a=n/t,o=(s.width||i)*a,l=(s.height||i)*a,c=null==s.x?e.length/2-o/2:s.x*a,u=null==s.y?e.length/2-l/2:s.y*a,d=null==s.opacity?1:s.opacity,h=null;if(s.excavate){let e=Math.floor(c),t=Math.floor(u),r=Math.ceil(o+c-e),s=Math.ceil(l+u-t);h={x:e,y:t,w:r,h:s}}return{x:c,y:u,h:l,w:o,excavation:h,opacity:d,crossOrigin:s.crossOrigin}}(e,a,t,i);return{cells:e,margin:t,numCells:r,calculatedImageSettings:o}},[l,a,i,s,n]);return{qrcode:l,margin:u,cells:c,numCells:d,calculatedImageSettings:h}}var cs=function(){try{new Path2D().addPath(new Path2D)}catch(e){return!1}return!0}();D.default.forwardRef(function(e,t){let{value:r,size:s=128,level:n="L",bgColor:i=l7,fgColor:a=l9,includeMargin:o=!1,minVersion:l=1,boostLevel:c,marginSize:u,imageSettings:d}=e,h=l5(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:p}=h,f=l5(h,["style"]),m=null==d?void 0:d.src,g=D.default.useRef(null),y=D.default.useRef(null),v=D.default.useCallback(e=>{g.current=e,"function"==typeof t?t(e):t&&(t.current=e)},[t]),[b,x]=D.default.useState(!1),{margin:w,cells:_,numCells:k,calculatedImageSettings:j}=cr({value:r,level:n,minVersion:l,boostLevel:c,includeMargin:o,marginSize:u,imageSettings:d,size:s});D.default.useEffect(()=>{if(null!=g.current){let e=g.current,t=e.getContext("2d");if(!t)return;let r=_,n=y.current,o=null!=j&&null!==n&&n.complete&&0!==n.naturalHeight&&0!==n.naturalWidth;o&&null!=j.excavation&&(r=ct(_,j.excavation));let l=window.devicePixelRatio||1;e.height=e.width=s*l;let c=s/k*l;t.scale(c,c),t.fillStyle=i,t.fillRect(0,0,k,k),t.fillStyle=a,cs?t.fill(new Path2D(ce(r,w))):_.forEach(function(e,r){e.forEach(function(e,s){e&&t.fillRect(s+w,r+w,1,1)})}),j&&(t.globalAlpha=j.opacity),o&&t.drawImage(n,j.x+w,j.y+w,j.w,j.h)}}),D.default.useEffect(()=>{x(!1)},[m]);let S=l4({height:s,width:s},p),E=null;return null!=m&&(E=D.default.createElement("img",{src:m,key:m,style:{display:"none"},onLoad:()=>{x(!0)},ref:y,crossOrigin:null==j?void 0:j.crossOrigin})),D.default.createElement(D.default.Fragment,null,D.default.createElement("canvas",l4({style:S,height:s,width:s,ref:v,role:"img"},f)),E)}).displayName="QRCodeCanvas";var cn=D.default.forwardRef(function(e,t){let{value:r,size:s=128,level:n="L",bgColor:i=l7,fgColor:a=l9,includeMargin:o=!1,minVersion:l=1,boostLevel:c,title:u,marginSize:d,imageSettings:h}=e,p=l5(e,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:f,cells:m,numCells:g,calculatedImageSettings:y}=cr({value:r,level:n,minVersion:l,boostLevel:c,includeMargin:o,marginSize:d,imageSettings:h,size:s}),v=m,b=null;null!=h&&null!=y&&(null!=y.excavation&&(v=ct(m,y.excavation)),b=D.default.createElement("image",{href:h.src,height:y.h,width:y.w,x:y.x+f,y:y.y+f,preserveAspectRatio:"none",opacity:y.opacity,crossOrigin:y.crossOrigin}));let x=ce(v,f);return D.default.createElement("svg",l4({height:s,width:s,viewBox:`0 0 ${g} ${g}`,ref:t,role:"img"},p),!!u&&D.default.createElement("title",null,u),D.default.createElement("path",{fill:i,d:`M0,0 h${g}v${g}H0z`,shapeRendering:"crispEdges"}),D.default.createElement("path",{fill:a,d:x,shapeRendering:"crispEdges"}),b)});cn.displayName="QRCodeSVG";let ci=Z("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ca=Z("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);function co({isOpen:e,onClose:t}){let[r,s]=(0,D.useState)("show"),[n,i]=(0,D.useState)(""),[a,o]=(0,D.useState)(!1),[l,c]=(0,D.useState)(null),[u,d]=(0,D.useState)(!1),{recoveryPhrase:h,restoreFromPhrase:p}=aL(),f=async()=>{if(h)try{await navigator.clipboard.writeText(h),o(!0),setTimeout(()=>o(!1),2e3)}catch{console.error("Failed to copy to clipboard")}};return e?(0,M.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 px-6 backdrop-blur-sm",children:(0,M.jsxs)(aO,{className:"bg-white w-full max-w-[380px] p-0 shadow-2xl overflow-hidden",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between p-4 border-b-2 border-[#2563EB]/10",children:[(0,M.jsx)("h2",{className:"sketch-heading text-[20px] text-[#1D1D1F]",children:"GerÃ¤t verbinden"}),(0,M.jsx)("button",{onClick:t,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-black/5",children:(0,M.jsx)(ci,{className:"w-5 h-5 text-[#6E6E73]"})})]}),(0,M.jsxs)("div",{className:"flex border-b-2 border-[#2563EB]/10",children:[(0,M.jsxs)("button",{onClick:()=>s("show"),className:`flex-1 py-4 sketch-subheading text-[15px] flex items-center justify-center gap-2 transition-colors ${"show"===r?"text-[#2563EB] bg-[#2563EB]/5":"text-[#6E6E73]"}`,children:[(0,M.jsx)(ca,{className:"w-4 h-4"}),"Zeigen"]}),(0,M.jsx)("button",{onClick:()=>s("input"),className:`flex-1 py-4 sketch-subheading text-[15px] flex items-center justify-center gap-2 transition-colors ${"input"===r?"text-[#2563EB] bg-[#2563EB]/5":"text-[#6E6E73]"}`,children:"Eingeben"})]}),(0,M.jsx)("div",{className:"p-5",children:"show"===r?(0,M.jsxs)("div",{className:"flex flex-col items-center",children:[(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#6E6E73] text-center mb-6",children:"Scanne den QR-Code oder kopiere den SchlÃ¼ssel."}),h&&(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aO,{className:"p-4 bg-white",children:(0,M.jsx)(cn,{value:h,size:180,level:"M",includeMargin:!1})})}),(0,M.jsx)("div",{className:"w-full mb-6",children:(0,M.jsxs)(aO,{className:"bg-[#2563EB]/5 p-3",children:[(0,M.jsx)("p",{className:"sketch-body text-[11px] text-[#6E6E73] mb-1",children:"Backup-Phrase:"}),(0,M.jsx)("p",{className:"sketch-subheading text-[13px] break-all leading-relaxed",children:h||"Kein SchlÃ¼ssel"})]})}),(0,M.jsx)(aN,{onClick:f,disabled:!h,className:"w-full",size:"md",children:a?"âœ“ Kopiert!":"Phrase kopieren"})]}):(0,M.jsxs)("div",{className:"flex flex-col",children:[(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#6E6E73] text-center mb-6",children:"Gib den SchlÃ¼ssel deines anderen GerÃ¤ts ein."}),(0,M.jsx)(aP,{value:n,onChange:e=>{i(e),c(null)},placeholder:"SchlÃ¼ssel hier einfÃ¼gen...",rows:3,className:"mb-4"}),l&&(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#FF3B30] text-center mb-4 italic",children:l}),u&&(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#30D158] text-center mb-4 font-bold",children:"âœ“ Erfolg!"}),(0,M.jsx)(aN,{onClick:()=>{(c(null),n.trim())?p(n.trim())?(d(!0),i(""),setTimeout(()=>{d(!1),t()},1500)):c("UngÃ¼ltiger SchlÃ¼ssel. Bitte Ã¼berprÃ¼fe die Eingabe."):c("Bitte gib einen SchlÃ¼ssel ein")},disabled:!n.trim()||u,className:"w-full",size:"md",children:u?"Verbunden":"Verbinden"}),(0,M.jsx)("p",{className:"sketch-body text-[11px] text-[#FF9500] text-center mt-6",children:"Achtung: Dies ersetzt deinen aktuellen SchlÃ¼ssel!"})]})})]})}):null}function cl({state:t,setState:r,onRestartOnboarding:s,authUser:n}){let[i,a]=(0,D.useState)(!1),[o,l]=(0,D.useState)(!1),[c,u]=(0,D.useState)(!1),[d,h]=(0,D.useState)(!1),[p,f]=(0,D.useState)(!1),[m,g]=(0,D.useState)(!1),[y,v]=(0,D.useState)([]),[b,x]=(0,D.useState)(!1),[w,_]=(0,D.useState)({current:0,total:0}),k=lX(e=>e.autoBackupEnabled),j=lX(e=>e.setAutoBackupEnabled),S=lX(e=>e.backgroundBackupEnabled),E=lX(e=>e.setBackgroundBackupEnabled),$=lX(e=>e.selectedPlan),z=lX(e=>e.setSelectedPlan),N=lX(e=>e.setLastBackup),{secretKey:O,recoveryPhrase:T,generateNewKey:R,clearKey:C}=aL(),P=(0,lM.getDeviceId)(),[A,I]=(0,D.useState)(null);(0,D.useEffect)(()=>{O&&e.A(88936).then(e=>e.getUserKeyHash(O)).then(I)},[O]),(0,D.useEffect)(()=>{A&&(async()=>{try{let e=await lF(A);v(e)}catch(e){console.error("Failed to fetch devices:",e)}})()},[A]);let F=T?.split("-").slice(0,12)||[],L=async()=>{if(!b&&O){x(!0),console.log("[Backup] Starting manual backup to IPFS...");try{let e=(await (0,lJ.getAllPhotos)()).filter(e=>e.encryptedBlob);_({current:0,total:e.length});let t=0,r=(0,lM.getDeviceId)(),s=A||await (0,aM.getUserKeyHash)(O);for(let n of e)if(n.encryptedBlob)try{if(!await lP(n.cid,s)){let e=await lW(n.encryptedBlob,n.fileName);console.log(`[Backup] Uploaded to IPFS: ${e}`),await lR(e,n.fileSize,r,n.nonce,n.mimeType,s)}t++,_({current:t,total:e.length})}catch(e){console.error(`[Backup] Failed to upload ${n.cid}:`,e)}N("Gerade eben"),console.log(`[Backup] Complete: ${t} photos processed`)}catch(e){console.error("[Backup] Failed:",e)}finally{x(!1),_({current:0,total:0})}}},U=async()=>{C(),await R()&&r(e=>({...e,photosCount:0})),u(!1)},[B,Z]=(0,D.useState)(!1),[W,Q]=(0,D.useState)(!1),q=async()=>{try{let{db:t}=await e.A(334);await t.delete(),localStorage.clear(),window.location.reload()}catch(e){console.error("Failed to clear cache:",e)}};if(i){let e=y.map(e=>({id:e.id,name:e.device_name||"Unbekanntes GerÃ¤t",lastActive:e.id===P?"Aktiv":function(e){if(!e)return"Unbekannt";let t=new Date(e),r=new Date().getTime()-t.getTime(),s=Math.floor(r/6e4),n=Math.floor(r/36e5),i=Math.floor(r/864e5);return s<1?"Gerade eben":s<60?`vor ${s} Min.`:n<24?`vor ${n} Std.`:i<7?`vor ${i} Tagen`:t.toLocaleDateString("de-DE")}(e.created_at),syncing:!1}));return 0===e.length&&e.push({id:P,name:"Dieses GerÃ¤t",lastActive:"Aktiv",syncing:!1}),(0,M.jsx)(cc,{devices:e,onBack:()=>a(!1),onAddDevice:()=>{a(!1),Z(!0)}})}return(0,M.jsxs)("div",{className:"h-full flex flex-col pb-4 overflow-y-auto",children:[(0,M.jsx)("header",{className:"px-5 pt-6 pb-4 bg-[#FAFBFC]",children:(0,M.jsx)("h1",{className:"sketch-heading text-[32px]",children:"Einstellungen"})}),(0,M.jsxs)("div",{className:"flex-1 px-5",children:[(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[15px] uppercase tracking-wide px-4 mb-3",children:"Backup"}),(0,M.jsxs)(aO,{className:"overflow-hidden p-0",children:[(0,M.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"sketch-subheading text-[17px]",children:"Automatisches Backup"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"Neue Fotos automatisch sichern"})]}),(0,M.jsx)(aT,{checked:k,onChange:()=>{j(!k)}})]}),(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"sketch-subheading text-[17px]",children:"Hintergrund-Backup"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:"Weiter sichern wenn App geschlossen"})]}),(0,M.jsx)(aT,{checked:S,onChange:()=>{E(!S)}})]}),(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsxs)("button",{onClick:()=>f(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#2563EB]/5 transition-colors",children:[(0,M.jsxs)("div",{className:"flex items-center gap-4",children:[(0,M.jsx)(aR,{icon:"folder",size:28}),(0,M.jsxs)("div",{className:"text-left",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px] block",children:"Backup-Quelle"}),(0,M.jsx)("span",{className:"sketch-body text-[14px] text-[#6E6E73]",children:"photos-app"===t.photoSource?"Fotos-App":"Dateien-App"})]})]}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]})]}),(0,M.jsx)("div",{className:"px-4 mt-4",children:(0,M.jsx)(aN,{onClick:L,disabled:b||!O,className:"w-full",size:"lg",children:b?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(X,{className:"w-5 h-5 animate-spin mr-2"}),w.total>0?`${w.current}/${w.total}`:"Wait..."]}):"Jetzt sichern"})}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73] px-4 mt-3 text-center",children:"Alle lokalen Fotos in die Cloud hochladen"})]}),(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[15px] uppercase tracking-wide px-4 mb-3",children:"Speicher"}),(0,M.jsxs)(aO,{className:"overflow-hidden p-0",children:[(0,M.jsxs)("div",{className:"p-4",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px]",children:"Aktueller Plan"}),(0,M.jsx)("span",{className:"sketch-subheading text-[16px] text-[#2563EB]",children:"free"===$?"Free":"Backup+"})]}),(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#6E6E73]",children:"free"===$?"Fotos nur auf deinen GerÃ¤ten":"200 GB Cloud-Backup aktiv"})]}),(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsx)("div",{className:"p-4",children:(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsx)("span",{className:"sketch-body text-[15px] text-[#6E6E73]",children:"Verwendet"}),(0,M.jsxs)("span",{className:"sketch-subheading text-[15px]",children:[t.photosCount.toLocaleString()," Fotos (lokal)"]})]})}),(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsxs)("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#2563EB]/5 transition-colors",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px] text-[#2563EB]",children:"free"===$?"Upgrade zu Backup+":"Plan verwalten"}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]})]})]}),(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[15px] uppercase tracking-wide px-4 mb-3",children:"GerÃ¤te"}),(0,M.jsx)(aO,{className:"overflow-hidden p-0",children:(0,M.jsxs)("button",{onClick:()=>a(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#2563EB]/5 transition-colors",children:[(0,M.jsxs)("div",{className:"flex items-center gap-4",children:[(0,M.jsx)(aR,{icon:"photo",size:28}),(0,M.jsx)("span",{className:"sketch-subheading text-[17px]",children:"Verbundene GerÃ¤te"})]}),(0,M.jsxs)("div",{className:"flex items-center gap-3",children:[(0,M.jsx)("span",{className:"sketch-body text-[15px] text-[#6E6E73]",children:y.length||1}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]})]})})]}),(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[15px] uppercase tracking-wide px-4 mb-3",children:"Sicherheit"}),(0,M.jsxs)(aO,{className:"overflow-hidden p-0",children:[(0,M.jsxs)("button",{onClick:()=>l(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#2563EB]/5 transition-colors",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px]",children:"Backup-Phrase anzeigen"}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]}),(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsxs)("button",{onClick:()=>u(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#FF3B30]/5 transition-colors",children:[(0,M.jsx)("span",{className:"sketch-subheading text-[17px] text-[#FF3B30]",children:"Neuen SchlÃ¼ssel erstellen"}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]})]}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73] px-4 mt-3",children:"Teile diese WÃ¶rter niemals mit anderen."})]}),(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[15px] uppercase tracking-wide px-4 mb-3",children:"Wartung"}),(0,M.jsx)(aO,{className:"overflow-hidden p-0",children:(0,M.jsxs)("button",{onClick:()=>Q(!0),className:"w-full flex items-center justify-between p-4 hover:bg-[#FF9500]/5 transition-colors",children:[(0,M.jsxs)("div",{className:"flex items-center gap-4",children:[(0,M.jsx)(aR,{icon:"warning",size:28,color:"#FF9500"}),(0,M.jsx)("span",{className:"sketch-subheading text-[17px] text-[#FF9500]",children:"Lokalen Cache leeren"})]}),(0,M.jsx)(eU,{name:"chevronRight",size:16,className:"opacity-40"})]})}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73] px-4 mt-3",children:"LÃ¶scht lokale Vorschaubilder. Deine Cloud-Fotos bleiben sicher."})]})]}),o&&(0,M.jsx)(ch,{title:"Sicherheitshinweis",message:"Deine Backup-Phrase gibt vollen Zugriff auf deine verschlÃ¼sselten Fotos. Nur an einem privaten Ort anzeigen.",confirmLabel:"Phrase anzeigen",confirmDestructive:!1,onConfirm:()=>{l(!1),h(!0)},onCancel:()=>l(!1)}),d&&(0,M.jsx)("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-6 backdrop-blur-sm",children:(0,M.jsxs)(aO,{className:"bg-white w-full max-w-[400px] p-6 shadow-2xl",children:[(0,M.jsx)("h3",{className:"sketch-heading text-[24px] text-center mb-2",children:"Back-up Phrase"}),(0,M.jsx)("p",{className:"sketch-body text-[14px] text-[#6E6E73] text-center mb-6",children:"Notiere diese WÃ¶rter sicher."}),F.length>0?(0,M.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:F.map((e,t)=>(0,M.jsxs)(aO,{className:"p-2 text-center bg-[#2563EB]/5",children:[(0,M.jsx)("span",{className:"sketch-body text-[10px] text-[#6E6E73] block",children:t+1}),(0,M.jsx)("span",{className:"sketch-subheading text-[14px]",children:e})]},t))}):(0,M.jsx)("div",{className:"mb-6",children:(0,M.jsx)(aO,{className:"bg-[#FF9500]/5 border-[#FF9500] p-4",children:(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#FF9500] text-center",children:"Kein SchlÃ¼ssel gefunden."})})}),(0,M.jsx)(aN,{onClick:()=>h(!1),className:"w-full",children:"Fertig"})]})}),c&&(0,M.jsx)(ch,{title:"Datenverlust-Warnung",message:"Das Erstellen eines neuen SchlÃ¼ssels lÃ¶scht alle vorhandenen Backup-Daten permanent. Diese Aktion kann nicht rÃ¼ckgÃ¤ngig gemacht werden.",confirmLabel:"Neuen SchlÃ¼ssel erstellen",confirmDestructive:!0,onConfirm:U,onCancel:()=>u(!1)}),p&&(0,M.jsx)(cu,{currentSource:t.photoSource,onSelect:e=>{console.log("Update backup source preference:",e),r(t=>({...t,photoSource:e})),f(!1)},onClose:()=>f(!1)}),m&&(0,M.jsx)(cd,{currentPlan:$,onSelect:e=>{console.log("Update plan:",e),z(e),g(!1)},onClose:()=>g(!1)}),W&&(0,M.jsx)(ch,{title:"Cache leeren?",message:"Dies wird lokale Vorschaubilder und GerÃ¤tedaten lÃ¶schen. Deine verschlÃ¼sselten Fotos in der Cloud bleiben sicher. Die App wird neu geladen.",confirmLabel:"Cache leeren",confirmDestructive:!0,onConfirm:q,onCancel:()=>Q(!1)}),(0,M.jsx)(co,{isOpen:B,onClose:()=>Z(!1)})]})}function cc({devices:e,onBack:t,onAddDevice:r}){return(0,M.jsxs)("div",{className:"h-full flex flex-col pb-4 overflow-y-auto bg-[#FAFBFC]",children:[(0,M.jsxs)("header",{className:"px-5 pt-6 pb-4 bg-[#FAFBFC]",children:[(0,M.jsx)("button",{onClick:t,className:"sketch-body text-[#2563EB] mb-2 flex items-center gap-2 hover:underline",children:"â† ZurÃ¼ck"}),(0,M.jsx)("h1",{className:"sketch-heading text-[32px]",children:"GerÃ¤te"})]}),(0,M.jsxs)("div",{className:"flex-1 px-5",children:[(0,M.jsx)(aO,{className:"overflow-hidden p-0",children:e.map((e,t)=>(0,M.jsxs)("div",{children:[t>0&&(0,M.jsx)("div",{className:"h-[2px] bg-[#2563EB]/10 mx-4"}),(0,M.jsxs)("div",{className:"flex items-center gap-4 p-4",children:[(0,M.jsx)(aR,{icon:"photo",size:32}),(0,M.jsxs)("div",{className:"flex-1",children:[(0,M.jsx)("p",{className:"sketch-subheading text-[17px] text-[#1D1D1F]",children:e.name}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73]",children:e.lastActive})]}),e.syncing?(0,M.jsx)(X,{className:"w-5 h-5 text-[#2563EB] animate-spin"}):"Aktiv"===e.lastActive?(0,M.jsxs)("div",{className:"flex items-center gap-1",children:[(0,M.jsx)(aB,{className:"w-4 h-4 text-[#30D158]"}),(0,M.jsx)("span",{className:"sketch-subheading text-[13px] text-[#30D158]",children:"Aktiv"})]}):null]})]},e.id))}),(0,M.jsx)(aN,{onClick:r,className:"w-full mt-8",size:"lg",children:"Neu verbinden"}),(0,M.jsx)("p",{className:"sketch-body text-[13px] text-[#6E6E73] text-center mt-4 px-4",children:"SchlÃ¼ssel scannen oder Recovery-Phrase eingeben"})]})]})}function cu({currentSource:e,onSelect:t,onClose:r}){return(0,M.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-end justify-center z-50",children:(0,M.jsxs)("div",{className:"bg-white w-full max-w-[428px] rounded-t-2xl p-6 pb-10",children:[(0,M.jsx)("h3",{className:"sketch-heading text-[24px] text-[#1D1D1F] text-center mb-2",children:"Backup-Quelle"}),(0,M.jsx)("p",{className:"text-[15px] text-[#6E6E73] text-center mb-6",children:"Wo sind deine Fotos gespeichert?"}),(0,M.jsx)("div",{className:"space-y-3 mb-6",children:[{id:"photos-app",label:"Fotos-App",description:"Alle Fotos aus der iOS Foto-Bibliothek"},{id:"files-app",label:"Dateien-App",description:"Fotos aus einem bestimmten Ordner"}].map(r=>(0,M.jsx)("button",{onClick:()=>t(r.id),className:`w-full p-4 rounded-xl bg-[#F2F2F7] text-left ios-tap-target ${e===r.id?"ring-2 ring-[#007AFF]":""}`,children:(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("p",{className:"text-[17px] font-medium text-[#1D1D1F]",children:r.label}),(0,M.jsx)("p",{className:"text-[13px] text-[#6E6E73] mt-0.5",children:r.description})]}),(0,M.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${e===r.id?"border-[#007AFF] bg-[#007AFF]":"border-[#C7C7CC]"}`,children:e===r.id&&(0,M.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"})})]})},r.id))}),(0,M.jsx)("button",{onClick:r,className:"w-full h-[44px] text-[#007AFF] text-[17px] ios-tap-target",children:"Abbrechen"})]})})}function cd({currentPlan:e,onSelect:t,onClose:r}){return(0,M.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-end justify-center z-50",children:(0,M.jsxs)("div",{className:"bg-white w-full max-w-[428px] rounded-t-2xl p-6 pb-10 max-h-[80vh] overflow-y-auto",children:[(0,M.jsx)("h3",{className:"sketch-heading text-[24px] text-[#1D1D1F] text-center mb-2",children:"Speicherplan"}),(0,M.jsx)("p",{className:"text-[15px] text-[#6E6E73] text-center mb-6",children:"Du kannst jederzeit wechseln"}),(0,M.jsx)("div",{className:"space-y-3 mb-6",children:[{id:"free",label:"FREE",subtitle:"Auf deinen GerÃ¤ten",price:"0â‚¬/Monat",features:["Unbegrenzte Fotos","Zero-Knowledge VerschlÃ¼sselung","Multi-Device Sync"]},{id:"backup-plus",label:"BACKUP+",subtitle:"Dauerhaft im Netz",price:"2,99â‚¬/Monat",features:["Alles von Free","200 GB Cloud-Backup","Schnellere Synchronisierung"]}].map(r=>(0,M.jsx)("button",{onClick:()=>t(r.id),className:`w-full p-4 rounded-xl bg-[#F2F2F7] text-left ios-tap-target ${e===r.id?"ring-2 ring-[#007AFF]":""}`,children:(0,M.jsxs)("div",{className:"flex items-start justify-between",children:[(0,M.jsxs)("div",{className:"flex-1",children:[(0,M.jsx)("p",{className:"text-[13px] font-bold text-[#007AFF] tracking-wide",children:r.label}),(0,M.jsx)("p",{className:"text-[17px] font-semibold text-[#1D1D1F] mt-0.5",children:r.subtitle}),(0,M.jsx)("ul",{className:"mt-2 space-y-1",children:r.features.map(e=>(0,M.jsxs)("li",{className:"text-[13px] text-[#6E6E73] flex items-center gap-2",children:[(0,M.jsx)("span",{className:"text-[#30D158]",children:"âœ“"})," ",e]},e))}),(0,M.jsx)("p",{className:"text-[15px] font-semibold text-[#1D1D1F] mt-3",children:r.price})]}),(0,M.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${e===r.id?"border-[#007AFF] bg-[#007AFF]":"border-[#C7C7CC]"}`,children:e===r.id&&(0,M.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white"})})]})},r.id))}),(0,M.jsx)("button",{onClick:r,className:"w-full h-[44px] text-[#007AFF] text-[17px] ios-tap-target",children:"Abbrechen"})]})})}function ch({title:e,message:t,confirmLabel:r,confirmDestructive:s,onConfirm:n,onCancel:i}){return(0,M.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 px-8",children:(0,M.jsxs)("div",{className:"bg-white w-full max-w-[270px] rounded-2xl overflow-hidden",children:[(0,M.jsxs)("div",{className:"p-4 text-center",children:[(0,M.jsx)("h3",{className:"sketch-subheading text-[17px] text-[#1D1D1F] mb-1",children:e}),(0,M.jsx)("p",{className:"text-[13px] text-[#6E6E73] leading-relaxed",children:t})]}),(0,M.jsxs)("div",{className:"border-t border-[#E5E5EA]",children:[(0,M.jsx)("button",{onClick:i,className:"w-full py-3 text-[17px] text-[#007AFF] border-b border-[#E5E5EA] ios-tap-target",children:"Abbrechen"}),(0,M.jsx)("button",{onClick:n,className:`w-full py-3 text-[17px] font-semibold ios-tap-target ${s?"text-[#FF3B30]":"text-[#007AFF]"}`,children:r})]})]})})}var cp=e.i(12598),cf=e.i(75555),cm=e.i(40143),cg=e.i(86491),cy=e.i(15823),cv=e.i(93803),cb=e.i(19273),cx=e.i(80166),cw=class extends cy.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#r=(0,cv.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#s=void 0;#n=void 0;#i=void 0;#a;#o;#r;#t;#l;#c;#u;#d;#h;#p;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#s.addObserver(this),c_(this.#s,this.options)?this.#m():this.updateResult(),this.#g())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ck(this.#s,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ck(this.#s,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#v(),this.#s.removeObserver(this)}setOptions(e){let t=this.options,r=this.#s;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,cb.resolveEnabled)(this.options.enabled,this.#s))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#s.setOptions(this.options),t._defaulted&&!(0,cb.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#s,observer:this});let s=this.hasListeners();s&&cj(this.#s,r,this.options,t)&&this.#m(),this.updateResult(),s&&(this.#s!==r||(0,cb.resolveEnabled)(this.options.enabled,this.#s)!==(0,cb.resolveEnabled)(t.enabled,this.#s)||(0,cb.resolveStaleTime)(this.options.staleTime,this.#s)!==(0,cb.resolveStaleTime)(t.staleTime,this.#s))&&this.#x();let n=this.#w();s&&(this.#s!==r||(0,cb.resolveEnabled)(this.options.enabled,this.#s)!==(0,cb.resolveEnabled)(t.enabled,this.#s)||n!==this.#p)&&this.#_(n)}getOptimisticResult(e){var t,r;let s=this.#e.getQueryCache().build(this.#e,e),n=this.createResult(s,e);return t=this,r=n,(0,cb.shallowEqualObjects)(t.getCurrentResult(),r)||(this.#i=n,this.#o=this.options,this.#a=this.#s.state),n}getCurrentResult(){return this.#i}trackResult(e,t){return new Proxy(e,{get:(e,r)=>(this.trackProp(r),t?.(r),"promise"===r&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#r.status||this.#r.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#s}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),r=this.#e.getQueryCache().build(this.#e,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#m({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#m(e){this.#b();let t=this.#s.fetch(this.options,e);return e?.throwOnError||(t=t.catch(cb.noop)),t}#x(){this.#y();let e=(0,cb.resolveStaleTime)(this.options.staleTime,this.#s);if(cb.isServer||this.#i.isStale||!(0,cb.isValidTimeout)(e))return;let t=(0,cb.timeUntilStale)(this.#i.dataUpdatedAt,e);this.#d=cx.timeoutManager.setTimeout(()=>{this.#i.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#s):this.options.refetchInterval)??!1}#_(e){this.#v(),this.#p=e,!cb.isServer&&!1!==(0,cb.resolveEnabled)(this.options.enabled,this.#s)&&(0,cb.isValidTimeout)(this.#p)&&0!==this.#p&&(this.#h=cx.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||cf.focusManager.isFocused())&&this.#m()},this.#p))}#g(){this.#x(),this.#_(this.#w())}#y(){this.#d&&(cx.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#v(){this.#h&&(cx.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let r,s=this.#s,n=this.options,i=this.#i,a=this.#a,o=this.#o,l=e!==s?e.state:this.#n,{state:c}=e,u={...c},d=!1;if(t._optimisticResults){let r=this.hasListeners(),i=!r&&c_(e,t),a=r&&cj(e,s,t,n);(i||a)&&(u={...u,...(0,cg.fetchState)(c.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:h,errorUpdatedAt:p,status:f}=u;r=u.data;let m=!1;if(void 0!==t.placeholderData&&void 0===r&&"pending"===f){let e;i?.isPlaceholderData&&t.placeholderData===o?.placeholderData?(e=i.data,m=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,void 0!==e&&(f="success",r=(0,cb.replaceData)(i?.data,e,t),d=!0)}if(t.select&&void 0!==r&&!m)if(i&&r===a?.data&&t.select===this.#l)r=this.#c;else try{this.#l=t.select,r=t.select(r),r=(0,cb.replaceData)(i?.data,r,t),this.#c=r,this.#t=null}catch(e){this.#t=e}this.#t&&(h=this.#t,r=this.#c,p=Date.now(),f="error");let g="fetching"===u.fetchStatus,y="pending"===f,v="error"===f,b=y&&g,x=void 0!==r,w={status:f,fetchStatus:u.fetchStatus,isPending:y,isSuccess:"success"===f,isError:v,isInitialLoading:b,isLoading:b,data:r,dataUpdatedAt:u.dataUpdatedAt,error:h,errorUpdatedAt:p,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>l.dataUpdateCount||u.errorUpdateCount>l.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:v&&!x,isPaused:"paused"===u.fetchStatus,isPlaceholderData:d,isRefetchError:v&&x,isStale:cS(e,t),refetch:this.refetch,promise:this.#r,isEnabled:!1!==(0,cb.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=void 0!==w.data,r="error"===w.status&&!t,n=e=>{r?e.reject(w.error):t&&e.resolve(w.data)},i=()=>{n(this.#r=w.promise=(0,cv.pendingThenable)())},a=this.#r;switch(a.status){case"pending":e.queryHash===s.queryHash&&n(a);break;case"fulfilled":(r||w.data!==a.value)&&i();break;case"rejected":r&&w.error===a.reason||i()}}return w}updateResult(){let e=this.#i,t=this.createResult(this.#s,this.options);if(this.#a=this.#s.state,this.#o=this.options,void 0!==this.#a.data&&(this.#u=this.#s),(0,cb.shallowEqualObjects)(t,e))return;this.#i=t;let r=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,r="function"==typeof t?t():t;if("all"===r||!r&&!this.#f.size)return!0;let s=new Set(r??this.#f);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(t=>this.#i[t]!==e[t]&&s.has(t))};this.#k({listeners:r()})}#b(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#s)return;let t=this.#s;this.#s=e,this.#n=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#g()}#k(e){cm.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#s,type:"observerResultsUpdated"})})}};function c_(e,t){return!1!==(0,cb.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&ck(e,t,t.refetchOnMount)}function ck(e,t,r){if(!1!==(0,cb.resolveEnabled)(t.enabled,e)&&"static"!==(0,cb.resolveStaleTime)(t.staleTime,e)){let s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&cS(e,t)}return!1}function cj(e,t,r,s){return(e!==t||!1===(0,cb.resolveEnabled)(s.enabled,e))&&(!r.suspense||"error"!==e.state.status)&&cS(e,r)}function cS(e,t){return!1!==(0,cb.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,cb.resolveStaleTime)(t.staleTime,e))}var cE=D.createContext((c=!1,{clearReset:()=>{c=!1},reset:()=>{c=!0},isReset:()=>c})),c$=D.createContext(!1);c$.Provider;var cz=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function cN(e,t){return function(e,t,r){let s,n=D.useContext(c$),i=D.useContext(cE),a=(0,cp.useQueryClient)(r),o=a.defaultQueryOptions(e);a.getDefaultOptions().queries?._experimental_beforeQuery?.(o);let l=a.getQueryCache().get(o.queryHash);if(o._optimisticResults=n?"isRestoring":"optimistic",o.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=o.staleTime;o.staleTime="function"==typeof t?(...r)=>e(t(...r)):e(t),"number"==typeof o.gcTime&&(o.gcTime=Math.max(o.gcTime,1e3))}s=l?.state.error&&"function"==typeof o.throwOnError?(0,cb.shouldThrowError)(o.throwOnError,[l.state.error,l]):o.throwOnError,(o.suspense||o.experimental_prefetchInRender||s)&&!i.isReset()&&(o.retryOnMount=!1),D.useEffect(()=>{i.clearReset()},[i]);let c=!a.getQueryCache().get(o.queryHash),[u]=D.useState(()=>new t(a,o)),d=u.getOptimisticResult(o),h=!n&&!1!==e.subscribed;if(D.useSyncExternalStore(D.useCallback(e=>{let t=h?u.subscribe(cm.notifyManager.batchCalls(e)):cb.noop;return u.updateResult(),t},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),D.useEffect(()=>{u.setOptions(o)},[o,u]),o?.suspense&&d.isPending)throw cz(o,u,i);if((({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(n&&void 0===e.data||(0,cb.shouldThrowError)(r,[e.error,s])))({result:d,errorResetBoundary:i,throwOnError:o.throwOnError,query:l,suspense:o.suspense}))throw d.error;if(a.getDefaultOptions().queries?._experimental_afterQuery?.(o,d),o.experimental_prefetchInRender&&!cb.isServer&&d.isLoading&&d.isFetching&&!n){let e=c?cz(o,u,i):l?.promise;e?.catch(cb.noop).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}(e,cw,t)}var cO=e.i(14272),cT=cy,cR=class extends cT.Subscribable{#e;#i=void 0;#j;#S;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#E()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,cb.shallowEqualObjects)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#j,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,cb.hashKey)(t.mutationKey)!==(0,cb.hashKey)(this.options.mutationKey)?this.reset():this.#j?.state.status==="pending"&&this.#j.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#j?.removeObserver(this)}onMutationUpdate(e){this.#E(),this.#k(e)}getCurrentResult(){return this.#i}reset(){this.#j?.removeObserver(this),this.#j=void 0,this.#E(),this.#k()}mutate(e,t){return this.#S=t,this.#j?.removeObserver(this),this.#j=this.#e.getMutationCache().build(this.#e,this.options),this.#j.addObserver(this),this.#j.execute(e)}#E(){let e=this.#j?.state??(0,cO.getDefaultState)();this.#i={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#k(e){cm.notifyManager.batch(()=>{if(this.#S&&this.hasListeners()){let t=this.#i.variables,r=this.#i.context,s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#S.onSuccess?.(e.data,t,r,s)}catch(e){Promise.reject(e)}try{this.#S.onSettled?.(e.data,null,t,r,s)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#S.onError?.(e.error,t,r,s)}catch(e){Promise.reject(e)}try{this.#S.onSettled?.(void 0,e.error,t,r,s)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#i)})})}};function cC(e,t){let r=(0,cp.useQueryClient)(t),[s]=D.useState(()=>new cR(r,e));D.useEffect(()=>{s.setOptions(e)},[s,e]);let n=D.useSyncExternalStore(D.useCallback(e=>s.subscribe(cm.notifyManager.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=D.useCallback((e,t)=>{s.mutate(e,t).catch(cb.noop)},[s]);if(n.error&&(0,cb.shouldThrowError)(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}async function cP(e,t){let r={local:!1,supabase:!1,ipfs:!1,errors:[]};if(console.log("[PhotoManager] Starting global delete for CID:",e),void 0!==t&&t>0)try{await (0,lJ.deletePhoto)(t),r.local=!0,console.log("[PhotoManager] Deleted from IndexedDB:",t)}catch(t){let e=`IndexedDB delete failed: ${t}`;r.errors.push(e),console.error("[PhotoManager]",e)}else console.log("[PhotoManager] No local ID provided, skipping IndexedDB delete"),r.local=!0;try{await lA(e),r.supabase=!0,console.log("[PhotoManager] Deleted from Supabase:",e)}catch(t){let e=`Supabase delete failed: ${t}`;r.errors.push(e),console.error("[PhotoManager]",e)}if(e.startsWith("Qm")&&46===e.length||e.startsWith("bafy")||e.startsWith("bafk"))try{await lZ(e),r.ipfs=!0,console.log("[PhotoManager] Unpinned from IPFS:",e)}catch(e){console.warn("[PhotoManager] IPFS unpin failed (non-critical):",e),r.ipfs=!1}else console.log("[PhotoManager] Skipping IPFS unpin for mock/temp CID:",e),r.ipfs=!0;return console.log("[PhotoManager] Global delete complete:",r),r}let cA=null,cI=0,cF=new Map;function cM(e){let{id:t,success:r,file:s,blob:n,fileName:i,mimeType:a,converted:o,error:l,originalSize:c,convertedSize:u}=e.data,d=cF.get(t);if(d){if(cF.delete(t),!r)return void d.reject(Error(l||"Conversion failed"));if(n&&o){let e=new File([n],i,{type:a,lastModified:Date.now()});d.resolve({file:e,converted:!0,originalSize:c,convertedSize:u})}else d.resolve({file:s,converted:!1})}}function cD(e){console.error("[HEIC] Worker error:",e),cF.forEach(({reject:t})=>{t(Error("Worker error: "+e.message))}),cF.clear(),cA=null}async function cL(e,t=.92){if(!(["image/heic","image/heif","image/heic-sequence","image/heif-sequence"].includes(e.type?.toLowerCase())||e.name?.toLowerCase().endsWith(".heic")||e.name?.toLowerCase().endsWith(".heif")))return{file:e,converted:!1};let r=function(){if(!cA)try{(cA=new Worker("/workers/heic-worker.js")).onmessage=cM,cA.onerror=cD,console.log("[HEIC] Worker initialized")}catch(e){return console.warn("[HEIC] Worker creation failed, will use main thread:",e),null}return cA}();return r?new Promise((s,n)=>{let i=++cI;cF.set(i,{resolve:s,reject:n}),setTimeout(()=>{cF.has(i)&&(cF.delete(i),console.warn("[HEIC] Worker timeout, falling back to main thread"),cU(e,t).then(s).catch(n))},12e4),r.postMessage({id:i,file:e,quality:t})}):(console.log("[HEIC] Using main thread conversion"),cU(e,t))}async function cU(t,r){try{let s=(await e.A(208)).default,n=await s({blob:t,toType:"image/jpeg",quality:r}),i=Array.isArray(n)?n[0]:n,a=t.name.replace(/\.(heic|heif)$/i,".jpg"),o=new File([i],a,{type:"image/jpeg",lastModified:t.lastModified});return{file:o,converted:!0,originalSize:t.size,convertedSize:o.size}}catch(e){return console.error("[HEIC] Main thread conversion failed:",e),{file:t,converted:!1}}}let cB=Z("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);function cZ({photo:e,secretKey:t,showCloudBadge:r=!0}){let[s,n]=(0,D.useState)(null),[i,a]=(0,D.useState)(!1),[o,l]=(0,D.useState)(!1),[c,u]=(0,D.useState)(!1),[d,h]=(0,D.useState)(!1),p=(0,D.useRef)(null);return((0,D.useEffect)(()=>{if(t&&!s)return(async()=>{l(!0);try{let r=e.encryptedBlob;if(!r&&e.cid&&lq(e.cid)){u(!0),h(!0),console.log("Fetching from IPFS for thumbnail:",e.cid);try{r=await lQ(e.cid),console.log("Fetched from IPFS:",{cid:e.cid,size:r.size})}catch(t){console.error(`Failed to fetch from IPFS (CID: ${e.cid}):`,t),a(!0);return}finally{u(!1)}}if(!r){console.log("No blob available for:",e.cid),h(!0);return}let s=await (0,aM.decryptFile)(r,e.nonce,t,e.mimeType);if(s){let e=URL.createObjectURL(s);p.current=e,n(e)}else a(!0)}catch(t){console.error("Failed to decrypt photo:",e.cid,t),a(!0)}finally{l(!1)}})(),()=>{if(p.current){let e=p.current;setTimeout(()=>{try{URL.revokeObjectURL(e)}catch(e){}},1e3),p.current=null}}},[e,t,s]),i)?(0,M.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-red-50 text-red-500 p-2 text-center",children:[(0,M.jsx)(eU,{name:"lock",size:24,className:"mb-1 opacity-50"}),(0,M.jsx)("span",{className:"text-[10px]",children:"Fehler"})]}):c?(0,M.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-blue-50",children:[(0,M.jsx)(cB,{className:"w-5 h-5 text-blue-400 mb-1 animate-pulse"}),(0,M.jsx)(X,{className:"w-4 h-4 animate-spin text-blue-400"}),(0,M.jsx)("span",{className:"text-[9px] text-blue-500 mt-1",children:"Laden..."})]}):o||!s?!d||s||o?(0,M.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,M.jsx)(X,{className:"w-6 h-6 animate-spin text-gray-400"})}):(0,M.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-100 relative",children:[(0,M.jsx)(cB,{className:"w-6 h-6 text-gray-400"}),(0,M.jsx)("span",{className:"text-[9px] text-gray-500 mt-1",children:"In der Cloud"})]}):(0,M.jsxs)("div",{className:"relative w-full h-full",children:[(0,M.jsx)("img",{src:s,alt:"",className:"w-full h-full object-cover animate-in fade-in duration-500",loading:"lazy"}),r&&d&&(0,M.jsx)("div",{className:"absolute bottom-1 right-1 bg-black/50 rounded-full p-1",children:(0,M.jsx)(cB,{className:"w-3 h-3 text-white"})})]})}let cW=Z("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),cQ=Z("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),cq=Z("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),cJ=Z("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),cH=Z("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),cV=Z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function cG({photosCount:e=0,authUser:t}){let r,s,n=(0,cp.useQueryClient)(),[i,a]=(0,D.useState)(""),[o,l]=(0,D.useState)(!1),[c,u]=(0,D.useState)(!1),[d,h]=(0,D.useState)(null),[p,f]=(0,D.useState)(!1),[m,g]=(0,D.useState)(new Set),[y,v]=(0,D.useState)(null),[b,x]=(0,D.useState)(null),[w,_]=(0,D.useState)(null),[k,j]=(0,D.useState)(!1),[S,E]=(0,D.useState)(!1),$=(0,D.useRef)(null),z=(0,D.useRef)(null),{secretKey:N}=aL(),{photos:O,uploadPhoto:T,isUploading:R,uploadProgress:C}=function(e){let t=(0,cp.useQueryClient)(),[r,s]=(0,D.useState)(null);(0,D.useEffect)(()=>{e?(0,aM.getUserKeyHash)(e).then(s):s(null)},[e]);let{data:n=[],isLoading:i,error:a}=cN({queryKey:["photos"],queryFn:lJ.getAllPhotos,enabled:!0}),{data:o=0}=cN({queryKey:["photoCount"],queryFn:lJ.getPhotoCount}),[l,c]=(0,D.useState)(0),[u,d]=(0,D.useState)(new Map),h=cC({mutationFn:async t=>{if(!e)throw Error("No encryption key");if(!r)throw Error("userKeyHash not ready - bitte kurz warten");let s=`temp_${Date.now()}_${Math.random().toString(36).slice(2)}`;console.log("[Upload] Starting upload:",t.name,"tempId:",s),c(0);let n=URL.createObjectURL(t);d(e=>new Map(e).set(s,{file:t,objectUrl:n,progress:0}));try{let n,i=await cL(t),a=i.file;i.converted&&console.log("[Upload] HEIC converted:",{originalSize:i.originalSize,convertedSize:i.convertedSize});let{encrypted:o,nonce:l}=await (0,aM.encryptFile)(a,e);console.log("[Upload] Encrypted:",{size:o.size}),d(e=>{let t=new Map(e),r=t.get(s);return r&&t.set(s,{...r,progress:20}),t});try{n=await lW(o,a.name,e=>{let t=20+.6*e;c(t),d(e=>{let r=new Map(e),n=r.get(s);return n&&r.set(s,{...n,progress:t}),r})}),console.log("[Upload] IPFS CID:",n)}catch(e){console.error("[Upload] IPFS failed:",e),n=`cid_${Date.now()}_${Math.random().toString(36).slice(2)}`,console.log("[Upload] Using fallback CID:",n)}d(e=>{let t=new Map(e),r=t.get(s);return r&&t.set(s,{...r,progress:85}),t});let u={cid:n,nonce:l,fileName:a.name,mimeType:a.type,fileSize:a.size,uploadedAt:new Date,encryptedBlob:o};try{await (0,lJ.savePhoto)(u),console.log("[Upload] Saved to IndexedDB:",n)}catch(e){throw console.error("[Upload] IndexedDB save FAILED:",e),e}let h=(0,lM.getDeviceId)();try{await lR(n,a.size,h,l,a.type,r),console.log("[Upload] Supabase synced:",n)}catch(e){console.error("[Upload] Supabase sync failed (local + IPFS OK):",e)}return d(e=>{let t=new Map(e),r=t.get(s);return r&&URL.revokeObjectURL(r.objectUrl),t.delete(s),t}),u}catch(e){throw d(e=>{let t=new Map(e),r=t.get(s);return r&&URL.revokeObjectURL(r.objectUrl),t.delete(s),t}),e}},onSuccess:()=>{t.invalidateQueries({queryKey:["photos"]}),t.invalidateQueries({queryKey:["photoCount"]}),console.log("[Upload] Complete - queries invalidated")},onError:e=>{console.error("[Upload] Mutation failed:",e)}}),p=cC({mutationFn:async e=>{console.log("[Delete] Starting global delete:",e.cid);let t=await cP(e.cid,e.id);return t.errors.length>0&&console.warn("[Delete] Some operations failed:",t.errors),t},onSuccess:e=>{t.invalidateQueries({queryKey:["photos"]}),t.invalidateQueries({queryKey:["photoCount"]}),console.log("[Delete] Complete:",{local:e.local,supabase:e.supabase,ipfs:e.ipfs})},onError:e=>{console.error("[Delete] Mutation failed:",e)}}),f=(0,D.useCallback)(async t=>{if(!e||!t.encryptedBlob)return null;let r=await (0,aM.decryptFile)(t.encryptedBlob,t.nonce,e,t.mimeType);return r?URL.createObjectURL(r):null},[e]),m=Array.from(u.entries()).map(([e,t])=>({id:-1,cid:e,nonce:"",fileName:t.file.name,mimeType:t.file.type,fileSize:t.file.size,uploadedAt:new Date,encryptedBlob:void 0,isUploading:!0,uploadProgress:t.progress,previewUrl:t.objectUrl}));return{photos:n,photoCount:o,isLoading:i,error:a,uploadPhoto:h.mutate,deletePhoto:p.mutate,isDeleting:p.isPending,decryptPhoto:f,isUploading:h.isPending,uploadProgress:l,userKeyHash:r,uploadingPhotos:m}}(N),{remoteCIDs:P,remoteCIDsFromOtherDevices:A,isConnected:I}=function(e={}){let{onNewPhoto:t,onPhotoDeleted:r,enabled:s=!0,secretKey:n}=e,[i,a]=(0,D.useState)([]),[o,l]=(0,D.useState)(!1),[c,u]=(0,D.useState)(null),[d,h]=(0,D.useState)(null),p=(0,D.useRef)(null),f=(0,D.useRef)("server"),m=(0,D.useRef)(t),g=(0,D.useRef)(r),y=(0,D.useRef)(null),v=(0,D.useRef)(!1);(0,D.useEffect)(()=>{m.current=t,g.current=r},[t,r]),(0,D.useEffect)(()=>{f.current=(0,lM.getDeviceId)()},[]),(0,D.useEffect)(()=>{let e=!0;return n?(0,aM.getUserKeyHash)(n).then(t=>{e&&(h(t),p.current=t)}):(h(null),p.current=null),()=>{e=!1}},[n]);let b=(0,D.useCallback)(async()=>{let e=p.current,t=f.current;if(!e)return[];try{let r=(await lC(t,e)).map(e=>({cid:e.cid,device_id:e.device_id,uploaded_at:e.uploaded_at,file_size_bytes:e.file_size_bytes,nonce:e.nonce||null,mime_type:e.mime_type||null,isFromOtherDevice:e.device_id!==t}));return a(r),u(null),r}catch(e){return console.error("Failed to load remote CIDs:",e),u(e),[]}},[]);(0,D.useEffect)(()=>{d&&s&&b()},[d,s,b]),(0,D.useEffect)(()=>{if(!s||v.current||!d)return;console.log("[Realtime] Setting up subscription..."),v.current=!0;let e=[],t=null,r=()=>{0!==e.length&&(a(t=>{let r=e.filter(e=>!t.some(t=>t.cid===e.cid));return 0===r.length?t:[...r,...t]}),e.filter(e=>e.isFromOtherDevice).forEach(e=>{console.log("[Realtime] New photo from another device:",e.cid),m.current?.(e)}),e=[])},n=lT.channel(`photos_metadata_${d.slice(0,8)}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"photos_metadata"},s=>{let n=s.new,i=p.current;if(i&&n.user_key_hash!==i)return;let a={cid:n.cid,device_id:n.device_id,uploaded_at:n.uploaded_at,file_size_bytes:n.file_size_bytes,nonce:n.nonce,mime_type:n.mime_type,isFromOtherDevice:n.device_id!==f.current};e.push(a),t&&clearTimeout(t),t=setTimeout(r,100)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"photos_metadata"},e=>{let t=e.old;g.current?.(t.cid),a(e=>e.filter(e=>e.cid!==t.cid))}).subscribe(e=>{console.log("[Realtime] Status:",e),l("SUBSCRIBED"===e),"CHANNEL_ERROR"===e&&(console.log("[Realtime] Channel error, retrying in 5s..."),setTimeout(()=>{y.current&&v.current&&y.current.subscribe()},5e3))});return y.current=n,()=>{console.log("[Realtime] Cleaning up subscription..."),v.current=!1,t&&clearTimeout(t),y.current&&(lT.removeChannel(y.current),y.current=null)}},[s,d]);let x=(0,D.useCallback)(async()=>b(),[b]),w=i.filter(e=>e.isFromOtherDevice);return{remoteCIDs:i,remoteCIDsFromOtherDevices:w,isConnected:o,lastSyncError:c,refresh:x,deviceId:f.current,userKeyHash:d}}({onNewPhoto:(0,D.useCallback)(e=>{console.log("[Realtime] New photo from device:",e.device_id,e.cid),x(`Neues Foto von anderem Ger\xe4t empfangen`),setTimeout(()=>x(null),3e3),n.invalidateQueries({queryKey:["photos"]}),n.invalidateQueries({queryKey:["photoCount"]})},[n]),onPhotoDeleted:(0,D.useCallback)(e=>{console.log("[Realtime] Photo deleted from another device:",e),x(`Foto von anderem Ger\xe4t gel\xf6scht`),setTimeout(()=>x(null),3e3),n.invalidateQueries({queryKey:["photos"]}),n.invalidateQueries({queryKey:["photoCount"]})},[n]),enabled:!0,secretKey:N}),F=(r=O.map(e=>({id:e.id?.toString()||e.cid,cid:e.cid,placeholderUrl:"",category:"photo",date:e.uploadedAt.toISOString().split("T")[0],metadata:e,isLocal:!0,isCloud:lq(e.cid)})),s=new Set(O.map(e=>e.cid)),[...r,...P.filter(e=>!s.has(e.cid)).map(e=>({id:e.cid,cid:e.cid,placeholderUrl:"",category:"cloud",date:e.uploaded_at?new Date(e.uploaded_at).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],metadata:{cid:e.cid,nonce:e.nonce||"",fileName:`cloud_${e.cid}`,mimeType:e.mime_type||"image/jpeg",fileSize:e.file_size_bytes||0,uploadedAt:e.uploaded_at?new Date(e.uploaded_at):new Date},isLocal:!1,isCloud:!0}))]),L=(0,D.useMemo)(()=>{var t;let r,s;return F.length>0?F:(t=Math.min(e,50),r=["nature","architecture","travel","food","animals","city","landscape","portrait","ocean","forest"],s=new Date,Array.from({length:t},(e,t)=>{let n=new Date(s);return n.setDate(n.getDate()-Math.floor(t/3)),{id:`photo-${t}`,cid:`Qm${Math.random().toString(36).substring(2,15)}${Math.random().toString(36).substring(2,15)}`,placeholderUrl:`https://picsum.photos/seed/${t+100}/400/400`,category:r[t%r.length],date:n.toISOString().split("T")[0],metadata:void 0}}))},[F,e]),U=(0,D.useMemo)(()=>L.filter(e=>(!d||e.category===d)&&(!i||!!e.category.includes(i.toLowerCase()))),[L,d,i]),B=(0,D.useMemo)(()=>{let e;return e={},U.forEach(t=>{e[t.date]||(e[t.date]=[]),e[t.date].push(t)}),Object.entries(e).map(([e,t])=>{var r;let s,n,i;return{date:e,photos:t,label:(s=new Date(r=e),((i=new Date(n=new Date)).setDate(i.getDate()-1),r===n.toISOString().split("T")[0])?"Heute":r===i.toISOString().split("T")[0]?"Gestern":s.toLocaleDateString("de-DE",{weekday:"long",day:"numeric",month:"long"}))}})},[U]),Z=async e=>{if(N&&e.metadata){j(!0),_(null);try{let t=e.metadata.encryptedBlob;if(!t&&e.cid&&lq(e.cid)&&(console.log("Loading full-res from IPFS:",e.cid),t=await lQ(e.cid)),!t)return void console.error("No blob available for fullscreen");let r=await (0,aM.decryptFile)(t,e.metadata.nonce,N,e.metadata.mimeType);if(r){let e=URL.createObjectURL(r);_(e)}}catch(e){console.error("Failed to load fullscreen photo:",e)}finally{j(!1)}}},W=async e=>{if(N&&e.metadata){E(!0);try{let t=e.metadata.encryptedBlob;if(!t&&e.cid&&lq(e.cid)&&(t=await lQ(e.cid)),!t)return;let r=await (0,aM.decryptFile)(t,e.metadata.nonce,N,e.metadata.mimeType);if(r){let t=URL.createObjectURL(r),s=document.createElement("a");s.href=t,s.download=e.metadata.fileName||`photo_${e.cid.slice(0,8)}.jpg`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),x("Foto heruntergeladen!"),setTimeout(()=>x(null),2e3)}}catch(e){console.error("Failed to download photo:",e)}finally{E(!1)}}},Q=()=>{$.current&&(clearTimeout($.current),$.current=null)},q=L.length;return(0,M.jsxs)("div",{className:"flex flex-col h-full bg-[#FAFBFC]",children:[(0,M.jsxs)("header",{className:"px-5 pt-10 pb-4 bg-[#FAFBFC] sticky top-0 z-30 border-b-2 border-[#2563EB]/10",children:[(0,M.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,M.jsx)("h1",{className:"sketch-heading text-[32px]",children:"Galerie"}),(0,M.jsxs)("div",{className:"flex items-center gap-3",children:[(0,M.jsx)("button",{onClick:()=>l(!o),className:`p-2 rounded-full transition-colors ${o?"bg-[#2563EB]/10 text-[#2563EB]":"text-[#6E6E73]"}`,children:(0,M.jsx)(cW,{className:"w-6 h-6"})}),(0,M.jsx)(aN,{onClick:()=>{z.current?.click()},size:"sm",className:"scale-90",children:"HinzufÃ¼gen"})]})]}),(0,M.jsxs)("div",{className:"flex items-center justify-between px-1 mb-4",children:[(0,M.jsxs)("p",{className:"sketch-body text-[15px] text-[#3B82F6]",children:[q," Fotos gesichert"]}),(0,M.jsx)("div",{className:"flex items-center gap-2",children:I?(0,M.jsx)(aR,{icon:"cloud",size:20,color:"#30D158"}):(0,M.jsx)(aR,{icon:"warning",size:20,color:"#8E8E93"})})]}),o&&(0,M.jsx)("div",{className:"mb-4",children:(0,M.jsx)(aC,{value:i,onChange:e=>a(e),placeholder:"Suchen...",icon:(0,M.jsx)(cW,{className:"w-5 h-5"}),className:"w-full"})}),(0,M.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2 -mx-1 px-1",children:[(0,M.jsx)("button",{onClick:()=>h(null),className:`sketch-subheading text-[15px] px-4 py-1.5 rounded-full transition-colors ${null===d?"bg-[#2563EB] text-white":"bg-[#2563EB]/5 text-[#2563EB]"}`,children:"Alle"}),[{id:"nature",label:"Natur"},{id:"architecture",label:"Architektur"},{id:"travel",label:"Reisen"},{id:"food",label:"Essen"},{id:"animals",label:"Tiere"},{id:"city",label:"Stadt"},{id:"landscape",label:"Landschaft"}].map(e=>(0,M.jsx)("button",{onClick:()=>h(e.id),className:`sketch-subheading text-[15px] px-4 py-1.5 rounded-full transition-colors whitespace-nowrap ${d===e.id?"bg-[#2563EB] text-white":"bg-[#2563EB]/5 text-[#2563EB]"}`,children:e.label},e.id))]})]}),(0,M.jsx)("main",{className:"flex-1 overflow-y-auto px-1 pb-[100px]",children:0===B.length?(0,M.jsxs)("div",{className:"pt-20 text-center px-10",children:[(0,M.jsx)(aR,{icon:"photo",size:64,className:"mx-auto mb-4 opacity-20"}),(0,M.jsx)("p",{className:"sketch-subheading text-lg text-[#6E6E73]",children:"Keine Fotos gefunden"}),(0,M.jsx)("p",{className:"sketch-body text-sm text-[#8E8E93] mt-2",children:"Versuche es mit einem anderen Suchbegriff oder Filter"})]}):B.map(e=>(0,M.jsxs)("div",{className:"mb-8",children:[(0,M.jsx)("h2",{className:"sketch-subheading text-[19px] px-4 mb-3 sticky top-[160px] bg-[#FAFBFC]/80 backdrop-blur-sm z-10 py-1",children:e.label}),(0,M.jsx)("div",{className:"grid grid-cols-3 gap-1",children:e.photos.map(e=>(0,M.jsxs)("div",{className:`relative aspect-square overflow-hidden cursor-pointer active:opacity-70 transition-opacity ${m.has(e.id)?"ring-4 ring-[#2563EB] ring-inset":""}`,onClick:()=>{var t;return t=e.id,void(p?g(e=>{let r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r}):(v(t),e.metadata&&Z(e)))},onTouchStart:()=>{var t;return t=e.id,void($.current=setTimeout(()=>{f(!0),g(new Set([t]))},500))},onTouchEnd:Q,onContextMenu:t=>{t.preventDefault(),f(!0),g(new Set([e.id]))},children:[(0,M.jsx)(cZ,{photo:e.metadata,secretKey:N,showCloudBadge:!0}),p&&(0,M.jsx)("div",{className:"absolute top-2 right-2 z-10 w-6 h-6",children:(0,M.jsx)(aO,{className:`w-6 h-6 rounded-full p-0 flex items-center justify-center ${m.has(e.id)?"bg-[#2563EB] border-[#2563EB]":"bg-white/80 border-[#2563EB]"}`,children:m.has(e.id)&&(0,M.jsx)(aB,{className:"w-4 h-4 text-white"})})})]},e.id))})]},e.date))}),b&&(0,M.jsx)("div",{className:"fixed bottom-[100px] left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-[400px]",children:(0,M.jsx)(aO,{className:"bg-[#2563EB] border-[#1E40AF] py-3 px-5 shadow-xl",children:(0,M.jsxs)("p",{className:"sketch-body text-white text-center flex items-center justify-center gap-3",children:[(0,M.jsx)(X,{className:"w-4 h-4 animate-spin text-white/80"}),b]})})}),y&&(0,M.jsxs)("div",{className:"fixed inset-0 bg-black z-[100] flex flex-col",children:[(0,M.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,M.jsx)("button",{onClick:()=>{v(null),w&&(URL.revokeObjectURL(w),_(null))},className:"p-2 text-white/80 hover:text-white",children:(0,M.jsx)(ci,{className:"w-6 h-6"})}),(0,M.jsxs)("div",{className:"flex items-center gap-4",children:[(0,M.jsx)("button",{className:"p-2 text-white/80 hover:text-white",children:(0,M.jsx)(cQ,{className:"w-6 h-6"})}),(0,M.jsx)("button",{className:"p-2 text-white/80 hover:text-white",children:(0,M.jsx)(cJ,{className:"w-6 h-6"})})]})]}),(0,M.jsx)("div",{className:"flex-1 relative flex items-center justify-center overflow-hidden",children:k?(0,M.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,M.jsx)(X,{className:"w-12 h-12 text-[#2563EB] animate-spin"}),(0,M.jsx)("p",{className:"sketch-body text-white/60",children:"EntschlÃ¼sseln..."})]}):w?(0,M.jsx)("img",{src:w,alt:"Vollbild",className:"max-w-full max-h-full object-contain"}):(0,M.jsxs)("div",{className:"text-center p-10",children:[(0,M.jsx)(aR,{icon:"warning",size:48,color:"#FF3B30",className:"mx-auto mb-4"}),(0,M.jsx)("p",{className:"sketch-body text-white",children:"Laden fehlgeschlagen"})]})}),(0,M.jsxs)("div",{className:"p-6 flex items-center justify-around bg-black/40 backdrop-blur-md",children:[(0,M.jsxs)("button",{className:"flex flex-col items-center gap-1 text-white/70",onClick:()=>{let e=L.find(e=>e.id===y);e&&W(e)},disabled:S,children:[S?(0,M.jsx)(X,{className:"w-6 h-6 animate-spin"}):(0,M.jsx)(cV,{className:"w-6 h-6"}),(0,M.jsx)("span",{className:"sketch-body text-[10px]",children:"Speichern"})]}),(0,M.jsxs)("button",{className:"flex flex-col items-center gap-1 text-white/70",children:[(0,M.jsx)(cH,{className:"w-6 h-6"}),(0,M.jsx)("span",{className:"sketch-body text-[10px]",children:"Exportieren"})]}),(0,M.jsxs)("button",{className:"flex flex-col items-center gap-1 text-[#FF3B30]",children:[(0,M.jsx)(cq,{className:"w-6 h-6"}),(0,M.jsx)("span",{className:"sketch-body text-[10px]",children:"LÃ¶schen"})]})]})]}),(0,M.jsx)("input",{ref:z,type:"file",multiple:!0,accept:"image/*",onChange:e=>{Array.from(e.target.files||[]).forEach(e=>T(e))},className:"hidden"}),R&&(0,M.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-center justify-center p-6",children:(0,M.jsxs)(aO,{className:"bg-white w-full max-w-[280px] p-6 flex flex-col items-center",children:[(0,M.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#2563EB]/10 flex items-center justify-center mb-4",children:(0,M.jsx)(X,{className:"w-8 h-8 text-[#2563EB] animate-spin"})}),(0,M.jsx)("h3",{className:"sketch-subheading text-lg text-center mb-2",children:"Sicherung lÃ¤uft..."}),(0,M.jsx)("p",{className:"sketch-body text-sm text-[#6E6E73] text-center mb-4",children:C>0?`${C}% hochgeladen`:"Vorbereiten..."}),(0,M.jsx)("div",{className:"w-full bg-[#E5E7EB] h-2 rounded-full overflow-hidden",children:(0,M.jsx)("div",{className:"bg-[#2563EB] h-full transition-all duration-300",style:{width:`${C}%`}})})]})})]})}let cK={isOnboarded:!1,backupActive:!1,selectedPlan:"free",autoBackupEnabled:!0,backgroundBackupEnabled:!1,photosCount:0,lastBackup:"Noch nie",permanence:0,encryptionKey:"",backupPhrase:[],devices:[],photoSource:"photos-app"};function cX(){let[e,t]=(0,D.useState)(cK),[r,s]=(0,D.useState)("gallery"),[n,i]=(0,D.useState)("loading"),[a,o]=(0,D.useState)(null),{data:l,isPending:c}=a$(),u=(0,D.useRef)(!1),d=(0,D.useCallback)(async(e,t)=>{if(u.current)return void console.log("[Device] Already registered this session, skipping");try{let r=(0,lM.getDeviceId)(),s=(0,lM.getDeviceName)(),n=(0,lM.getDeviceType)();await lI(r,s,n,e,t),u.current=!0,console.log("[Device] Registered successfully:",r)}catch(e){console.error("[Device] Registration failed:",e)}},[]);(0,D.useEffect)(()=>{(async()=>{if(c)return;if(!l?.user)return i("auth");let e=l.user,r=null;try{let e=await fetch("/api/auth/get-vault-key-hash");e.ok&&(r=(await e.json()).vaultKeyHash)}catch(e){console.error("Failed to fetch vault_key_hash:",e)}o({id:e.id,email:e.email,vaultKeyHash:r});let s=(0,aM.loadKeyFromStorage)();if(s){let n=await (0,aM.getUserKeyHash)(s);if(r&&n!==r){console.warn("Local key doesn't match account's vault_key_hash"),(0,aM.clearKeyFromStorage)(),i("unlock");return}await d(n,e.id),t(e=>({...e,isOnboarded:!0})),i("main")}else r?i("unlock"):i("setup")})()},[l,c,d]);let h=(0,D.useCallback)(async e=>{let r=e.vaultKeyHash;try{let e=await fetch("/api/auth/get-vault-key-hash");e.ok&&(r=(await e.json()).vaultKeyHash)}catch(e){console.error("Failed to fetch vault_key_hash:",e)}o({...e,vaultKeyHash:r});let s=(0,aM.loadKeyFromStorage)();if(s){let n=await (0,aM.getUserKeyHash)(s);r&&n!==r?((0,aM.clearKeyFromStorage)(),i("unlock")):(await d(n,e.id),t(e=>({...e,isOnboarded:!0})),i("main"))}else r?i("unlock"):i("setup")},[d]),p=(0,D.useCallback)(async(e,r)=>{a&&(a.vaultKeyHash||(await cY(a.id,r),o({...a,vaultKeyHash:r})),await d(r,a.id),t(e=>({...e,isOnboarded:!0})),i("main"))},[a,d]),f=(0,D.useCallback)(async e=>{a&&(await cY(a.id,e),o({...a,vaultKeyHash:e}),await d(e,a.id),t(e=>({...e,isOnboarded:!0})),i("main"))},[a,d]),m=(0,D.useCallback)(async()=>{await aE(),(0,aM.clearKeyFromStorage)(),o(null),t(cK),i("auth")},[]);return"loading"===n||c?(0,M.jsx)(Q,{}):"auth"===n?(0,M.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,M.jsx)("div",{className:"max-w-[1200px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,M.jsx)(aA,{onSuccess:h})})}):"unlock"===n&&a?(0,M.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,M.jsx)("div",{className:"max-w-[1200px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,M.jsx)(aD,{userEmail:a.email,expectedKeyHash:a.vaultKeyHash,onUnlock:p,onCreateNewVault:()=>i("setup"),onLogout:m})})}):"setup"===n&&a?(0,M.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,M.jsx)("div",{className:"max-w-[1200px] mx-auto min-h-screen bg-[#F2F2F7]",children:(0,M.jsx)(aU,{userId:a.id,onComplete:f,onBack:()=>i("unlock")})})}):(0,M.jsx)("div",{className:"min-h-screen ios-bg-gray",children:(0,M.jsxs)("div",{className:"max-w-[1200px] mx-auto min-h-screen bg-[#F2F2F7] flex flex-col relative",children:[(0,M.jsxs)("div",{className:"flex-1 overflow-hidden pb-[80px]",children:["gallery"===r&&(0,M.jsx)(cG,{photosCount:e.photosCount,authUser:a}),"settings"===r&&(0,M.jsx)(cl,{state:e,setState:t,onRestartOnboarding:m,authUser:a})]}),(0,M.jsx)(c0,{currentScreen:r,onNavigate:e=>{s(e)}})]})})}async function cY(e,t){try{if(!(await fetch("/api/auth/update-vault-key",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,keyHash:t})})).ok)throw Error("Failed to update vault key hash")}catch(e){throw console.error("Failed to update vault_key_hash:",e),e}}function c0({currentScreen:e,onNavigate:t}){return(0,M.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 h-[85px] bg-[#FAFBFC]/90 backdrop-blur-xl border-t-2 border-[#2563EB]/10 flex items-start justify-around pt-3 pb-7 max-w-[1200px] mx-auto z-40",children:[(0,M.jsxs)("button",{onClick:()=>t("gallery"),className:"flex flex-col items-center gap-1 px-8 transition-transform active:scale-95",children:[(0,M.jsx)(aR,{icon:"photo",size:28,color:"gallery"===e?"#2563EB":"#9CA3AF"}),(0,M.jsx)("span",{className:`sketch-subheading text-[12px] ${"gallery"===e?"text-[#2563EB]":"text-[#9CA3AF]"}`,children:"Galerie"})]}),(0,M.jsxs)("button",{onClick:()=>t("settings"),className:"flex flex-col items-center gap-1 px-8 transition-transform active:scale-95",children:[(0,M.jsx)(aR,{icon:"folder",size:28,color:"settings"===e?"#2563EB":"#9CA3AF"}),(0,M.jsx)("span",{className:`sketch-subheading text-[12px] ${"settings"===e?"text-[#2563EB]":"text-[#9CA3AF]"}`,children:"Optionen"})]})]})}e.s(["PhotoVaultApp",()=>cX],71058)}]);